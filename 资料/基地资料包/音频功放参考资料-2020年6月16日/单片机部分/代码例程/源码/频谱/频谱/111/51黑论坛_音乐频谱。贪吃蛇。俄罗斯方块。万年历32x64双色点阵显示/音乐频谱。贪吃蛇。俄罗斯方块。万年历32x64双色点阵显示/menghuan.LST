C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 1   


C51 COMPILER V8.02, COMPILATION OF MODULE MENGHUAN
OBJECT MODULE PLACED IN menghuan.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE menghuan.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <stdlib.h>
   2          #include "INTRINS.H"
   3          #include <qumoshuju.h>
   4          #define uchar unsigned char
   5          #define uint unsigned int
   6          
   7          
   8          sbit pmw=P1^3;
   9          sbit R1=P2^3;     
  10          sbit R2=P2^1;   
  11          sbit G1=P2^2;   
  12          sbit G2=P2^0;   
  13          sbit STCP=P0^6;         
  14          sbit SHCP=P2^7;         
  15          sbit OE=P2^4;   
  16          sbit IA=P0^5;   
  17          sbit IB=P2^6;   
  18          sbit IC=P0^4;   
  19          sbit ID=P2^5;           
  20          sbit ds18b20=P0^2;       
  21          sbit ds1302rst=P0^3;  
  22          sbit ds1302io=P3^3;        
  23          sbit ds1302cslk=P3^4; 
  24          sbit key_jia=P3^0;              
  25          sbit key_jian=P3^1;             
  26          sbit key_fan_hiu=P3^6;                                          
  27          sbit key_qu_ren=P3^5;
  28          
  29          
  30          uchar yangshi=3;
  31           
  32          uchar i,j,jj,k,b,p,G,color=0,daid=1; uint TEMP1,ansdw,wen,tcssd=0; bit stop,xyz=0;
  33          uchar COUNT=15,COUNT1=0,ADC_Count=0,LINE=15;
  34          uchar TPL,TPH,ii,wdbc;sbit ACC_7 = ACC^7;
  35           
  36          uchar bianjie,sudu=1,kai_shi=1,kai_sh=1,sscan=0;
  37          uchar efenge=0,efenshi=0,efenbai=0,efenqian=0;
  38          uchar xinz=0,fangx=0,fkx=3,fky=17,xiaxia=0;
  39          uchar newxinz=1,newfangx,newfkx,newfky,sssddd=1;
  40          
  41          uchar wnian,wyue,wri,wshi,wfen,wmiao,wxinq;
  42          uchar nian1,nian2,yue1,yue2,ri1,ri2,shi1,shi2,shi3,shi4;
  43          uchar fen1,fen2,fen3,fen4,miao1,miao2,xinqi,kaij,szxh=0,ysh,ysfu;
  44          uchar yiji,erji,foo,foo1,jishu,shanji,shiji,aaajjj=0,hysj=0;
  45          int Real,Imag,temp;
  46          
  47          
  48          
  49          void scan(uchar Value)   //行使能
  50          {
  51   1              switch(Value)
  52   1              {
  53   2                      case  0: scan0;break;
  54   2                      case  1: scan1;break;
  55   2                      case  2: scan2;break;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 2   

  56   2                      case  3: scan3;break;
  57   2                      case  4: scan4;break;
  58   2                      case  5: scan5;break;
  59   2                      case  6: scan6;break;
  60   2                      case  7: scan7;break;
  61   2                      case  8: scan8;break;
  62   2                      case  9: scan9;break;
  63   2                      case 10:scan10;break;
  64   2                      case 11:scan11;break;
  65   2                      case 12:scan12;break;
  66   2                      case 13:scan13;break;
  67   2                      case 14:scan14;break;
  68   2                      case 15:scan15;break;
  69   2                      default:break;
  70   2              }
  71   1      }
  72          
  73          
  74          
  75          
  76          void Init()       //     单片机初始化
  77          {
  78   1              
  79   1              
  80   1              P1ASF = 0x01;
  81   1      
  82   1              P0M0=0x70;
  83   1              P0M1=0x00;
  84   1      
  85   1              P1M0 = 0x08; // 0000 1000
  86   1              P1M1 = 0x01; // 0000 0001
  87   1      
  88   1              P2M0=0xef;
  89   1              P2M1=0x00;
  90   1              
  91   1      
  92   1                                          
  93   1              AUXR1 &= 0xFB;                  
  94   1              EADC=1;                  
  95   1              ADC_CONTR = 0x08;
  96   1              hua_88(32,45,1,8,0);
  97   1              hua_816(32,45,1,8,0);
  98   1              hua_1616(32,45,1,8,0);
  99   1              qu_88(32,45,1,8,0);
 100   1              qu_816(32,45,1,8,0);
 101   1              qu_1616(32,45,1,8,0);
 102   1              hua_dian1(0,0,1);
 103   1              qing_dian1(0,0,1);
 104   1              qing_hong();
 105   1              qing_nv();       
 106   1              TMOD = 0X12;                                       
 107   1              TH0 = 0x70;                                                               
 108   1              TL0 = 0x70;
 109   1              TH1 = 0xf3;                                                                                              
 110   1              TL1 = 0Xaa;             
 111   1              ET0 = 1;                                          
 112   1              TR0 = 0;                                                 
 113   1              ET1 = 1;
 114   1              TR1 = 1;
 115   1              PT1 = 0;
 116   1              PT0 = 1;
 117   1              IPH |= 0x20;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 3   

 118   1              IP |= 0x20;
 119   1      
 120   1      
 121   1              CMOD=0x00;
 122   1              CCON=0x40;
 123   1              CCAPM0=0x42;
 124   1              CCAP0H=254;
 125   1      
 126   1              BRT=0xfa;
 127   1              AUXR|=0x11;
 128   1              SCON|=0x50;
 129   1              ES=1;
 130   1                                                      
 131   1              EA = 1;
 132   1              kaij=yangshi;
 133   1              yangshi=2;                                              
 134   1              OE = 1; 
 135   1              if(OE==0) kai_ji();
 136   1              delay(65530);
 137   1              Initial();
 138   1              read_ds18b20_1T();
 139   1              //kai_ji();
 140   1              for(i=0;i<64;i++)
 141   1              {
 142   2                      LB[i]=0;
 143   2                      LB1[i]=0;
 144   2              }
 145   1              if(kaij==1)
 146   1              {
 147   2                      for(p=0;p<64;p++)
 148   2                      {
 149   3                              ttb1.eal[p]=0x0c00;
 150   3                                 
 151   3                      }
 152   2                      ttb1.eal[3]=0x0fff;
 153   2                      ttb1.eal[2]=0x0fff;
 154   2                      ttb1.eal[1]=0x0fff;
 155   2                      ttb1.eal[0]=0x0fff;
 156   2                      kai_shi=1;kai_sh=1;
 157   2              }
 158   1              ysh=kaij;
 159   1              yangshi=kaij;
 160   1                       
 161   1      }
 162          
 163          
 164          
 165          void ADC_Finish() interrupt 5   //               频谱ad采样
 166          {
 167   1              ADC_CONTR &= !0x10;
 168   1              ttb1.eal[LIST_TAB[ADC_Count]]=(int)((ADC_RES*3)<<2)+(ADC_RESL)*5;
 169   1              if(ADC_Count<=127) ADC_Count++;
 170   1              else {EADC=0;TR0=0;}
 171   1      }
 172          
 173          void bbc() interrupt 4
 174          {
 175   1              if(TI==1) TI=0;
 176   1              if(RI==1)
 177   1              {
 178   2                      RI=0;
 179   2                      hysj=SBUF;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 4   

 180   2                      if(hysj==0x40|hysj==0x44|hysj==0x43|hysj==0x15|hysj==0x46) aaajjj=hysj;
 181   2                      if(hysj==0x16) {if(color==0) color=1;else color=0;}
 182   2                      if(hysj==0x09) {if(daid==1) daid=0;else daid=1;}
 183   2                      if(hysj==0x45) {if(CCAP0H>15) CCAP0H=CCAP0H-10;}                   
 184   2                      if(hysj==0x47) {if(CCAP0H<240) CCAP0H=CCAP0H+10;}
 185   2                      if(hysj==0x19) {if(sssddd>2) sssddd--;}
 186   2                      if(hysj==0x0d) {if(sssddd<15) sssddd++;} 
 187   2                      hysj=0;
 188   2              }
 189   1      
 190   1      }
 191          
 192          void LED_Display() interrupt 3  //                显示中断
 193          {
 194   1              if(yangshi==0) pinpu();
 195   1              if(yangshi==1) elsyx();
 196   1              if(yangshi>1) shezhi();
 197   1      }
 198          void Ad_Control() interrupt 1   //                控制ad采样时间        
 199          {
 200   1              ADC_CONTR = 0xe8;
 201   1      }
 202          
 203          void main()        //             主函数
 204          {
 205   1              Init();
 206   1              while(1)
 207   1              {
 208   2                      if(yangshi==0) pinpufft();
 209   2                      if(yangshi==1) elsfk();
 210   2                      if(yangshi==2) chan_shu();
 211   2                      if(yangshi==3) wanln();
 212   2                      if(yangshi==4) tcs_zhukong();
 213   2              }                                  
 214   1      }
 215          
 216          
 217          
 218          void pinpu()    //                中断频谱显示
 219          {
 220   1              TH1=0xf3;
 221   1              TL1=0xaa;
 222   1              LB[0]=LB[1];
 223   1              LB1[0]=LB1[1];
 224   1              //LB[15]=20;
 225   1              //LB[24]=20;
 226   1              //LB[33]=20;
 227   1              //LB[41]=20;
 228   1              //LB[53]=20;
 229   1              for     (G=0;G<64;G++)                          
 230   1              {
 231   2                      if(color==1)
 232   2                      {
 233   3                              if(LB[G]<=LINE+16)R1=1;
 234   3                              else R1=0;
 235   3                              if(LB[G]<=LINE)R2=1;
 236   3                              else R2=0;
 237   3      
 238   3                              if(LB1[G]==LINE){G1=1;G2=0;}
 239   3                              else if(LB1[G]==(LINE+16)){G1=0;G2=1;}
 240   3                              else G2=G1=1; 
 241   3                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 5   

 242   2                      if(color==0)
 243   2                      {
 244   3                              if(LB[G]<=LINE+16)G1=1;
 245   3                              else G1=0;
 246   3                              if(LB[G]<=LINE)G2=1;
 247   3                              else G2=0;
 248   3      
 249   3                              if(LB1[G]==LINE){R1=1;R2=0;}
 250   3                              else if(LB1[G]==(LINE+16)){R1=0;R2=1;}
 251   3                              else R2=R1=1;   
 252   3                      }
 253   2                      SHCP=1;
 254   2                      _nop_();
 255   2                      _nop_();
 256   2                      _nop_();
 257   2                      SHCP=0;         
 258   2              }
 259   1              P2M0|=0x10;
 260   1              scan(15-LINE);
 261   1              STCP=1;
 262   1              _nop_();
 263   1              _nop_();
 264   1              _nop_();
 265   1              STCP=0;
 266   1              P2M0&=0xef;
 267   1      
 268   1              //delay(4);
 269   1      
 270   1              if(LINE>0) LINE--;
 271   1              else LINE=15;
 272   1              for(jj=0;jj<4;jj++)
 273   1              {
 274   2                      if(LB[COUNT]>0)
 275   2                              LB[COUNT]--;    
 276   2                      if(COUNT>0)
 277   2                              COUNT--;        
 278   2                      else 
 279   2                              COUNT=64-1;
 280   2              }
 281   1              for(jj=0;jj<4;jj++)
 282   1              {
 283   2                      if(stop==1)
 284   2                      {
 285   3                              if(LB2[COUNT1]==0)
 286   3                              {
 287   4                                      if(LB1[COUNT1]>LB[COUNT1])LB1[COUNT1]--;
 288   4                              }
 289   3                              else 
 290   3                                      LB2[COUNT1]--;
 291   3                      COUNT1++;
 292   3                      stop=0;
 293   3                      }
 294   2                      else
 295   2                      stop=1;
 296   2              }
 297   1              if(COUNT1>=64) COUNT1=0;
 298   1              if(key_qu_ren==0|aaajjj==0x40)
 299   1              {
 300   2                      for(G=0;G<100;G++);
 301   2                      if(key_qu_ren==0|aaajjj==0x40) {aaajjj=0;ysh=2;ysfu=yangshi;}
 302   2              }
 303   1      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 6   

 304          
 305          
 306          
 307          void FFT()               //               fft算法
 308          {
 309   1              for( i=1; i<=7; i++)                         
 310   1              {
 311   2                      b=1;
 312   2                      b <<=(i-1);                                       
 313   2                      for( j=0; j<=b-1; j++)                             
 314   2                      {
 315   3                              p=1;
 316   3                              p <<= (7-i);            
 317   3                              p = p*j;
 318   3                              for( k=j; k<128; k=k+2*b)             
 319   3                              {
 320   4                                      Real = ttb1.eal[k]; Imag = ttb2.age[k]; temp = ttb1.eal[k+b];
 321   4                                      ttb1.eal[k] = ttb1.eal[k] + ((ttb1.eal[k+b]*COS_TAB[p])>>7) + ((ttb2.age[k+b]*SIN_TAB[p])>>7);
 322   4                                      ttb2.age[k] = ttb2.age[k] - ((ttb1.eal[k+b]*SIN_TAB[p])>>7) + ((ttb2.age[k+b]*COS_TAB[p])>>7);
 323   4                                      ttb1.eal[k+b] = Real - ((ttb1.eal[k+b]*COS_TAB[p])>>7) - ((ttb2.age[k+b]*SIN_TAB[p])>>7);
 324   4                                      ttb2.age[k+b] = Imag + ((temp*SIN_TAB[p])>>7) - ((ttb2.age[k+b]*COS_TAB[p])>>7);              
 325   4                                      ttb1.eal[k] >>= 1;             
 326   4                                      ttb2.age[k] >>= 1; 
 327   4                                      ttb1.eal[k+b]  >>= 1;                 
 328   4                                      ttb2.age[k+b]  >>= 1;
 329   4                              }
 330   3                      }
 331   2              } 
 332   1              ttb1.eal[0]=ttb2.age[0]=0;
 333   1              for(j=0;j<64;j++)                                                                                        
 334   1              {
 335   2                      TEMP1=((((ttb1.eal[j]* ttb1.eal[j]))+((ttb2.age[j]*ttb2.age[j]))));
 336   2                      if(TEMP1<8)TEMP1=0;
 337   2                      else if(TEMP1<12)TEMP1=1;
 338   2                      else if(TEMP1<18)TEMP1=2;
 339   2                      else if(TEMP1<28)TEMP1=3;
 340   2                      else if(TEMP1<40)TEMP1=4;
 341   2                      else if(TEMP1<49)TEMP1=5;
 342   2                      else if(TEMP1<64)TEMP1=6;
 343   2                      else if(TEMP1<81)TEMP1=7;
 344   2                      else if(TEMP1<100)TEMP1=8;
 345   2                      else if(TEMP1<121)TEMP1=9;
 346   2                      else if(TEMP1<144)TEMP1=10;
 347   2                      else if(TEMP1<169)TEMP1=11;
 348   2                      else if(TEMP1<196)TEMP1=12;
 349   2                      else if(TEMP1<225)TEMP1=13;
 350   2                      else if(TEMP1<256)TEMP1=14;
 351   2                      else if(TEMP1<270)TEMP1=15;
 352   2                      else if(TEMP1<324)TEMP1=16;
 353   2                      else if(TEMP1<361)TEMP1=17;
 354   2                      else if(TEMP1<400)TEMP1=18;
 355   2                      else if(TEMP1<441)TEMP1=19;
 356   2                      else if(TEMP1<484)TEMP1=20;
 357   2                      else if(TEMP1<529)TEMP1=21;
 358   2                      else if(TEMP1<576)TEMP1=22;
 359   2                      else if(TEMP1<625)TEMP1=23 ;
 360   2                      else if(TEMP1<676)TEMP1=24;
 361   2                      else if(TEMP1<729)TEMP1=25;
 362   2                      else if(TEMP1<784)TEMP1=26;
 363   2                      else if(TEMP1<841)TEMP1=27;
 364   2                      else if(TEMP1<900)TEMP1=28;
 365   2                      else if(TEMP1<961)TEMP1=29;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 7   

 366   2                      else if(TEMP1<1024)TEMP1=30;
 367   2                      else TEMP1=31;  
 368   2                      if(TEMP1>(LB[j]))LB[j]=TEMP1;        
 369   2                      if(TEMP1>(LB1[j]))
 370   2                      {
 371   3                              LB1[j]=TEMP1;
 372   3                              LB2[j]=8;
 373   3                      }
 374   2              }
 375   1      }
 376          
 377          
 378          
 379          
 380          void pinpufft()         //                频谱主控
 381          {
 382   1              ADC_Count=0;
 383   1              TR0=1;
 384   1              EADC=1;
 385   1              while(ADC_Count<128);
 386   1              for(i=0;i<128;i++)
 387   1              {
 388   2                      ttb2.age[i]=0;
 389   2              }
 390   1              FFT();
 391   1              if(ysh!=yangshi)
 392   1              {
 393   2                 yangshi=ysh;
 394   2                 qing_huan_chong();
 395   2              }
 396   1      }
 397          
 398          
 399          
 400          void delay(uint ran_shi)        //              延时
 401          {
 402   1          while (ran_shi--)
 403   1          {
 404   2              _nop_();
 405   2              _nop_();
 406   2              }
 407   1      }
 408          
 409          
 410          void DS18B20_Reset_1T()         
 411          {
 412   1          CY = 1;
 413   1          while (CY)
 414   1          {
 415   2              ds18b20 = 0;             
 416   2              delay(240);        
 417   2              delay(170);
 418   2              ds18b20 = 1;               
 419   2              delay(60);         
 420   2              CY = ds18b20;               
 421   2              delay(200);     
 422   2          }
 423   1      }
 424          
 425          
 426          uchar DS18B20_ReadByte_1T()                             
 427          {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 8   

 428   1          uchar dat = 0;
 429   1          for (ii=0; ii<8; ii++)          
 430   1          {
 431   2              dat >>= 1;
 432   2              ds18b20 = 0;                
 433   2              delay(1);              
 434   2              ds18b20 = 1;                   
 435   2              delay(1);               
 436   2              if (ds18b20) dat |= 0x80;      
 437   2              delay(45);              
 438   2          }
 439   1          return dat;
 440   1      }
 441          
 442          
 443          void DS18B20_WriteByte_1T(uchar dat)     
 444          {
 445   1          for (ii=0; ii<8; ii++)        
 446   1          {
 447   2              ds18b20 = 0;                    
 448   2              delay(1);               
 449   2              dat >>= 1;                
 450   2              ds18b20 = CY;
 451   2              delay(50);         
 452   2              ds18b20 = 1;               
 453   2              delay(1);             
 454   2          }
 455   1      }
 456          
 457          
 458          
 459          void read_ds18b20_1T()   
 460          {
 461   1              while (!ds18b20); 
 462   1          DS18B20_Reset_1T();                
 463   1          DS18B20_WriteByte_1T(0xCC);        
 464   1          DS18B20_WriteByte_1T(0xBE);       
 465   1          TPL = DS18B20_ReadByte_1T();      
 466   1          TPH = DS18B20_ReadByte_1T();
 467   1              if(TPH>200)
 468   1              {
 469   2                      TPH=~TPH;
 470   2                      TPL=~TPL;
 471   2              } 
 472   1              wen=TPH*160+(TPL/16)*10+(TPL%16)*5/8;           
 473   1          DS18B20_Reset_1T();               
 474   1          DS18B20_WriteByte_1T(0xCC);       
 475   1          DS18B20_WriteByte_1T(0x44);  
 476   1      }
 477          
 478          
 479          
 480          void Write1302 ( uchar addr,uchar dat )          //
 481          {
 482   1              uchar temp2;
 483   1              ds1302rst=0; 
 484   1              ds1302cslk=0; 
 485   1              ds1302rst = 1; 
 486   1              for ( ii=8; ii>0; ii-- )
 487   1              {
 488   2                      ds1302cslk = 0;
 489   2                      temp2 = addr;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 9   

 490   2                      ds1302io = (bit)(temp2&0x01);
 491   2                      addr >>= 1;
 492   2                      ds1302cslk = 1;
 493   2              }
 494   1              
 495   1              for ( ii=8; ii>0; ii-- )
 496   1              {
 497   2                      ds1302cslk = 0;
 498   2                      temp2 = dat;
 499   2                      ds1302io = (bit)(temp2&0x01);
 500   2                      dat >>= 1;
 501   2                      ds1302cslk = 1;
 502   2              }
 503   1              ds1302rst = 0;
 504   1      }
 505          
 506          uchar Read1302 ( uchar addr )      //
 507          {
 508   1              uchar temp2,dat1;
 509   1              ds1302rst=0;
 510   1              ds1302cslk=0;
 511   1              ds1302rst = 1;
 512   1              for ( ii=8; ii>0; ii-- )
 513   1              {
 514   2                      ds1302cslk = 0;
 515   2                      temp2 = addr;
 516   2                      ds1302io = (bit)(temp2&0x01);
 517   2                      addr >>= 1;
 518   2                      ds1302cslk = 1;
 519   2              }
 520   1              
 521   1              for ( ii=8; ii>0; ii-- )
 522   1              {
 523   2                      ACC_7=ds1302io;
 524   2                      ds1302cslk = 1;
 525   2                      ACC>>=1;
 526   2                      ds1302cslk = 0;
 527   2              }
 528   1              ds1302rst=0;
 529   1              dat1=ACC;
 530   1              return (dat1);
 531   1      }
 532          
 533          void Initial()    //       1302初始化
 534          {
 535   1              p=Read1302 (du_miao);
 536   1              if((p>>=7)>=1)
 537   1              {
 538   2                      Write1302 (xie_dian_yuan,0x00);
 539   2                      Write1302 (xie_miao,0x00); 
 540   2                      Write1302 (xie_fen_zhong,0x44);
 541   2                      Write1302 (xie_xiao_shi,0x10);
 542   2                      Write1302 (xie_tian,0x02);
 543   2                      Write1302 (xie_xin_qi,0x01);
 544   2                      Write1302 (xie_yue,0x05);
 545   2                      Write1302 (xie_nian,0x14);
 546   2                      Write1302 (xie_chong_din,0xa3); 
 547   2                      Write1302 (xie_dian_yuan,0x80);
 548   2              }
 549   1      }
 550          
 551          
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 10  

 552          
 553          void elsyx()     //                俄罗斯方块中断显示
 554          {
 555   1              TH1=0xf5;
 556   1              TL1=0Xca;
 557   1              for(bianjie=0;bianjie<64;bianjie++)
 558   1              {
 559   2                      if(sscan==0)
 560   2                      {
 561   3                              if(bianjie<56)
 562   3                              {
 563   4                                      R1=0;
 564   4                                      if(bianjie==0)R2=0; else R2=1;
 565   4                                      if(bianjie>0)
 566   4                                      {       
 567   5                                              if((((ttb1.eal[(bianjie-1)/3+4])>>5)&0x0001)>0)G2=0; else G2=1;
 568   5                                      
 569   5                                      }
 570   4                                      if(bianjie==55) 
 571   4                                      {
 572   5                                              R1=R2=0;
 573   5                                      }
 574   4                              }
 575   3                              else
 576   3                              {
 577   4                                      R1=R2=1;
 578   4                                      if(bianjie>55)
 579   4                              
 580   4                                      {
 581   5                                              if(((fensu[efenqian*6]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 582   5                                              if(((fensu[efenshi*6+4]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 583   5                                      }
 584   4                                      G2=1;
 585   4                              }
 586   3      
 587   3      
 588   3                      }
 589   2                      if(0<sscan)
 590   2                      {
 591   3                              if(sscan<15)
 592   3                              {
 593   4                                      if(bianjie<56)
 594   4                                      {
 595   5                                              if(bianjie==0)
 596   5                                              {
 597   6                                                      R2=0;
 598   6                                                      R1=0;
 599   6                                              }
 600   5                                              else
 601   5                                              { 
 602   6                                                      R2=1;
 603   6                                                      R1=1;
 604   6                                              }
 605   5              
 606   5                                              if(bianjie>0)
 607   5                                              {       
 608   6                                                      if((((ttb1.eal[(bianjie-1)/3+4])>>((sscan-1)/3))&0x0001)>0)G1=0; else G1=1;
 609   6                                                      if(bianjie>1)
 610   6                                                      {
 611   7                                                              if((sscan-2)%3==0)
 612   7                                                              {       
 613   8                                                                      if(sscan!=1)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 11  

 614   8                                                                      if(((bianjie-2)%3)==0) {G1=1;if(daid==0) R1=0;}
 615   8                                                              }
 616   7                                                              
 617   7                                                      }
 618   6                                                      
 619   6                                                      
 620   6              
 621   6              
 622   6                                                      if((((ttb1.eal[(bianjie-1)/3+4])>>(sscan/3+5))&0x0001)>0)G2=0; else G2=1;
 623   6                                                      if((sscan-1)%3==0)
 624   6                                                      {
 625   7                                                              if(bianjie>1)
 626   7                                                              {
 627   8                                                                      if(((bianjie-2)%3)==0){ G2=1;if(daid==0) R2=0;}
 628   8                                                              }
 629   7                                                      }
 630   6                                              }
 631   5                                              if(bianjie==55) 
 632   5                                              {
 633   6                                                      R1=R2=0;
 634   6                                                      G1=G2=1;
 635   6                                              }
 636   5                                      }
 637   4                                      else
 638   4                                      {
 639   5                                              
 640   5                                              G2=1;
 641   5                                              G1=1;
 642   5                                              R1=R2=1;
 643   5                                              if(bianjie>55)
 644   5                                      
 645   5                                              { 
 646   6                                                      if(sscan==1)
 647   6                                                      {
 648   7                                                              if(((fensu[efenqian*6+1]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 649   7                                                              if(((fensu[efenshi*6+5]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 650   7                                                      }
 651   6                                                      if(sscan==2)
 652   6                                                      {
 653   7                                                              if(((fensu[efenqian*6+2]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 654   7                                                              if(((fensu[efenge*6]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 655   7                                                      }
 656   6                                                      if(sscan==3)
 657   6                                                      {
 658   7                                                              if(((fensu[efenqian*6+3]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 659   7                                                              if(((fensu[efenge*6+1]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 660   7                                                      }
 661   6                                                      if(sscan==4)
 662   6                                                      {
 663   7                                                               if(((fensu[efenqian*6+4]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 664   7                                                              if(((fensu[efenge*6+2]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 665   7                                                      }
 666   6                                                      if(sscan==5)
 667   6                                                      {
 668   7                                                               if(((fensu[efenqian*6+5]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 669   7                                                              if(((fensu[efenge*6+3]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 670   7                                                      }
 671   6                                                      if(sscan==6)
 672   6                                                      {
 673   7                                                               if(((fensu[efenbai*6]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 674   7                                                              if(((fensu[efenge*6+4]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 675   7                                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 12  

 676   6                                                      if(sscan==7)
 677   6                                                      {
 678   7                                                               if(((fensu[efenbai*6+1]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 679   7                                                              if(((fensu[efenge*6+5]>>(bianjie-56))&0x01)>0) R2=1; else R2=0;
 680   7                                                      }
 681   6                                                      if(sscan==8)
 682   6                                                      {
 683   7                                                               if(((fensu[efenbai*6+2]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 684   7                                                               if(((fangk[newxinz][newfangx][(bianjie-56)/2])&0x01)>0) G2=0; else G2=1;
 685   7                                                      }
 686   6                                                      if(sscan==9)
 687   6                                                      {
 688   7                                                               if(((fensu[efenbai*6+3]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 689   7                                                               if(((fangk[newxinz][newfangx][(bianjie-56)/2])&0x01)>0) G2=0; else G2=1;
 690   7                                                      }
 691   6                                                      if(sscan==10)
 692   6                                                      {
 693   7                                                               if(((fensu[efenbai*6+4]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 694   7                                                               if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>1)&0x01)>0) G2=0; else G2=1;
 695   7                                                      }
 696   6                                                      if(sscan==11)
 697   6                                                      {
 698   7                                                               if(((fensu[efenbai*6+5]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 699   7                                                               if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>1)&0x01)>0) G2=0; else G2=1;
 700   7                                                      }
 701   6                                                      if(sscan==12)
 702   6                                                      {
 703   7                                                               if(((fensu[efenshi*6]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 704   7                                                               if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>2)&0x01)>0) G2=0; else G2=1;
 705   7                                                      }
 706   6                                                      if(sscan==13)
 707   6                                                      {
 708   7                                                               if(((fensu[efenshi*6+1]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 709   7                                                               if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>2)&0x01)>0) G2=0; else G2=1;
 710   7                                                      }
 711   6                                                      if(sscan==14)
 712   6                                                      {
 713   7                                                               if(((fensu[efenshi*6+2]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 714   7                                                               if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>3)&0x01)>0) G2=0; else G2=1;
 715   7                                                      }
 716   6      
 717   6                                              }
 718   5                                      }
 719   4                              }
 720   3                      }
 721   2                      if(sscan==15)
 722   2                      {
 723   3                              if(bianjie<56)
 724   3                              {
 725   4                                      R2=0;G2=1;
 726   4                                      if(bianjie==0)R1=0; else R1=1;
 727   4                                      if(bianjie>0)
 728   4                                      {       
 729   5                                              if((((ttb1.eal[(bianjie-1)/3+4])>>4)&0x0001)>0)G1=0; else G1=1;
 730   5                                              
 731   5                                      }
 732   4                                      if(bianjie==55) 
 733   4                                      {
 734   5                                              R1=R2=0;
 735   5                                      }
 736   4                              }
 737   3                              else
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 13  

 738   3                              {
 739   4                                      R1=R2=1;
 740   4                                      R2=1;
 741   4                                      G1=1;
 742   4                                      if(bianjie>55)
 743   4                                      {
 744   5                                              if(((fensu[efenshi*6+3]>>(bianjie-56))&0x01)>0) R1=1; else R1=0;
 745   5                                              if((((fangk[newxinz][newfangx][(bianjie-56)/2])>>3)&0x01)>0) G2=0; else G2=1;
 746   5                                      }
 747   4                              }
 748   3                      }
 749   2                      SHCP=1;
 750   2                      delay(2);
 751   2                      SHCP=0;
 752   2              }
 753   1              P2M0|=0x10;
 754   1              STCP=1;
 755   1              delay(2);
 756   1              STCP=0; 
 757   1              scan(sscan);
 758   1              P2M0&=0xef;
 759   1              if(sscan<15) sscan++; else sscan=0;
 760   1              i++;
 761   1              if(i==(250/sudu))
 762   1              {       
 763   2                      j++;
 764   2                      i=0;
 765   2                      if(j>3)
 766   2                      {xiaxia=1;
 767   3                      j=0;
 768   3                      }
 769   2              }
 770   1              if((key_qu_ren==0&&key_fan_hiu==0)|aaajjj==0x46)
 771   1              {
 772   2                      for(bianjie=0;bianjie<100;bianjie++);
 773   2                      if((key_qu_ren==0&&key_fan_hiu==0)|aaajjj==0x46) {aaajjj=0;ysh=2; ysfu=yangshi;}
 774   2              }
 775   1      }
 776          
 777          
 778          
 779          void elsfk()      //            俄罗斯方块主控
 780          {
 781   1              if(kai_sh==1) kai_shi=1;
 782   1              while(kai_shi&&ysh==1)
 783   1              {
 784   2                      for(p=0;p<64;p++)
 785   2                      {
 786   3                              ttb1.eal[p]=0x0c00;
 787   3                                 
 788   3                      }
 789   2                      ttb1.eal[3]=0x0fff;
 790   2                      ttb1.eal[2]=0x0fff;
 791   2                      ttb1.eal[1]=0x0fff;
 792   2                      ttb1.eal[0]=0x0fff;
 793   2                      efenge=1;
 794   2                      while(kai_sh&&ysh==1)
 795   2                      {
 796   3                              if(key_jia==0|aaajjj==0x44)
 797   3                      {
 798   4                                      delay(2000);
 799   4                                      if(key_jia==0|aaajjj==0x44)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 14  

 800   4                                      {       aaajjj=0;
 801   5                                              efenge++;
 802   5                                              if(efenge>9) efenge--;                  
 803   5                                      }
 804   4                                      delay(10000);
 805   4                                      
 806   4                              }
 807   3                              if(key_jian==0|aaajjj==0x43)
 808   3                              {
 809   4                                      delay(2000);
 810   4                                      if(key_jian==0|aaajjj==0x43)
 811   4                                      {       aaajjj=0;
 812   5                                              efenge--;
 813   5                                              if(efenge==0) efenge++;
 814   5                                      }
 815   4                                      delay(10000);
 816   4                                      
 817   4                              }
 818   3                              if(key_qu_ren==0|aaajjj==0x40)
 819   3                              {
 820   4                                      delay(1000);
 821   4                                      if(key_qu_ren==0|aaajjj==0x40)
 822   4                                      {
 823   5                                              while(key_qu_ren==0&&aaajjj==0x40) 
 824   5                                              {       
 825   6                                                      aaajjj=0;
 826   6                                                      COUNT++;
 827   6                                                      delay(10);
 828   6                                                      if(COUNT==30) COUNT=5;
 829   6                                              }
 830   5                                              kai_shi=0;
 831   5                                              kai_sh=0;
 832   5                                              sudu=efenge;
 833   5                                              efenge=0;
 834   5                                              srand(rand()+fangx+fkx+fky+COUNT);
 835   5                                              fkx=4;
 836   5                                              fky=18;
 837   5                                              xinz=newxinz;
 838   5                                              fangx=newfangx;
 839   5                                          newxinz=rand()%6;
 840   5                                              newfangx=rand()%3;
 841   5                                              srand(rand()+fangx+fkx+fky+COUNT);
 842   5                                              xinz=newxinz;
 843   5                                              fangx=newfangx;
 844   5                                          newxinz=rand()%6;
 845   5                                              newfangx=rand()%3;
 846   5                                              TEMP1=0;                
 847   5                                      }
 848   4                              }
 849   3                      }
 850   2              }
 851   1              kai_shi=1;
 852   1              xiefk();
 853   1              while(kai_shi&&ysh==1)
 854   1              {
 855   2                      if(key_jia==0|aaajjj==0x44)
 856   2              {
 857   3                              delay(1000);
 858   3                              if(key_jia==0|aaajjj==0x44)
 859   3                              {       aaajjj=0;
 860   4                                      if(fkx>0)
 861   4                                      {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 15  

 862   5                                              qufk();
 863   5                                         fkx--;
 864   5                                         if(chongt()==1) fkx++;
 865   5                                         xiefk();
 866   5                                       }
 867   4                              }
 868   3                              delay(13000);
 869   3                      }
 870   2                      if(key_jian==0|aaajjj==0x43)
 871   2                      {
 872   3                              delay(1000);
 873   3                              if(key_jian==0|aaajjj==0x43)
 874   3                              {       aaajjj=0;
 875   4                                      qufk();                 
 876   4                                 fkx++;
 877   4                                 if(chongt()==1) fkx--;
 878   4                                 xiefk();                             
 879   4                              }
 880   3                              delay(13000);
 881   3                      }
 882   2                      if(key_qu_ren==0|aaajjj==0x40)
 883   2                      {
 884   3                              delay(1000);
 885   3                              if(key_qu_ren==0|aaajjj==0x40)
 886   3                              {       aaajjj=0;
 887   4                                      qufk();         
 888   4                                 fangx++;
 889   4                                 if(chongt()==1) fangx--;
 890   4                                 if(fangx>3) fangx=0;
 891   4                                 xiefk();                             
 892   4                              }
 893   3                              while(key_qu_ren==0);
 894   3                              delay(1000);
 895   3                              
 896   3                      }
 897   2      
 898   2                       if(key_fan_hiu==0|aaajjj==0x15)
 899   2                      {
 900   3                              delay(1000);
 901   3                              if(key_fan_hiu==0|aaajjj==0x15)
 902   3                              {       
 903   4                                      //qufk();
 904   4                                      COUNT1=1;
 905   4                                      while((key_fan_hiu==0&&COUNT1==1)||aaajjj==0x15)
 906   4                                      {               
 907   5                                                      qufk();
 908   5                                                  fky--;
 909   5                                                 if(chongt()==1)
 910   5                                                 {
 911   6                                                              
 912   6                                                              COUNT1=0;
 913   6                                                               fky++;
 914   6                                                               xiaxia=1;
 915   6                                                               aaajjj=0;
 916   6                                                 }
 917   5                                                 if(COUNT1==1)
 918   5                                                 {
 919   6                                                         //fky++;
 920   6                                                         //qufk();
 921   6                                                         //fky--;
 922   6                                                         xiefk();
 923   6                                                 }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 16  

 924   5                                                 delay(1500); 
 925   5                                   }
 926   4                                 xiefk();                             
 927   4                              }
 928   3                              delay(1000);
 929   3                      }
 930   2      
 931   2      
 932   2                      if(xiaxia==1)
 933   2                      {        
 934   3                              qufk();
 935   3                              fky--;
 936   3                              if(chongt()==1)
 937   3                              {
 938   4                                      fky++;
 939   4                                      xiefk();
 940   4                                      manfk();
 941   4                                      chanfk();
 942   4                                      if(chongt()==1)
 943   4                                         {
 944   5                                                      xiefk();
 945   5                                                      while(key_qu_ren==1&&aaajjj==0);
 946   5                                                      aaajjj=0;
 947   5                                                      delay(65534);
 948   5                                                  for(p=0;p<64;p++)
 949   5                                                      {
 950   6                                                              ttb1.eal[p]=0x0c00;
 951   6                                                                 
 952   6                                                      }
 953   5                                                      ttb1.eal[3]=0x0fff;
 954   5                                                      ttb1.eal[2]=0x0fff;
 955   5                                                      ttb1.eal[1]=0x0fff;
 956   5                                                      ttb1.eal[0]=0x0fff;
 957   5                                                      kai_shi=0;
 958   5                                                      kai_sh=1;
 959   5                                         } 
 960   4                                              
 961   4                              }
 962   3                              xiefk();
 963   3                              if(kai_sh==1) qufk();
 964   3                              xiaxia=0;
 965   3                      }
 966   2                      if(yangshi==0) kai_shi=0;       
 967   2              }
 968   1              if(ysh!=yangshi)
 969   1              {
 970   2                 yangshi=ysh;
 971   2                 qing_huan_chong();
 972   2              }       
 973   1      }
 974          
 975          void qufk()     //                              取一个方块
 976          {
 977   1              for(p=0;p<4;p++)
 978   1              {
 979   2                      G=fangk[xinz][fangx][p];
 980   2                      for(k=0;k<4;k++)
 981   2                      {
 982   3                              if((G&0x01)>0)
 983   3                              {
 984   4                                       ttb1.eal[fky+p]&=qufksz[fkx+k];
 985   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 17  

 986   3                              G>>=1;  
 987   3                      }
 988   2              }
 989   1      }
 990          
 991          void xiefk()    //                      写一个方块
 992          {
 993   1              uint fkxie;
 994   1              for(k=0;k<4;k++)
 995   1              {
 996   2                      fkxie=fangk[xinz][fangx][k];
 997   2                      fkxie<<=fkx;
 998   2                      ttb1.eal[fky+k]|=fkxie;
 999   2              }
1000   1      }
1001          
1002          
1003          
1004          void chanfk()     //             产生一个方块
1005          {
1006   1              srand(rand()+fangx+fkx+fky);
1007   1              fkx=4;
1008   1              fky=18;
1009   1              xinz=newxinz;
1010   1              fangx=newfangx;
1011   1          newxinz=rand()%7;
1012   1              newfangx=rand()%4;
1013   1      }
1014          
1015          
1016          
1017          void manfk()     //              满行处理
1018          {
1019   1              G=0;
1020   1              for(k=4;k<22;k++)
1021   1              {
1022   2                      if(ttb1.eal[k]==0x0fff)
1023   2                      {
1024   3                      G++; 
1025   3                      ttb1.eal[k]=0;
1026   3                      }
1027   2              }
1028   1              delay(5000);
1029   1              for(k=4;k<22;k++)
1030   1              {
1031   2                      if(ttb1.eal[k]==0) ttb1.eal[k]=0x0fff;
1032   2              }
1033   1              delay(5000);
1034   1              for(k=4;k<22;k++)
1035   1              {
1036   2                      if(ttb1.eal[k]==0x0fff) ttb1.eal[k]=0;
1037   2              }
1038   1              delay(5000);
1039   1              for(k=4;k<22;k++)
1040   1              {
1041   2                      if(ttb1.eal[k]==0)
1042   2                      {
1043   3                               p=k;
1044   3                               for(b=p;b<22;b++)
1045   3                               {
1046   4                                        ttb1.eal[b]=ttb1.eal[b+1];
1047   4                               }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 18  

1048   3                               ttb1.eal[22]=0x0c00;
1049   3                               k--;
1050   3                      }
1051   2              }
1052   1               if(G==1) TEMP1+=1;
1053   1               if(G==2) TEMP1+=2;
1054   1               if(G==3) TEMP1+=5;
1055   1               if(G==4) TEMP1+=10;
1056   1              efenge=TEMP1%10;
1057   1              efenshi=TEMP1%100/10; 
1058   1              efenbai=TEMP1%1000/100;
1059   1              efenqian=TEMP1/1000;       
1060   1      }
1061          
1062          
1063          
1064          uchar chongt()    //              方块碰撞检测
1065          {
1066   1              b=0;
1067   1              temp=0x0000;
1068   1              for(k=0;k<4;k++)
1069   1              {
1070   2              temp=fangk[xinz][fangx][k];
1071   2              temp<<=fkx;     
1072   2              if((temp+(ttb1.eal[(fky+k)]))!=(temp|(ttb1.eal[(fky+k)]))) b=1;
1073   2              }
1074   1              return(b);
1075   1              
1076   1      }
1077          
1078          
1079          void shezhi()   //设置和显示扫描
1080          {
1081   1              TH1=0xf5;
1082   1              TL1=0Xca;
1083   1              for(bianjie=0;bianjie<8;bianjie++)
1084   1              {       
1085   2                      i=ttb1.sjr[bianjie+sscan*8];
1086   2                      j=ttb1.sjr[bianjie+sscan*8+128];
1087   2                      k=ttb2.sjg[bianjie+sscan*8];
1088   2                      b=ttb2.sjg[bianjie+sscan*8+128];                                        
1089   2                      for(sudu=0;sudu<8;sudu++)
1090   2                      {
1091   3                              p=i; if(((p>>sudu)&0x01)>0) R1=1; else R1=0;
1092   3                              p=j; if(((j>>sudu)&0x01)>0) R2=1; else R2=0;
1093   3                              p=k; if(((k>>sudu)&0x01)>0) G1=1; else G1=0;
1094   3                              p=b; if(((b>>sudu)&0x01)>0) G2=1; else G2=0;
1095   3                              SHCP=1;
1096   3                              delay(2);
1097   3                              SHCP=0;
1098   3                      }
1099   2              }
1100   1              P2M0|=0x10;
1101   1              STCP=1;
1102   1              delay(2);
1103   1              STCP=0; 
1104   1              scan(sscan);
1105   1              P2M0&=0xef;
1106   1              if(sscan<15) sscan++; else sscan=0;
1107   1              ansdw++;
1108   1              if(ansdw==397&&yangshi==3)
1109   1              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 19  

1110   2                      P2M0|=0x10;
1111   2                      wnian=Read1302(du_nian);
1112   2                      wyue=Read1302(du_yue);
1113   2                      wri=Read1302(du_tian);
1114   2                      wxinq=Read1302(du_xin_qi);
1115   2                      wshi=Read1302(du_xiao_shi);
1116   2                      wfen=Read1302(du_fen_zhong);
1117   2                      P2M0&=0xef;
1118   2              }
1119   1              if(ansdw>757)
1120   1              {
1121   2                      ansdw=0;
1122   2                      P2M0|=0x10;
1123   2                      read_ds18b20_1T();
1124   2                      P2M0&=0xef;
1125   2              }
1126   1              kai_sh++;
1127   1              if(kai_sh>100)
1128   1              {
1129   2              kai_sh=0;
1130   2              P2M0|=0x10;
1131   2              biankuang();
1132   2              P2M0&=0xef;             
1133   2              }
1134   1              Real++;
1135   1              if(Real>340)
1136   1              {
1137   2                      Real=0;
1138   2                      if(yangshi==3&&xyz==1)
1139   2                      {
1140   3                              P2M0|=0x10;
1141   3                              if(stop==0) huashidian(); else qushidian();
1142   3                              P2M0&=0xef;
1143   3                              stop=~stop;
1144   3                      }
1145   2              }
1146   1              /*if((yangshi!=4&&yangshi!=2&&key_qu_ren==0)|(yangshi!=2&&aaajjj==0x40))
1147   1              {
1148   1                      for(sudu=0;sudu<100;sudu++);
1149   1                      if(key_qu_ren==0|aaajjj==0x40) {aaajjj=0;ysh=2; ysfu=yangshi;}
1150   1              }*/
1151   1              if(key_qu_ren==0&&key_fan_hiu==0)
1152   1              {
1153   2                      for(sudu=0;sudu<100;sudu++);
1154   2                      if((key_qu_ren==0&&key_fan_hiu==0)) {aaajjj=0;ysh=2; ysfu=yangshi;}
1155   2              }
1156   1              if(yangshi!=2&&aaajjj==0x40) {aaajjj=0;ysh=2; ysfu=yangshi;}
1157   1      
1158   1              if(yangshi==4)
1159   1              { 
1160   2                      tcssd++;
1161   2                      if(tcssd>(500/sssddd))
1162   2                      {
1163   3                              tcssd=0;
1164   3                              efenbai=1;
1165   3                      }
1166   2              } 
1167   1      }
1168          
1169          
1170          void chan_shu()   //参数设置函数
1171          {       
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 20  

1172   1              jishu=1;
1173   1              szxh=1;
1174   1              qing_hong();
1175   1              qing_nv();
1176   1              for(jj=0;jj<64;jj++)
1177   1              {
1178   2                      LB[jj]=ajshezhi1[jj];
1179   2                      LB1[jj]=ajshezhi1[jj+64];
1180   2                      LB2[jj]=ajshezhi1[jj+128];
1181   2              }
1182   1              jj=0;
1183   1              while(key_jian==0);
1184   1              while(key_qu_ren==0);
1185   1              yiji=1;
1186   1              while(szxh)
1187   1              {
1188   2                      yjszxs();
1189   2                      while(yiji==4)  //显示设置
1190   2                      {
1191   3                              erszxs();
1192   3                              if(key_qu_ren==0|aaajjj==0x40)
1193   3                              {
1194   4                                      delay(5000);
1195   4                                      if(key_qu_ren==0|aaajjj==0x40)
1196   4                                      {       aaajjj=0;
1197   5                                              if(jishu==1) ysfu=0;
1198   5                                              if(jishu==2) ysfu=1;
1199   5                                              if(jishu==3) ysfu=3;
1200   5                                              if(jishu==4) ysfu=4;  //ttttttttttttttttttttttttttttttttttt
1201   5                                      }
1202   4                                      yiji=1;
1203   4                                      while(key_qu_ren==0);
1204   4                              
1205   4                              }
1206   3                      }
1207   2                      while(yiji==5)     //参数设置
1208   2                      {
1209   3                              erszxs();
1210   3                              if(key_qu_ren==0|aaajjj==0x40)
1211   3                              {
1212   4                                      delay(5000);
1213   4                                      if(key_qu_ren==0|aaajjj==0x40)
1214   4                                      {       aaajjj=0;
1215   5                                              if(jishu==1) erji=6;
1216   5                                              if(jishu==2) erji=7;
1217   5                                              if(jishu==3) erji=8;
1218   5                                              if(jishu==4) erji=9;
1219   5                                      }
1220   4                                      while(key_qu_ren==0);
1221   4                                      shanji=1;
1222   4                                      
1223   4                              }
1224   3                              if(key_fan_hiu==0|aaajjj==0x15)
1225   3                              {
1226   4                                      delay(5000);
1227   4                                      if(key_fan_hiu==0|aaajjj==0x15)
1228   4                                      {       aaajjj=0;
1229   5                                              yiji=1;
1230   5                                      }
1231   4                                      while(key_fan_hiu==0);
1232   4                              
1233   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 21  

1234   3                              while(erji==6)          //频谱颜色设置
1235   3                              {
1236   4                                      if(shanji==1)
1237   4                                      {       
1238   5                                              for(jj=0;jj<32;jj++)
1239   5                                              {
1240   6                                                      LB[jj]=ajshezhi1[jj];
1241   6                                              }
1242   5                                              qing_hong();
1243   5                                              qing_nv();
1244   5                                              hua_1616(50,23,2,0,0);
1245   5                                              for(jj=0;jj<32;jj++)
1246   5                                              {
1247   6                                                      LB[jj]=ajshezhi3[jj+96];
1248   6                                              }
1249   5                                              for(jj=0;jj<32;jj++)
1250   5                                              {
1251   6                                                      LB[jj+32]=ajshezhi3[jj+64];
1252   6                                              }                                       
1253   5                                              gunzhi(30,10000);                       
1254   5                                              jishu=shanji;
1255   5                                              shanji=3;
1256   5                                      }
1257   4                                      if(shanji==2)
1258   4                                      {       
1259   5                                              for(jj=0;jj<32;jj++)
1260   5                                              {
1261   6                                                      LB[jj]=ajshezhi1[jj];
1262   6                                              }
1263   5                                              qing_hong();
1264   5                                              qing_nv();
1265   5                                              hua_1616(50,23,2,0,0);
1266   5                                              for(jj=0;jj<32;jj++)
1267   5                                              {
1268   6                                                      LB[jj]=ajshezhi3[jj+64];
1269   6                                              }
1270   5                                              for(jj=0;jj<32;jj++)
1271   5                                              {
1272   6                                                      LB[jj+32]=ajshezhi3[jj+96];
1273   6                                              }                                       
1274   5                                              gunzhi(30,10000);                       
1275   5                                              jishu=shanji;
1276   5                                              shanji=3;
1277   5                                      }
1278   4                                      if(key_jia==0|aaajjj==0x44)
1279   4                                      {
1280   5                                              delay(5000);
1281   5                                              if(key_jia==0|aaajjj==0x44)
1282   5                                              {       aaajjj=0;
1283   6                                                      if(jishu==1) shanji=2; else shanji=1;
1284   6                                              }
1285   5                                              while(key_jia==0);
1286   5                                      
1287   5                                      }
1288   4                                      if(key_jian==0|aaajjj==0x43)
1289   4                                      {
1290   5                                              delay(5000);
1291   5                                              if(key_jian==0|aaajjj==0x43)
1292   5                                              {       aaajjj=0;
1293   6                                                      if(jishu==1) shanji=2; else shanji=1;
1294   6                                              }
1295   5                                              while(key_jia==0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 22  

1296   5                                      
1297   5                                      }
1298   4                                      if(key_qu_ren==0|aaajjj==0x40)
1299   4                                      {
1300   5                                              delay(5000);
1301   5                                              if(key_qu_ren==0|aaajjj==0x40)
1302   5                                              {       aaajjj=0;
1303   6                                                      if(jishu==1) color=1; else color=0;
1304   6                                              }
1305   5                                              while(key_qu_ren==0);
1306   5                                              erji=1;
1307   5                                      
1308   5                                      }
1309   4                              }
1310   3                              while(erji==7)     // 方块设置
1311   3                              {
1312   4                                      if(shanji==1)
1313   4                                      {       
1314   5                                              for(jj=0;jj<32;jj++)
1315   5                                              {
1316   6                                                      LB[jj]=k1616[jj+32];
1317   6                                              }
1318   5                                              qing_hong();
1319   5                                              qing_nv();
1320   5                                              hua_1616(50,23,2,0,0);
1321   5                                              for(jj=0;jj<32;jj++)
1322   5                                              {
1323   6                                                      LB[jj]=ajshezhi4[jj+32];
1324   6                                              }
1325   5                                              for(jj=0;jj<32;jj++)
1326   5                                              {
1327   6                                                      LB[jj+32]=ajshezhi4[jj];
1328   6                                              }                                       
1329   5                                              gunzhi(30,10000);                       
1330   5                                              jishu=shanji;
1331   5                                              shanji=3;
1332   5                                      }
1333   4                                      if(shanji==2)
1334   4                                      {       
1335   5                                              for(jj=0;jj<32;jj++)
1336   5                                              {
1337   6                                                      LB[jj]=k1616[jj+32];
1338   6                                              }
1339   5                                              qing_hong();
1340   5                                              qing_nv();
1341   5                                              hua_1616(50,23,2,0,0);
1342   5                                              for(jj=0;jj<32;jj++)
1343   5                                              {
1344   6                                                      LB[jj]=ajshezhi4[jj];
1345   6                                              }
1346   5                                              for(jj=0;jj<32;jj++)
1347   5                                              {
1348   6                                                      LB[jj+32]=ajshezhi4[jj+32];
1349   6                                              }                                       
1350   5                                              gunzhi(30,10000);                       
1351   5                                              jishu=shanji;
1352   5                                              shanji=3;
1353   5                                      }
1354   4                                      if(key_jia==0|aaajjj==0x44)
1355   4                                      {
1356   5                                              delay(5000);
1357   5                                              if(key_jia==0|aaajjj==0x44)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 23  

1358   5                                              {       aaajjj=0;
1359   6                                                      if(jishu==1) shanji=2; else shanji=1;
1360   6                                              }
1361   5                                              while(key_jia==0);
1362   5                                      
1363   5                                      }
1364   4                                      if(key_jian==0|aaajjj==0x43)
1365   4                                      {
1366   5                                              delay(5000);
1367   5                                              if(key_jian==0|aaajjj==0x43)
1368   5                                              {       aaajjj=0;
1369   6                                                      if(jishu==1) shanji=2; else shanji=1;
1370   6                                              }
1371   5                                              while(key_jia==0);
1372   5                                      
1373   5                                      }
1374   4                                      if(key_qu_ren==0|aaajjj==0x40)
1375   4                                      {
1376   5                                              delay(5000);
1377   5                                              if(key_qu_ren==0|aaajjj==0x40)
1378   5                                              {       aaajjj=0;
1379   6                                                      if(jishu==1) daid=0; else daid=1;
1380   6                                              }
1381   5                                              while(key_qu_ren==0);
1382   5                                              erji=1;
1383   5                                      
1384   5                                      }
1385   4                              }
1386   3                              while(erji==8)     //   万年历设置
1387   3                              {
1388   4                                      if(shanji==1)
1389   4                                      {
1390   5                                         for(foo=32;foo<60;foo++)
1391   5                                         {
1392   6                                                      for(foo1=5;foo1<26;foo1++)
1393   6                                                      {
1394   7                                                              qing_dian1(foo,foo1,3);
1395   7                                                              qing_dian1(63-foo,foo1,3);
1396   7                                                      }
1397   6                                                      delay(6000);
1398   6                                         }
1399   5                                         for(jj=0;jj<32;jj++)
1400   5                                              {
1401   6                                                      LB[jj+32]=ajshezhi1[jj+128];
1402   6                                              }
1403   5                                              for(jj=0;jj<32;jj++)
1404   5                                              {
1405   6                                                      LB[jj]=0xff;
1406   6                                              }
1407   5                                              gunzhi(30,3000);
1408   5                                              for(jj=0;jj<32;jj++)
1409   5                                              {
1410   6                                                      LB[jj+32]=ajshezhi1[jj+160];
1411   6                                              }
1412   5                                              for(jj=0;jj<32;jj++)
1413   5                                              {
1414   6                                                      LB[jj]=0xff;
1415   6                                              }
1416   5                                              gunzhi(50,3000);
1417   5                                              jishu=shanji;
1418   5                                              shanji=3;
1419   5                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 24  

1420   4                                      if(shanji==2)
1421   4                                      {
1422   5                                              for(foo=32;foo<60;foo++)
1423   5                                         {
1424   6                                                      for(foo1=5;foo1<26;foo1++)
1425   6                                                      {
1426   7                                                              qing_dian1(foo,foo1,3);
1427   7                                                              qing_dian1(63-foo,foo1,3);
1428   7                                                      }
1429   6                                                      delay(6000);
1430   6                                         }
1431   5                                         for(jj=0;jj<32;jj++)
1432   5                                              {
1433   6                                                      LB[jj+32]=ajshezhi4[jj+64];
1434   6                                              }
1435   5                                              for(jj=0;jj<32;jj++)
1436   5                                              {
1437   6                                                      LB[jj]=0xff;
1438   6                                              }
1439   5                                              gunzhi(30,3000);
1440   5                                              for(jj=0;jj<32;jj++)
1441   5                                              {
1442   6                                                      LB[jj+32]=ajshezhi4[jj+96];
1443   6                                              }
1444   5                                              for(jj=0;jj<32;jj++)
1445   5                                              {
1446   6                                                      LB[jj]=0xff;
1447   6                                              }
1448   5                                              gunzhi(50,3000);
1449   5                                              jishu=shanji;
1450   5                                              shanji=3;
1451   5                                      }
1452   4                                      if(key_jia==0|aaajjj==0x44)
1453   4                                      {
1454   5                                              delay(5000);
1455   5                                              if(key_jia==0|aaajjj==0x44)
1456   5                                              {       aaajjj=0;
1457   6                                                      if(jishu==1) shanji=2; else shanji=1;
1458   6                                              }
1459   5                                              while(key_jia==0);
1460   5                                              
1461   5                                      }
1462   4                                      if(key_jian==0|aaajjj==0x43)
1463   4                                      {
1464   5                                              delay(5000);
1465   5                                              if(key_jian==0|aaajjj==0x43)
1466   5                                              {       aaajjj=0;
1467   6                                                      if(jishu==1) shanji=2; else shanji=1;
1468   6                                              }
1469   5                                              while(key_jia==0);
1470   5                                      
1471   5                                      }
1472   4                                      if(key_qu_ren==0|aaajjj==0x40)
1473   4                                      {
1474   5                                              delay(5000);
1475   5                                              if(key_qu_ren==0|aaajjj==0x40)
1476   5                                              {       aaajjj=0;
1477   6                                                      if(jishu==1) shanji=4; else shanji=5;
1478   6                                              }
1479   5                                              while(key_qu_ren==0);
1480   5                                              shiji=1;
1481   5                                      
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 25  

1482   5                                      }
1483   4                                      if(key_fan_hiu==0|aaajjj==0x15)
1484   4                                      {
1485   5                                              delay(5000);
1486   5                                              if(key_fan_hiu==0|aaajjj==0x15)
1487   5                                              {       aaajjj=0;
1488   6                                                      erji=1;
1489   6                                              }
1490   5                                              while(key_fan_hiu==0);
1491   5                                              
1492   5                                      }
1493   4                                      while(shanji==4)    //万年历参数
1494   4                                      {
1495   5                                              sj1302();       //时间年月日时分设置
1496   5                                      }
1497   4                                      while(shanji==5)         //万年历颜色
1498   4                                      {
1499   5                                         shanji=1;
1500   5                                      }
1501   4                              }
1502   3                              while(erji==9)     //    贪吃蛇设置
1503   3                              {
1504   4                                      erji=1;
1505   4                              }
1506   3                      }
1507   2      
1508   2              }
1509   1      
1510   1              yangshi=ysfu;
1511   1              ysh=yangshi;
1512   1              if(yangshi==0)
1513   1              {
1514   2                      for(i=0;i<64;i++)
1515   2                      {
1516   3                              LB[i]=0;
1517   3                              LB1[i]=0;
1518   3                              LB2[i]=0;
1519   3                      }
1520   2                      for(i=0;i<128;i++)
1521   2                      {
1522   3                              ttb1.eal[i]=0;
1523   3                              ttb2.age[i]=0;
1524   3                      }
1525   2              }
1526   1              if(yangshi==1)
1527   1              {
1528   2                      for(p=0;p<64;p++)
1529   2                      {
1530   3                              ttb1.eal[p]=0x0c00;
1531   3                                 
1532   3                      }
1533   2                      ttb1.eal[3]=0x0fff;
1534   2                      ttb1.eal[2]=0x0fff;
1535   2                      ttb1.eal[1]=0x0fff;
1536   2                      ttb1.eal[0]=0x0fff;
1537   2              }
1538   1              if(yangshi==3)
1539   1              {
1540   2                      qing_huan_chong();
1541   2              }
1542   1      
1543   1      }       
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 26  

1544          
1545          
1546          void hua_dian(uchar zbx, uchar zby, uchar hnsj)   //画点中断用
1547          {
1548   1              if(zbx<64&&zby<32)
1549   1              {
1550   2                      if(hnsj==1)
1551   2                      {
1552   3                              LINE=zby*8+zbx/8;
1553   3                              ttb1.sjr[LINE]&=huad[zbx%8];
1554   3                      }
1555   2                      if(hnsj==2)
1556   2                      {
1557   3                              LINE=zby*8+zbx/8;
1558   3                              ttb2.sjg[LINE]&=huad[zbx%8];
1559   3                      }
1560   2                      if(hnsj==3)
1561   2                      {
1562   3                              LINE=zby*8+zbx/8;
1563   3                              ttb1.sjr[LINE]&=huad[zbx%8];
1564   3                              LINE=zby*8+zbx/8;
1565   3                              ttb2.sjg[LINE]&=huad[zbx%8];
1566   3                      }
1567   2              }
1568   1      }
1569          
1570          
1571          
1572          void qing_dian(uchar zbx, uchar zby, uchar hnsj)          //清点中断用
1573          {
1574   1              if(zbx<64&&zby<32)
1575   1              {
1576   2                      if(hnsj==1)
1577   2                      {
1578   3                              LINE=zby*8+zbx/8;
1579   3                              ttb1.sjr[LINE]|=qingd[zbx%8];
1580   3                      }
1581   2                      if(hnsj==2)
1582   2                      {
1583   3                              LINE=zby*8+zbx/8;
1584   3                              ttb2.sjg[LINE]|=qingd[zbx%8];
1585   3                      }
1586   2                      if(hnsj==3)
1587   2                      {
1588   3                              LINE=zby*8+zbx/8;
1589   3                              ttb1.sjr[LINE]|=qingd[zbx%8];
1590   3                              LINE=zby*8+zbx/8;
1591   3                              ttb2.sjg[LINE]|=qingd[zbx%8];
1592   3                      }
1593   2              }
1594   1      }
1595          
1596          
1597          
1598          
1599          void hua_dian1(uchar zbx1, uchar zby1, uchar hnsj1)       //画点主控用
1600          {
1601   1              if(zbx1<64&&zby1<32)
1602   1              {
1603   2                      if(hnsj1==1)
1604   2                      {
1605   3                              COUNT1=zby1*8+zbx1/8;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 27  

1606   3                              ttb1.sjr[COUNT1]&=huad[zbx1%8];
1607   3                      }                                                         
1608   2                      if(hnsj1==2)
1609   2                      {
1610   3                              COUNT1=zby1*8+zbx1/8;
1611   3                              ttb2.sjg[COUNT1]&=huad[zbx1%8];
1612   3                      }
1613   2                      if(hnsj1==3)
1614   2                      {
1615   3                              COUNT1=zby1*8+zbx1/8;
1616   3                              ttb1.sjr[COUNT1]&=huad[zbx1%8];
1617   3                              COUNT1=zby1*8+zbx1/8;
1618   3                              ttb2.sjg[COUNT1]&=huad[zbx1%8];
1619   3                      }
1620   2              }
1621   1      }
1622          
1623          
1624          
1625          void qing_dian1(uchar zbx1, uchar zby1, uchar hnsj1)      //清点主控用
1626          {
1627   1              if(zbx1<64&&zby1<32)
1628   1              {
1629   2                      if(hnsj1==1)
1630   2                      {
1631   3                              COUNT1=zby1*8+zbx1/8;
1632   3                              ttb1.sjr[COUNT1]|=qingd[zbx1%8];
1633   3                      }
1634   2                      if(hnsj1==2)
1635   2                      {
1636   3                              COUNT1=zby1*8+zbx1/8;
1637   3                              ttb2.sjg[COUNT1]|=qingd[zbx1%8];
1638   3                      }
1639   2                      if(hnsj1==3)
1640   2                      {
1641   3                              COUNT1=zby1*8+zbx1/8;
1642   3                              ttb1.sjr[COUNT1]|=qingd[zbx1%8];
1643   3                              COUNT1=zby1*8+zbx1/8;
1644   3                              ttb2.sjg[COUNT1]|=qingd[zbx1%8];
1645   3                      }
1646   2              }
1647   1      }
1648          
1649          
1650          
1651          
1652          void qing_hong()           //清零红色
1653          {
1654   1              for(jj=8;jj<245;jj+=8)
1655   1              {
1656   2                      ttb1.sjr[jj]|=0xfe;
1657   2              }
1658   1              for(jj=15;jj<252;jj+=8)
1659   1              {
1660   2                      ttb1.sjr[jj]|=0x7f;
1661   2              }
1662   1              for(jj=9;jj<247;jj++)
1663   1              {
1664   2                      ttb1.sjr[jj]=0xff;
1665   2                      if(jj%8==6) jj+=2;
1666   2              }
1667   1      
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 28  

1668   1      }
1669          
1670          
1671          
1672          void qing_nv()     //清零绿色
1673          {
1674   1              for(jj=8;jj<245;jj+=8)
1675   1              {
1676   2                      ttb2.sjg[jj]|=0xfe;
1677   2              }
1678   1              for(jj=15;jj<252;jj+=8)
1679   1              {
1680   2                      ttb2.sjg[jj]|=0x7f;
1681   2              }
1682   1              for(jj=9;jj<247;jj++)
1683   1              {
1684   2                      ttb2.sjg[jj]=0xff;
1685   2                      if(jj%8==6) jj+=2;
1686   2              }
1687   1      }
1688          
1689          void biankuang()        //边框
1690          {       
1691   1              kai_shi++;
1692   1              if(kai_shi>7)
1693   1              {
1694   2                      kai_shi=0;
1695   2              }
1696   1      
1697   1              for(G=0;G<64;G++)
1698   1              {       
1699   2                      qing_dian(G,0,3);
1700   2                      hua_dian(G,0,((G+7-kai_shi)/4)%2+1);
1701   2              }
1702   1              for(G=0;G<31;G++)
1703   1              {
1704   2                      qing_dian(63,G,3);
1705   2                      hua_dian(63,G,((G+7-kai_shi)/4)%2+1);
1706   2              }
1707   1              for(G=0;G<64;G++)
1708   1              {       
1709   2                      qing_dian(G,31,3);
1710   2                      hua_dian(G,31,((G+kai_shi+5)/4)%2+1);
1711   2              }
1712   1              for(G=0;G<31;G++)
1713   1              {
1714   2                      qing_dian(0,G,3);
1715   2                      hua_dian(0,G,((G+kai_shi+5)/4)%2+1);
1716   2              }
1717   1      }
1718          
1719          
1720          void hua_88(uchar kzbx, uchar kzby, uchar khnsj, uchar kms, uchar fany)  //画88
1721          {
1722   1              if(khnsj==1)
1723   1              {
1724   2                      if(kzby<8)
1725   2                      {
1726   3                              if(kzbx<8)
1727   3                              {
1728   4                                      for(jj=0;jj<kzby;jj++)
1729   4                                      {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 29  

1730   5                                              ttb1.sjr[jj*8]&=~((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
1731   5                                      }
1732   4                              }
1733   3                              if(kzbx>7&&kzbx<72)
1734   3                              {
1735   4                                      for(jj=0;jj<kzby;jj++)
1736   4                                      {
1737   5                                              ttb1.sjr[jj*8+kzbx/8-1]&=~((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
1738   5                                      }
1739   4                                      if(kzbx<64)
1740   4                                      {
1741   5                                              for(jj=0;jj<kzby;jj++)
1742   5                                              {
1743   6                                                      ttb1.sjr[jj*8+kzbx/8]&=~((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
1744   6                                              }
1745   5                                      }
1746   4                              }
1747   3                      }
1748   2                      if(kzby>7&&kzby<33)
1749   2                      {
1750   3                              if(kzbx<8)
1751   3                              {
1752   4                                      for(jj=0;jj<8;jj++)
1753   4                                      {
1754   5                                              ttb1.sjr[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1755   5                                      }
1756   4                              }
1757   3                              
1758   3                              if(kzbx>7&&kzbx<72)
1759   3                              {       
1760   4                                      for(jj=0;jj<8;jj++)
1761   4                                      {
1762   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1763   5                                      }
1764   4                                      if(kzbx<64)
1765   4                                      {
1766   5                                              for(jj=0;jj<8;jj++)
1767   5                                              {
1768   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1769   6                                              }
1770   5                                      }
1771   4                              }
1772   3                      }
1773   2                      if(kzby>32&&kzby<41)
1774   2                      {
1775   3                              if(kzbx<8)
1776   3                              {
1777   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1778   4                                      {
1779   5                                              ttb1.sjr[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1780   5                                      }
1781   4                              }
1782   3                              
1783   3                              if(kzbx>7&&kzbx<72)
1784   3                              {       
1785   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1786   4                                      {
1787   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1788   5                                      }
1789   4                                      if(kzbx<64)
1790   4                                      {
1791   5                                              for(jj=0;jj<8-(kzby-32);jj++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 30  

1792   5                                              {
1793   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1794   6                                              }
1795   5                                      }
1796   4                              }
1797   3                      }
1798   2              }
1799   1              //&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
1800   1              if(khnsj==2)
1801   1              {
1802   2                      if(kzby<8)
1803   2                      {
1804   3                              if(kzbx<8)
1805   3                              {
1806   4                                      for(jj=0;jj<kzby;jj++)
1807   4                                      {
1808   5                                              ttb2.sjg[jj*8]&=~((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
1809   5                                      }
1810   4                              }
1811   3                              if(kzbx>7&&kzbx<72)
1812   3                              {
1813   4                                      for(jj=0;jj<kzby;jj++)
1814   4                                      {
1815   5                                              ttb2.sjg[jj*8+kzbx/8-1]&=~((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
1816   5                                      }
1817   4                                      if(kzbx<64)
1818   4                                      {
1819   5                                              for(jj=0;jj<kzby;jj++)
1820   5                                              {
1821   6                                                      ttb2.sjg[jj*8+kzbx/8]&=~((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
1822   6                                              }
1823   5                                      }
1824   4                              }
1825   3                      }
1826   2                      if(kzby>7&&kzby<33)
1827   2                      {
1828   3                              if(kzbx<8)
1829   3                              {
1830   4                                      for(jj=0;jj<8;jj++)
1831   4                                      {
1832   5                                              ttb2.sjg[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1833   5                                      }
1834   4                              }
1835   3                              
1836   3                              if(kzbx>7&&kzbx<72)
1837   3                              {       
1838   4                                      for(jj=0;jj<8;jj++)
1839   4                                      {
1840   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1841   5                                      }
1842   4                                      if(kzbx<64)
1843   4                                      {
1844   5                                              for(jj=0;jj<8;jj++)
1845   5                                              {
1846   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1847   6                                              }
1848   5                                      }
1849   4                              }
1850   3                      }
1851   2                      if(kzby>32&&kzby<41)
1852   2                      {
1853   3                              if(kzbx<8)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 31  

1854   3                              {
1855   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1856   4                                      {
1857   5                                              ttb2.sjg[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1858   5                                      }
1859   4                              }
1860   3                              
1861   3                              if(kzbx>7&&kzbx<72)
1862   3                              {       
1863   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1864   4                                      {
1865   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1866   5                                      }
1867   4                                      if(kzbx<64)
1868   4                                      {
1869   5                                              for(jj=0;jj<8-(kzby-32);jj++)
1870   5                                              {
1871   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1872   6                                              }
1873   5                                      }
1874   4                              }
1875   3                      }
1876   2              }
1877   1              //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
1878   1              if(khnsj==3)
1879   1              {
1880   2                      if(kzby<8)
1881   2                      {
1882   3                              if(kzbx<8)
1883   3                              {
1884   4                                      for(jj=0;jj<kzby;jj++)
1885   4                                      {
1886   5                                              ttb1.sjr[jj*8]&=~((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
1887   5                                      }
1888   4                              }
1889   3                              if(kzbx>7&&kzbx<72)
1890   3                              {
1891   4                                      for(jj=0;jj<kzby;jj++)
1892   4                                      {
1893   5                                              ttb1.sjr[jj*8+kzbx/8-1]&=~((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
1894   5                                      }
1895   4                                      if(kzbx<64)
1896   4                                      {
1897   5                                              for(jj=0;jj<kzby;jj++)
1898   5                                              {
1899   6                                                      ttb1.sjr[jj*8+kzbx/8]&=~((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
1900   6                                              }
1901   5                                      }
1902   4                              }
1903   3                      }
1904   2                      if(kzby>7&&kzby<33)
1905   2                      {
1906   3                              if(kzbx<8)
1907   3                              {
1908   4                                      for(jj=0;jj<8;jj++)
1909   4                                      {
1910   5                                              ttb1.sjr[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1911   5                                      }
1912   4                              }
1913   3                              
1914   3                              if(kzbx>7&&kzbx<72)
1915   3                              {       
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 32  

1916   4                                      for(jj=0;jj<8;jj++)
1917   4                                      {
1918   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1919   5                                      }
1920   4                                      if(kzbx<64)
1921   4                                      {
1922   5                                              for(jj=0;jj<8;jj++)
1923   5                                              {
1924   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1925   6                                              }
1926   5                                      }
1927   4                              }
1928   3                      }
1929   2                      if(kzby>32&&kzby<41)
1930   2                      {
1931   3                              if(kzbx<8)
1932   3                              {
1933   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1934   4                                      {
1935   5                                              ttb1.sjr[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1936   5                                      }
1937   4                              }
1938   3                              
1939   3                              if(kzbx>7&&kzbx<72)
1940   3                              {       
1941   4                                      for(jj=0;jj<8-(kzby-32);jj++)
1942   4                                      {
1943   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1944   5                                      }
1945   4                                      if(kzbx<64)
1946   4                                      {
1947   5                                              for(jj=0;jj<8-(kzby-32);jj++)
1948   5                                              {
1949   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
1950   6                                              }
1951   5                                      }
1952   4                              }
1953   3                      }
1954   2                      //@@@@@@@@@@@@@@@@@@@
1955   2                      if(kzby<8)
1956   2                      {
1957   3                              if(kzbx<8)
1958   3                              {
1959   4                                      for(jj=0;jj<kzby;jj++)
1960   4                                      {
1961   5                                              ttb2.sjg[jj*8]&=~((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
1962   5                                      }
1963   4                              }
1964   3                              if(kzbx>7&&kzbx<72)
1965   3                              {
1966   4                                      for(jj=0;jj<kzby;jj++)
1967   4                                      {
1968   5                                              ttb2.sjg[jj*8+kzbx/8-1]&=~((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
1969   5                                      }
1970   4                                      if(kzbx<64)
1971   4                                      {
1972   5                                              for(jj=0;jj<kzby;jj++)
1973   5                                              {
1974   6                                                      ttb2.sjg[jj*8+kzbx/8]&=~((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
1975   6                                              }
1976   5                                      }
1977   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 33  

1978   3                      }
1979   2                      if(kzby>7&&kzby<33)
1980   2                      {
1981   3                              if(kzbx<8)
1982   3                              {
1983   4                                      for(jj=0;jj<8;jj++)
1984   4                                      {
1985   5                                              ttb2.sjg[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
1986   5                                      }
1987   4                              }
1988   3                              
1989   3                              if(kzbx>7&&kzbx<72)
1990   3                              {       
1991   4                                      for(jj=0;jj<8;jj++)
1992   4                                      {
1993   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
1994   5                                      }
1995   4                                      if(kzbx<64)
1996   4                                      {
1997   5                                              for(jj=0;jj<8;jj++)
1998   5                                              {
1999   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2000   6                                              }
2001   5                                      }
2002   4                              }
2003   3                      }
2004   2                      if(kzby>32&&kzby<41)
2005   2                      {
2006   3                              if(kzbx<8)
2007   3                              {
2008   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2009   4                                      {
2010   5                                              ttb2.sjg[(kzby-8)*8+jj*8]&=~((~LB[kms*8+jj+fany])>>((8-kzbx)));
2011   5                                      }
2012   4                              }
2013   3                              
2014   3                              if(kzbx>7&&kzbx<72)
2015   3                              {       
2016   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2017   4                                      {
2018   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]&=~((~LB[kms*8+jj+fany])<<((kzbx%8)));
2019   5                                      }
2020   4                                      if(kzbx<64)
2021   4                                      {
2022   5                                              for(jj=0;jj<8-(kzby-32);jj++)
2023   5                                              {
2024   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]&=~((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2025   6                                              }
2026   5                                      }
2027   4                              }
2028   3                      }
2029   2              }               
2030   1      }
2031          
2032          
2033          void hua_816(uchar kzbx1, uchar kzby1, uchar khnsj1, uchar kms1, uchar fany1)  //画816
2034          {                                                                                                
2035   1               hua_88(kzbx1,kzby1-8,khnsj1,kms1,fany1);
2036   1               hua_88(kzbx1,kzby1,khnsj1,kms1+1,fany1);
2037   1      }
2038          
2039          
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 34  

2040          void hua_1616(uchar kzbx2, uchar kzby2, uchar khnsj2, uchar kms2, uchar fany2)  //画1616
2041          {
2042   1                      hua_88(kzbx2-8,kzby2-8,khnsj2,kms2,fany2);
2043   1                      hua_88(kzbx2-8,kzby2,khnsj2,kms2+1,fany2);
2044   1                      hua_88(kzbx2,kzby2-8,khnsj2,kms2+2,fany2);
2045   1                      hua_88(kzbx2,kzby2,khnsj2,kms2+3,fany2);        
2046   1      }
2047          
2048          
2049          void qu_88(uchar kzbx, uchar kzby, uchar khnsj, uchar kms, uchar fany)                  //取88
2050          {
2051   1              if(khnsj==1)
2052   1              {
2053   2                      if(kzby<8)
2054   2                      {
2055   3                              if(kzbx<8)
2056   3                              {
2057   4                                      for(jj=0;jj<kzby;jj++)
2058   4                                      {
2059   5                                              ttb1.sjr[jj*8]|=((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
2060   5                                      }
2061   4                              }
2062   3                              if(kzbx>7&&kzbx<72)
2063   3                              {
2064   4                                      for(jj=0;jj<kzby;jj++)
2065   4                                      {
2066   5                                              ttb1.sjr[jj*8+kzbx/8-1]|=((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
2067   5                                      }
2068   4                                      if(kzbx<64)
2069   4                                      {
2070   5                                              for(jj=0;jj<kzby;jj++)
2071   5                                              {
2072   6                                                      ttb1.sjr[jj*8+kzbx/8]|=((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
2073   6                                              }
2074   5                                      }
2075   4                              }
2076   3                      }
2077   2                      if(kzby>7&&kzby<33)
2078   2                      {
2079   3                              if(kzbx<8)
2080   3                              {
2081   4                                      for(jj=0;jj<8;jj++)
2082   4                                      {
2083   5                                              ttb1.sjr[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2084   5                                      }
2085   4                              }
2086   3                              
2087   3                              if(kzbx>7&&kzbx<72)
2088   3                              {       
2089   4                                      for(jj=0;jj<8;jj++)
2090   4                                      {
2091   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2092   5                                      }
2093   4                                      if(kzbx<64)
2094   4                                      {
2095   5                                              for(jj=0;jj<8;jj++)
2096   5                                              {
2097   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2098   6                                              }
2099   5                                      }
2100   4                              }
2101   3                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 35  

2102   2                      if(kzby>32&&kzby<41)
2103   2                      {
2104   3                              if(kzbx<8)
2105   3                              {
2106   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2107   4                                      {
2108   5                                              ttb1.sjr[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2109   5                                      }
2110   4                              }
2111   3                              
2112   3                              if(kzbx>7&&kzbx<72)
2113   3                              {       
2114   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2115   4                                      {
2116   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2117   5                                      }
2118   4                                      if(kzbx<64)
2119   4                                      {
2120   5                                              for(jj=0;jj<8-(kzby-32);jj++)
2121   5                                              {
2122   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2123   6                                              }
2124   5                                      }
2125   4                              }
2126   3                      }
2127   2              }
2128   1              //&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
2129   1              if(khnsj==2)
2130   1              {
2131   2                      if(kzby<8)
2132   2                      {
2133   3                              if(kzbx<8)
2134   3                              {
2135   4                                      for(jj=0;jj<kzby;jj++)
2136   4                                      {
2137   5                                              ttb2.sjg[jj*8]|=((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
2138   5                                      }
2139   4                              }
2140   3                              if(kzbx>7&&kzbx<72)
2141   3                              {
2142   4                                      for(jj=0;jj<kzby;jj++)
2143   4                                      {
2144   5                                              ttb2.sjg[jj*8+kzbx/8-1]|=((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
2145   5                                      }
2146   4                                      if(kzbx<64)
2147   4                                      {
2148   5                                              for(jj=0;jj<kzby;jj++)
2149   5                                              {
2150   6                                                      ttb2.sjg[jj*8+kzbx/8]|=((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
2151   6                                              }
2152   5                                      }
2153   4                              }
2154   3                      }
2155   2                      if(kzby>7&&kzby<33)
2156   2                      {
2157   3                              if(kzbx<8)
2158   3                              {
2159   4                                      for(jj=0;jj<8;jj++)
2160   4                                      {
2161   5                                              ttb2.sjg[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2162   5                                      }
2163   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 36  

2164   3                              
2165   3                              if(kzbx>7&&kzbx<72)
2166   3                              {       
2167   4                                      for(jj=0;jj<8;jj++)
2168   4                                      {
2169   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2170   5                                      }
2171   4                                      if(kzbx<64)
2172   4                                      {
2173   5                                              for(jj=0;jj<8;jj++)
2174   5                                              {
2175   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2176   6                                              }
2177   5                                      }
2178   4                              }
2179   3                      }
2180   2                      if(kzby>32&&kzby<41)
2181   2                      {
2182   3                              if(kzbx<8)
2183   3                              {
2184   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2185   4                                      {
2186   5                                              ttb2.sjg[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2187   5                                      }
2188   4                              }
2189   3                              
2190   3                              if(kzbx>7&&kzbx<72)
2191   3                              {       
2192   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2193   4                                      {
2194   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2195   5                                      }
2196   4                                      if(kzbx<64)
2197   4                                      {
2198   5                                              for(jj=0;jj<8-(kzby-32);jj++)
2199   5                                              {
2200   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2201   6                                              }
2202   5                                      }
2203   4                              }
2204   3                      }
2205   2              }
2206   1              //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2207   1              if(khnsj==3)
2208   1              {
2209   2                      if(kzby<8)
2210   2                      {
2211   3                              if(kzbx<8)
2212   3                              {
2213   4                                      for(jj=0;jj<kzby;jj++)
2214   4                                      {
2215   5                                              ttb1.sjr[jj*8]|=((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
2216   5                                      }
2217   4                              }
2218   3                              if(kzbx>7&&kzbx<72)
2219   3                              {
2220   4                                      for(jj=0;jj<kzby;jj++)
2221   4                                      {
2222   5                                              ttb1.sjr[jj*8+kzbx/8-1]|=((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
2223   5                                      }
2224   4                                      if(kzbx<64)
2225   4                                      {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 37  

2226   5                                              for(jj=0;jj<kzby;jj++)
2227   5                                              {
2228   6                                                      ttb1.sjr[jj*8+kzbx/8]|=((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
2229   6                                              }
2230   5                                      }
2231   4                              }
2232   3                      }
2233   2                      if(kzby>7&&kzby<33)
2234   2                      {
2235   3                              if(kzbx<8)
2236   3                              {
2237   4                                      for(jj=0;jj<8;jj++)
2238   4                                      {
2239   5                                              ttb1.sjr[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2240   5                                      }
2241   4                              }
2242   3                              
2243   3                              if(kzbx>7&&kzbx<72)
2244   3                              {       
2245   4                                      for(jj=0;jj<8;jj++)
2246   4                                      {
2247   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2248   5                                      }
2249   4                                      if(kzbx<64)
2250   4                                      {
2251   5                                              for(jj=0;jj<8;jj++)
2252   5                                              {
2253   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2254   6                                              }
2255   5                                      }
2256   4                              }
2257   3                      }
2258   2                      if(kzby>32&&kzby<41)
2259   2                      {
2260   3                              if(kzbx<8)
2261   3                              {
2262   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2263   4                                      {
2264   5                                              ttb1.sjr[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2265   5                                      }
2266   4                              }
2267   3                              
2268   3                              if(kzbx>7&&kzbx<72)
2269   3                              {       
2270   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2271   4                                      {
2272   5                                              ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2273   5                                      }
2274   4                                      if(kzbx<64)
2275   4                                      {
2276   5                                              for(jj=0;jj<8-(kzby-32);jj++)
2277   5                                              {
2278   6                                                      ttb1.sjr[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2279   6                                              }
2280   5                                      }
2281   4                              }
2282   3                      }
2283   2                      //@@@@@@@@@@@@@@@@@@@
2284   2                      if(kzby<8)
2285   2                      {
2286   3                              if(kzbx<8)
2287   3                              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 38  

2288   4                                      for(jj=0;jj<kzby;jj++)
2289   4                                      {
2290   5                                              ttb2.sjg[jj*8]|=((~LB[8+kms*8+jj+fany-kzby])>>(8-kzbx));
2291   5                                      }
2292   4                              }
2293   3                              if(kzbx>7&&kzbx<72)
2294   3                              {
2295   4                                      for(jj=0;jj<kzby;jj++)
2296   4                                      {
2297   5                                              ttb2.sjg[jj*8+kzbx/8-1]|=((~LB[8+kms*8+jj+fany-kzby])<<((kzbx%8)));
2298   5                                      }
2299   4                                      if(kzbx<64)
2300   4                                      {
2301   5                                              for(jj=0;jj<kzby;jj++)
2302   5                                              {
2303   6                                                      ttb2.sjg[jj*8+kzbx/8]|=((~LB[8+kms*8+jj+fany-kzby])>>((8-kzbx%8)));
2304   6                                              }
2305   5                                      }
2306   4                              }
2307   3                      }
2308   2                      if(kzby>7&&kzby<33)
2309   2                      {
2310   3                              if(kzbx<8)
2311   3                              {
2312   4                                      for(jj=0;jj<8;jj++)
2313   4                                      {
2314   5                                              ttb2.sjg[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2315   5                                      }
2316   4                              }
2317   3                              
2318   3                              if(kzbx>7&&kzbx<72)
2319   3                              {       
2320   4                                      for(jj=0;jj<8;jj++)
2321   4                                      {
2322   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2323   5                                      }
2324   4                                      if(kzbx<64)
2325   4                                      {
2326   5                                              for(jj=0;jj<8;jj++)
2327   5                                              {
2328   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2329   6                                              }
2330   5                                      }
2331   4                              }
2332   3                      }
2333   2                      if(kzby>32&&kzby<41)
2334   2                      {
2335   3                              if(kzbx<8)
2336   3                              {
2337   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2338   4                                      {
2339   5                                              ttb2.sjg[(kzby-8)*8+jj*8]|=((~LB[kms*8+jj+fany])>>((8-kzbx)));
2340   5                                      }
2341   4                              }
2342   3                              
2343   3                              if(kzbx>7&&kzbx<72)
2344   3                              {       
2345   4                                      for(jj=0;jj<8-(kzby-32);jj++)
2346   4                                      {
2347   5                                              ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8]|=((~LB[kms*8+jj+fany])<<((kzbx%8)));
2348   5                                      }
2349   4                                      if(kzbx<64)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 39  

2350   4                                      {
2351   5                                              for(jj=0;jj<8-(kzby-32);jj++)
2352   5                                              {
2353   6                                                      ttb2.sjg[(kzby-8)*8+jj*8+(kzbx-8)/8+1]|=((~LB[kms*8+jj+fany])>>((8-kzbx%8)));
2354   6                                              }
2355   5                                      }
2356   4                              }
2357   3                      }
2358   2              }
2359   1      }
2360          
2361          
2362          void qu_816(uchar kzbx1, uchar kzby1, uchar khnsj1, uchar kms1, uchar fany1)     //取816
2363          {                                                                                                
2364   1               qu_88(kzbx1,kzby1-8,khnsj1,kms1,fany1);
2365   1               qu_88(kzbx1,kzby1,khnsj1,kms1+1,fany1);
2366   1      }
2367          
2368          
2369          void qu_1616(uchar kzbx2, uchar kzby2, uchar khnsj2, uchar kms2, uchar fany2)    //取1616
2370          {
2371   1                      qu_88(kzbx2-8,kzby2-8,khnsj2,kms2,fany2);
2372   1                      qu_88(kzbx2-8,kzby2,khnsj2,kms2+1,fany2);
2373   1                      qu_88(kzbx2,kzby2-8,khnsj2,kms2+2,fany2);
2374   1                      qu_88(kzbx2,kzby2,khnsj2,kms2+3,fany2); 
2375   1      }
2376          
2377          
2378          
2379          
2380          void kai_ji()  //开机画面
2381          {
2382   1              uchar x1=27,x2=35,x3=65,x4=53,y1=39,y2=1,y3=39,y4=1,fo;
2383   1              for(jj=0;jj<64;jj++)
2384   1              {
2385   2                      LB[jj]=k1616[jj];
2386   2              }
2387   1              for(fo=0;fo<8;fo++)
2388   1              {
2389   2                      qing_hong();
2390   2                      hua_88(x2,y2,1,1,0);
2391   2                      hua_88(x4,y4,1,3,0);
2392   2                      delay(10000);
2393   2                      x2--;y2++;      
2394   2                      x4++;y4++;
2395   2              }
2396   1              for(fo=0;fo<8;fo++)
2397   1              {       
2398   2                      hua_88(x1,y1,1,0,0);
2399   2                      hua_88(x2,y2,1,1,0);
2400   2                      hua_88(x3,y3,1,2,0);    
2401   2                      hua_88(x4,y4,1,3,0);
2402   2                      x1--;y1--;
2403   2                      x2--;y2++;
2404   2                      x3--;y3--;
2405   2                      if(fo>1) x4--; else x4++;
2406   2                      y4++;
2407   2                      delay(10000);
2408   2                      qing_hong();
2409   2              }
2410   1              for(fo=0;fo<25;fo++)
2411   1              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 40  

2412   2                      if(fo<10) x1--; else x1++;
2413   2                      if(fo<22) y1--; else y1++;
2414   2                      if(fo<10) x2--; else x2++;
2415   2                      if(fo<14) y2++; else y2--;
2416   2                      x3--;
2417   2                      if(fo<22) y3--; else y3++;
2418   2                      x4--;
2419   2                      if(fo<14) y4++; else y4--;      
2420   2                      qing_hong();
2421   2                      hua_88(x1,y1,1,0,0);
2422   2                      hua_88(x2,y2,1,1,0);
2423   2                      hua_88(x3,y3,1,2,0);
2424   2                      hua_88(x4,y4,1,3,0);
2425   2                      delay(10000);
2426   2              }
2427   1              x1=0;y1=12;
2428   1              for(fo=0;fo<8;fo++)
2429   1              {
2430   2                      qu_88(x1+1,y1,2,4,0);
2431   2                      hua_88(x1,y1,2,4,0);
2432   2                      x1++;
2433   2                      delay(4000);
2434   2              }
2435   1               x2=72;y2=20;
2436   1              for(fo=0;fo<33;fo++)
2437   1              {
2438   2                      qing_nv();
2439   2                      qu_88(x1+1,y1,2,4,0);
2440   2                      hua_88(x1,y1,2,4,0);
2441   2                      hua_88(x2,y2,2,5,0);
2442   2                      x1++; x2--;
2443   2                      delay(4000);
2444   2              }
2445   1              x1=72;y1=20;
2446   1              for(fo=0;fo<25;fo++)
2447   1              {
2448   2                      qu_816(x1+1,y1,2,6,0);
2449   2                      hua_816(x1,y1,2,6,0);
2450   2                      x1--;              
2451   2                      delay(4000);
2452   2              }
2453   1              for(fo=0;fo<48;fo++)
2454   1              {       
2455   2                      hua_dian1(fo+8,24,1);
2456   2                      hua_dian1(55-fo,27,1);
2457   2                      delay(1000);
2458   2              }
2459   1              hua_dian1(8,26,1);
2460   1              delay(2000);
2461   1              hua_dian1(55,25,1);
2462   1              hua_dian1(8,25,1);
2463   1              delay(2000);
2464   1              hua_dian1(55,26,1);
2465   1              for(fo=0;fo<46;fo++)
2466   1              {       
2467   2                      hua_dian1(fo+9,25,2);
2468   2                      hua_dian1(fo+9,26,2);
2469   2                      delay(10000);
2470   2                      if(fo==11) delay(60000);
2471   2                      if(fo==24) {delay(60000);delay(60000);} 
2472   2              }
2473   1              x1=0;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 41  

2474   1              for(fo=4;fo<20;fo++)
2475   1              {
2476   2                              fenhang(fo,0);
2477   2                              delay(10000);
2478   2                              hangyi(fo-1,1);
2479   2                              fenhang(fo,2);
2480   2                              delay(10000);
2481   2                              hangyi(fo,1);
2482   2              }
2483   1              for(fo=0;fo<25;fo++)
2484   1              {
2485   2                      hangyi(21,1);
2486   2                      delay(10000);
2487   2                      qing_dian1(fo+8,24,3);
2488   2                      qing_dian1(fo+8,25,3);
2489   2                      qing_dian1(fo+8,26,3);
2490   2                      qing_dian1(fo+8,27,3);
2491   2      
2492   2                      qing_dian1(fo+18,24,3);
2493   2                      qing_dian1(fo+18,25,3);
2494   2                      qing_dian1(fo+18,26,3);
2495   2                      qing_dian1(fo+18,27,3);
2496   2      
2497   2                      qing_dian1(fo+28,24,3);
2498   2                      qing_dian1(fo+28,25,3);
2499   2                      qing_dian1(fo+28,26,3);
2500   2                      qing_dian1(fo+28,27,3);
2501   2      
2502   2                      qing_dian1(fo+38,24,3);
2503   2                      qing_dian1(fo+38,25,3);
2504   2                      qing_dian1(fo+38,26,3);
2505   2                      qing_dian1(fo+38,27,3);
2506   2      
2507   2                      qing_dian1(fo+48,24,3);
2508   2                      qing_dian1(fo+48,25,3);
2509   2                      qing_dian1(fo+48,26,3);
2510   2                      qing_dian1(fo+48,27,3);
2511   2              }
2512   1      }
2513          
2514          
2515          void hangyi(uchar hsy,uchar kks)     //行上移
2516          {
2517   1              uchar hsy1,hsy2;
2518   1              for(hsy1=0;hsy1<8;hsy1++)
2519   1              {
2520   2                      if(hsy1==0)
2521   2                      {
2522   3                              ttb1.sjr[kks*8+hsy1]|=0xfe;
2523   3                              ttb2.sjg[kks*8+hsy1]|=0xfe;
2524   3                      }
2525   2                      if(hsy1>0&&hsy1<7)
2526   2                      {
2527   3                              ttb1.sjr[kks*8+hsy1]=0xff;
2528   3                              ttb2.sjg[kks*8+hsy1]=0xff;
2529   3                      }
2530   2                      if(hsy1==7)
2531   2                      {
2532   3                              ttb1.sjr[kks*8+hsy1]|=0x7f;
2533   3                              ttb2.sjg[kks*8+hsy1]|=0x7f;
2534   3                      }
2535   2              }       
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 42  

2536   1              for(hsy1=kks;hsy1<hsy;hsy1++)
2537   1              {
2538   2                      for(hsy2=0;hsy2<8;hsy2++)
2539   2                      {
2540   3                              if(hsy2==0)
2541   3                              {
2542   4                                      ttb1.sjr[hsy1*8+hsy2]=(ttb1.sjr[hsy1*8+8+hsy2]|0x01)&(ttb1.sjr[hsy1*8+hsy2]|0xfe);
2543   4                                      ttb2.sjg[hsy1*8+hsy2]=(ttb2.sjg[hsy1*8+8+hsy2]|0x01)&(ttb2.sjg[hsy1*8+hsy2]|0xfe);
2544   4                              }
2545   3                              if(hsy2>0&&hsy2<7)
2546   3                              {
2547   4                              ttb1.sjr[hsy1*8+hsy2]=ttb1.sjr[hsy1*8+8+hsy2];
2548   4                              ttb2.sjg[hsy1*8+hsy2]=ttb2.sjg[hsy1*8+8+hsy2];
2549   4                              }
2550   3                              if(hsy2==7)
2551   3                              {
2552   4                                      ttb1.sjr[hsy1*8+hsy2]=(ttb1.sjr[hsy1*8+8+hsy2]|0x80)&(ttb1.sjr[hsy1*8+hsy2]|0x7f);
2553   4                                      ttb2.sjg[hsy1*8+hsy2]=(ttb2.sjg[hsy1*8+8+hsy2]|0x80)&(ttb2.sjg[hsy1*8+hsy2]|0x7f);
2554   4                              }
2555   3                      }
2556   2              }       
2557   1      }
2558          
2559          
2560          void fenhang(uchar fenh, uchar fenhs)    //分行
2561          {                       
2562   1              uchar hsy1;                                                
2563   1              for(hsy1=0;hsy1<8;hsy1++)                  
2564   1              {
2565   2                      if(hsy1==0)
2566   2                      {
2567   3                              ttb1.sjr[fenh*8+hsy1-8]&=(ttb1.sjr[fenh*8+hsy1]|fhsz[fenhs])|0x01;
2568   3                              ttb2.sjg[fenh*8+hsy1-8]&=(ttb2.sjg[fenh*8+hsy1]|fhsz[fenhs])|0x01;
2569   3                              ttb1.sjr[fenh*8+hsy1]|=(~fhsz[fenhs])&0xfe;
2570   3                              ttb2.sjg[fenh*8+hsy1]|=(~fhsz[fenhs])&0xfe;
2571   3                      }
2572   2                      if(hsy1>0&&hsy1<7)
2573   2                      {
2574   3                              ttb1.sjr[fenh*8+hsy1-8]=ttb1.sjr[fenh*8+hsy1]|fhsz[fenhs];
2575   3                              ttb2.sjg[fenh*8+hsy1-8]=ttb2.sjg[fenh*8+hsy1]|fhsz[fenhs];
2576   3                              ttb1.sjr[fenh*8+hsy1]|=~fhsz[fenhs];
2577   3                              ttb2.sjg[fenh*8+hsy1]|=~fhsz[fenhs];
2578   3                      }
2579   2                      if(hsy1==7)
2580   2                      {
2581   3                              ttb1.sjr[fenh*8+hsy1-8]&=(ttb1.sjr[fenh*8+hsy1]|fhsz[fenhs])|0x80;
2582   3                              ttb2.sjg[fenh*8+hsy1-8]&=(ttb2.sjg[fenh*8+hsy1]|fhsz[fenhs])|0x80;
2583   3                              ttb1.sjr[fenh*8+hsy1]|=(~fhsz[fenhs])&0x7f;
2584   3                              ttb2.sjg[fenh*8+hsy1]|=(~fhsz[fenhs])&0x7f;
2585   3                      }
2586   2              }
2587   1      }
2588          
2589          void wanln()    //万年历显示
2590          {
2591   1              uchar bbf,yys;
2592   1              qing_hong();
2593   1              qing_nv();
2594   1              delay(65530);
2595   1              delay(65530);
2596   1              delay(65530);
2597   1              for(jj=0;jj<64;jj++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 43  

2598   1              {
2599   2                      LB[jj]=k816[jj];
2600   2                      LB1[jj]=k816[jj+64];
2601   2                      LB2[jj]=k816[jj+128];
2602   2              }
2603   1              shi1=wshi/16;
2604   1              shi2=wshi%16;
2605   1              fen1=wfen/16;
2606   1              fen2=wfen%16;
2607   1              hua_816(34,15,2,fen2*2,0);
2608   1              hua_816(27,15,1,fen1*2,0);
2609   1              hua_816(16,15,2,shi2*2,0);
2610   1              hua_816(9,15,3,shi1*2,0);
2611   1      
2612   1              hua_dian1(52,11,1);
2613   1              hua_dian1(53,11,1);
2614   1              hua_dian1(52,12,1);
2615   1              hua_dian1(53,12,1);
2616   1              xyz=1;
2617   1              while(yangshi==3&&ysh==3)
2618   1              {
2619   2                      shiwen();
2620   2                      bbf++;
2621   2                      if(bbf>3) bbf=1;
2622   2                      yys++;
2623   2                      if(yys>6) yys=1;
2624   2                      xian_xiao(1,bbf,yys);
2625   2                      delay(65530);
2626   2                      delay(65530);
2627   2                      delay(65530);
2628   2                      delay(65530);
2629   2                      kaij++;
2630   2                      if(kaij>8) {kaij=1; yys++;};
2631   2                      xian_xiao(2,1,kaij);    
2632   2              }
2633   1              if(ysh!=yangshi)
2634   1              {
2635   2                 yangshi=ysh;
2636   2                 qing_huan_chong();
2637   2              }
2638   1      }
2639          
2640          
2641          void xian_xiao(uchar xiaox,uchar bufen,uchar yangss)    //万年历动画显示和消失
2642          {
2643   1              if(xiaox==1)   
2644   1              {
2645   2                      if(bufen==1)     
2646   2                      {
2647   3                              if(yangss==1)    
2648   3                              {
2649   4                                      for(jj=0;jj<64;jj++)
2650   4                                      {
2651   5                                              LB[jj]=k816[jj];
2652   5                                              LB1[jj]=k816[jj+64];
2653   5                                              LB2[jj]=k816[jj+128];
2654   5                                      }
2655   4                                      hua_816(16,29,3,4,0);
2656   4                                      delay(30000);
2657   4                                      hua_816(24,29,2,0,0);
2658   4                                      delay(30000);
2659   4                                      hua_816(32,29,1,nian1*2,0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 44  

2660   4                                      delay(30000);
2661   4                                      hua_816(40,29,2,nian2*2,0);
2662   4                                      delay(30000);
2663   4                                      for(jj=0;jj<64;jj++)
2664   4                                      {
2665   5                                              LB[jj]=k1616[jj];
2666   5                                              LB1[jj]=k1616[jj+64];
2667   5                                              LB2[jj]=k1616[jj+128];
2668   5                                      }
2669   4                                      hua_1616(56,29,3,8,0);
2670   4                              }
2671   3                              if(yangss==2)
2672   3                              {
2673   4                                      for(jj=0;jj<64;jj++)
2674   4                                      {
2675   5                                              LB[jj]=k1616[jj];
2676   5                                              LB1[jj]=k1616[jj+64];
2677   5                                              LB2[jj]=k1616[jj+128];
2678   5                                      }
2679   4                                      hua_1616(56,29,3,8,0);
2680   4                                      delay(30000);
2681   4                                      for(jj=0;jj<64;jj++)
2682   4                                      {
2683   5                                              LB[jj]=k816[jj];
2684   5                                              LB1[jj]=k816[jj+64];
2685   5                                              LB2[jj]=k816[jj+128];
2686   5                                      }
2687   4                                      hua_816(40,29,2,nian2*2,0);
2688   4                                      delay(30000);
2689   4                                      hua_816(32,29,1,nian1*2,0);
2690   4                                      delay(30000);
2691   4                                      hua_816(24,29,2,0,0);
2692   4                                      delay(30000);
2693   4                                      hua_816(16,29,3,4,0);
2694   4                              }
2695   3                              if(yangss==3)
2696   3                              {
2697   4                                       for(jj=0;jj<64;jj++)
2698   4                                      {
2699   5                                              LB[jj]=k816[jj];
2700   5                                              LB1[jj]=k816[jj+64];
2701   5                                              LB2[jj]=k816[jj+128];
2702   5                                      }
2703   4                                      for(foo=48;foo!=29;foo--)
2704   4                                      {
2705   5                                              qu_816(16,foo+1,3,4,0);
2706   5                                              hua_816(16,foo,3,4,0);
2707   5                                              delay(3000);    
2708   5                                      }
2709   4                                      for(foo=48;foo!=29;foo--)
2710   4                                      {
2711   5                                              qu_816(24,foo+1,2,0,0);                                 
2712   5                                              hua_816(24,foo,2,0,0);
2713   5                                              delay(3000);
2714   5                                      }
2715   4                                      for(foo=48;foo!=29;foo--)
2716   4                                      {
2717   5                                              qu_816(32,foo+1,1,nian1*2,0);                                   
2718   5                                              hua_816(32,foo,1,nian1*2,0);
2719   5                                              delay(3000);
2720   5                                      }
2721   4                                      for(foo=48;foo!=29;foo--)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 45  

2722   4                                      {
2723   5                                              qu_816(40,foo+1,2,nian2*2,0);                                   
2724   5                                              hua_816(40,foo,2,nian2*2,0);
2725   5                                              delay(3000);
2726   5                                      }
2727   4                                      for(jj=0;jj<64;jj++)
2728   4                                      {
2729   5                                              LB[jj]=k1616[jj];
2730   5                                              LB1[jj]=k1616[jj+64];
2731   5                                              LB2[jj]=k1616[jj+128];
2732   5                                      }
2733   4                                      for(foo=48;foo!=29;foo--)
2734   4                                      {
2735   5                                              qu_1616(56,foo+1,3,8,0);                                        
2736   5                                              hua_1616(56,foo,3,8,0);
2737   5                                              delay(3000);
2738   5                                      }
2739   4                              }
2740   3                              if(yangss==4)
2741   3                              {
2742   4                                      for(jj=0;jj<64;jj++)
2743   4                                      {
2744   5                                              LB[jj]=k1616[jj];
2745   5                                              LB1[jj]=k1616[jj+64];
2746   5                                              LB2[jj]=k1616[jj+128];
2747   5                                      }
2748   4                                      for(foo=48;foo!=29;foo--)
2749   4                                      {
2750   5                                              qu_1616(56,foo+1,3,8,0);                                        
2751   5                                              hua_1616(56,foo,3,8,0);
2752   5                                              delay(3000);
2753   5                                      }
2754   4                                      for(jj=0;jj<64;jj++)
2755   4                                      {
2756   5                                              LB[jj]=k816[jj];
2757   5                                              LB1[jj]=k816[jj+64];
2758   5                                              LB2[jj]=k816[jj+128];
2759   5                                      }
2760   4                                      for(foo=48;foo!=29;foo--)
2761   4                                      {
2762   5                                              qu_816(40,foo+1,2,nian2*2,0);                                   
2763   5                                              hua_816(40,foo,2,nian2*2,0);
2764   5                                              delay(3000);
2765   5                                      }
2766   4                                      
2767   4                                      for(foo=48;foo!=29;foo--)
2768   4                                      {
2769   5                                              qu_816(32,foo+1,1,nian1*2,0);                                   
2770   5                                              hua_816(32,foo,1,nian1*2,0);
2771   5                                              delay(3000);
2772   5                                      }
2773   4                                      for(foo=48;foo!=29;foo--)
2774   4                                      {
2775   5                                              qu_816(24,foo+1,2,0,0);                                 
2776   5                                              hua_816(24,foo,2,0,0);
2777   5                                              delay(3000);
2778   5                                      }
2779   4                                      for(foo=48;foo!=29;foo--)
2780   4                                      {
2781   5                                              qu_816(16,foo+1,3,4,0);
2782   5                                              hua_816(16,foo,3,4,0);
2783   5                                              delay(3000);    
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 46  

2784   5                                      }
2785   4                              }
2786   3                              if(yangss==5)
2787   3                              {
2788   4                                       for(jj=0;jj<64;jj++)
2789   4                                      {
2790   5                                              LB[jj]=k816[jj];
2791   5                                              LB1[jj]=k816[jj+64];
2792   5                                              LB2[jj]=k816[jj+128];
2793   5                                      }                                                               
2794   4                                      hua_816(32,29,1,nian1*2,0);                             
2795   4                                      hua_816(40,29,2,nian2*2,0);
2796   4                                      delay(60000);
2797   4                                      hua_816(24,29,2,0,0);
2798   4                                      for(jj=0;jj<64;jj++)
2799   4                                      {
2800   5                                              LB[jj]=k1616[jj+64];
2801   5                                      }
2802   4                                      hua_816(49,29,3,0,0);
2803   4                                      delay(60000);                           
2804   4                                      hua_816(57,29,3,2,0);
2805   4                                      for(jj=0;jj<64;jj++)
2806   4                                      {
2807   5                                              LB[jj]=k816[jj];
2808   5                                              LB1[jj]=k816[jj+64];
2809   5                                              LB2[jj]=k816[jj+128];
2810   5                                      }
2811   4                                      hua_816(16,29,3,4,0);
2812   4                              }
2813   3                              if(yangss==6)
2814   3                              {
2815   4                                      for(jj=0;jj<64;jj++)
2816   4                                      {
2817   5                                              LB[jj]=k816[jj];
2818   5                                              LB1[jj]=k816[jj+64];
2819   5                                              LB2[jj]=k816[jj+128];
2820   5                                      }
2821   4                                      hua_816(16,29,3,4,0);
2822   4                                      for(jj=0;jj<64;jj++)
2823   4                                      {
2824   5                                              LB[jj]=k1616[jj+64];
2825   5                                      }
2826   4                                      hua_816(57,29,3,2,0);
2827   4                                      delay(60000);
2828   4                                      hua_816(49,29,3,0,0);
2829   4                                      for(jj=0;jj<64;jj++)
2830   4                                      {
2831   5                                              LB[jj]=k816[jj];
2832   5                                              LB1[jj]=k816[jj+64];
2833   5                                              LB2[jj]=k816[jj+128];
2834   5                                      }
2835   4                                      hua_816(24,29,2,0,0);
2836   4                                      delay(60000);
2837   4                                      hua_816(32,29,1,nian1*2,0);                             
2838   4                                      hua_816(40,29,2,nian2*2,0);                             
2839   4                              }
2840   3                      }
2841   2                      if(bufen==2)  
2842   2                      {
2843   3                              if(yangss==1)    
2844   3                              {
2845   4                                      for(jj=0;jj<64;jj++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 47  

2846   4                                      {
2847   5                                              LB[jj]=k816[jj];
2848   5                                              LB1[jj]=k816[jj+64];
2849   5                                              LB2[jj]=k816[jj+128];
2850   5                                      }
2851   4                                      hua_816(9,29,2,yue1*2,0);
2852   4                                      delay(30000);
2853   4                                      hua_816(17,29,3,yue2*2,0);
2854   4                                      delay(30000);
2855   4                                      for(jj=0;jj<64;jj++)
2856   4                                      {
2857   5                                              LB[jj]=k1616[jj+64];
2858   5                                              LB1[jj]=k1616[jj+128];
2859   5                                      }
2860   4                                      hua_1616(33,30,1,4,0);
2861   4                                      delay(30000);
2862   4                                      for(jj=0;jj<64;jj++)
2863   4                                      {
2864   5                                              LB[jj]=k816[jj];
2865   5                                              LB1[jj]=k816[jj+64];
2866   5                                              LB2[jj]=k816[jj+128];
2867   5                                      }
2868   4                                      hua_816(40,29,2,ri1*2,0);
2869   4                                      delay(30000);
2870   4                                      hua_816(48,29,1,ri2*2,0);
2871   4                                      delay(30000);
2872   4                                      for(jj=0;jj<64;jj++)
2873   4                                      {
2874   5                                              LB[jj]=k1616[jj+64];
2875   5                                              LB1[jj]=k1616[jj+128];
2876   5                                      }
2877   4                                      hua_1616(63,30,3,8,0);
2878   4                                      
2879   4                              }
2880   3                              if(yangss==2)
2881   3                              {
2882   4                                      for(jj=0;jj<64;jj++)
2883   4                                      {
2884   5                                              LB[jj]=k1616[jj+64];
2885   5                                              LB1[jj]=k1616[jj+128];
2886   5                                      }
2887   4                                      hua_1616(63,30,3,8,0);
2888   4                                      for(jj=0;jj<64;jj++)
2889   4                                      {
2890   5                                              LB[jj]=k816[jj];
2891   5                                              LB1[jj]=k816[jj+64];
2892   5                                              LB2[jj]=k816[jj+128];
2893   5                                      }                               
2894   4                                      hua_816(48,29,1,ri2*2,0);
2895   4                                      delay(30000);
2896   4                                      hua_816(40,29,2,ri1*2,0);
2897   4                                      delay(30000);
2898   4                                      for(jj=0;jj<64;jj++)
2899   4                                      {
2900   5                                              LB[jj]=k1616[jj+64];
2901   5                                              LB1[jj]=k1616[jj+128];
2902   5                                      }
2903   4                                      hua_1616(33,30,1,4,0);
2904   4                                      delay(30000);
2905   4                                      for(jj=0;jj<64;jj++)
2906   4                                      {
2907   5                                              LB[jj]=k816[jj];
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 48  

2908   5                                              LB1[jj]=k816[jj+64];
2909   5                                              LB2[jj]=k816[jj+128];
2910   5                                      }
2911   4                                      hua_816(17,29,3,yue2*2,0);                              
2912   4                                      delay(30000);
2913   4                                      hua_816(9,29,2,yue1*2,0);
2914   4                              }
2915   3                              if(yangss==3)
2916   3                              {
2917   4                                      for(jj=0;jj<64;jj++)
2918   4                                      {
2919   5                                              LB[jj]=k816[jj];
2920   5                                              LB1[jj]=k816[jj+64];
2921   5                                              LB2[jj]=k816[jj+128];
2922   5                                      }
2923   4                                      for(foo=48;foo!=29;foo--)
2924   4                                      {
2925   5                                              qu_816(9,foo+1,2,yue1*2,0);
2926   5                                              hua_816(9,foo,2,yue1*2,0);
2927   5                                              delay(2000);
2928   5                                      }
2929   4                                      for(foo=48;foo!=29;foo--)
2930   4                                      {
2931   5                                              qu_816(17,foo+1,3,yue2*2,0);
2932   5                                              hua_816(17,foo,3,yue2*2,0);
2933   5                                              delay(2000);
2934   5                                      }
2935   4                                      for(jj=0;jj<64;jj++)
2936   4                                      {
2937   5                                              LB[jj]=k1616[jj+64];
2938   5                                              LB1[jj]=k1616[jj+128];
2939   5                                      }
2940   4                                      for(foo=48;foo!=29;foo--)
2941   4                                      {
2942   5                                              qu_1616(33,foo+1,1,4,0);
2943   5                                              hua_1616(33,foo,1,4,0);
2944   5                                              delay(2000);
2945   5                                      }
2946   4                                      for(jj=0;jj<64;jj++)
2947   4                                      {
2948   5                                              LB[jj]=k816[jj];
2949   5                                              LB1[jj]=k816[jj+64];
2950   5                                              LB2[jj]=k816[jj+128];
2951   5                                      }
2952   4                                      for(foo=48;foo!=29;foo--)
2953   4                                      {
2954   5                                              qu_816(40,foo+1,2,ri1*2,0);
2955   5                                              hua_816(40,foo,2,ri1*2,0);
2956   5                                              delay(2000);
2957   5                                      }
2958   4                                      for(foo=48;foo!=29;foo--)
2959   4                                      {
2960   5                                              qu_816(48,foo+1,1,ri2*2,0);
2961   5                                              hua_816(48,foo,1,ri2*2,0);
2962   5                                              delay(2000);
2963   5                                      }
2964   4                                      for(jj=0;jj<64;jj++)
2965   4                                      {
2966   5                                              LB[jj]=k1616[jj+64];
2967   5                                              LB1[jj]=k1616[jj+128];
2968   5                                      }
2969   4                                      for(foo=48;foo!=29;foo--)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 49  

2970   4                                      {
2971   5                                              qu_1616(63,foo+1,3,8,0);                                        
2972   5                                              hua_1616(63,foo,3,8,0);
2973   5                                              delay(2000);
2974   5                                      }
2975   4                              }
2976   3                              if(yangss==4)
2977   3                              {
2978   4                                              for(jj=0;jj<64;jj++)
2979   4                                      {
2980   5                                              LB[jj]=k1616[jj+64];
2981   5                                              LB1[jj]=k1616[jj+128];
2982   5                                      }
2983   4                                      for(foo=48;foo!=29;foo--)
2984   4                                      {
2985   5                                              qu_1616(63,foo+1,3,8,0);                                        
2986   5                                              hua_1616(63,foo,3,8,0);
2987   5                                              delay(2000);
2988   5                                      }
2989   4                                      for(jj=0;jj<64;jj++)
2990   4                                      {
2991   5                                              LB[jj]=k816[jj];
2992   5                                              LB1[jj]=k816[jj+64];
2993   5                                              LB2[jj]=k816[jj+128];
2994   5                                      }                               
2995   4                                      for(foo=48;foo!=29;foo--)
2996   4                                      {
2997   5                                              qu_816(48,foo+1,1,ri2*2,0);
2998   5                                              hua_816(48,foo,1,ri2*2,0);
2999   5                                              delay(2000);
3000   5                                      }
3001   4                                      for(foo=48;foo!=29;foo--)
3002   4                                      {
3003   5                                              qu_816(40,foo+1,2,ri1*2,0);
3004   5                                              hua_816(40,foo,2,ri1*2,0);
3005   5                                              delay(2000);
3006   5                                      }
3007   4                                      for(jj=0;jj<64;jj++)
3008   4                                      {
3009   5                                              LB[jj]=k1616[jj+64];
3010   5                                              LB1[jj]=k1616[jj+128];
3011   5                                      }
3012   4                                      for(foo=48;foo!=29;foo--)
3013   4                                      {
3014   5                                              qu_1616(33,foo+1,1,4,0);
3015   5                                              hua_1616(33,foo,1,4,0);
3016   5                                              delay(2000);
3017   5                                      }
3018   4                                      for(jj=0;jj<64;jj++)
3019   4                                      {
3020   5                                              LB[jj]=k816[jj];
3021   5                                              LB1[jj]=k816[jj+64];
3022   5                                              LB2[jj]=k816[jj+128];
3023   5                                      }                               
3024   4                                      for(foo=48;foo!=29;foo--)
3025   4                                      {
3026   5                                              qu_816(17,foo+1,3,yue2*2,0);
3027   5                                              hua_816(17,foo,3,yue2*2,0);
3028   5                                              delay(2000);
3029   5                                      }
3030   4                                      for(foo=48;foo!=29;foo--)
3031   4                                      {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 50  

3032   5                                              qu_816(9,foo+1,2,yue1*2,0);
3033   5                                              hua_816(9,foo,2,yue1*2,0);
3034   5                                              delay(2000);
3035   5                                      }                               
3036   4                              
3037   4                              }
3038   3                              if(yangss==5)
3039   3                              {
3040   4                                      for(jj=0;jj<64;jj++)
3041   4                                      {
3042   5                                              LB[jj]=k816[jj];
3043   5                                              LB1[jj]=k816[jj+64];
3044   5                                              LB2[jj]=k816[jj+128];
3045   5                                      }
3046   4                                      hua_816(40,29,2,ri1*2,0);
3047   4                                      for(jj=0;jj<64;jj++)
3048   4                                      {
3049   5                                              LB[jj]=k1616[jj+64];
3050   5                                              LB1[jj]=k1616[jj+128];
3051   5                                      }
3052   4                                      hua_816(33,30,1,6,0);
3053   4                                      delay(60000);
3054   4                                      hua_816(25,30,1,4,0);
3055   4                                      for(jj=0;jj<64;jj++)
3056   4                                      {
3057   5                                              LB[jj]=k816[jj];
3058   5                                              LB1[jj]=k816[jj+64];
3059   5                                              LB2[jj]=k816[jj+128];
3060   5                                      }
3061   4                                      hua_816(48,29,1,ri2*2,0);
3062   4                                      delay(60000);
3063   4                                      hua_816(17,29,3,yue2*2,0);
3064   4                                      for(jj=0;jj<64;jj++)
3065   4                                      {
3066   5                                              LB[jj]=k1616[jj+64];
3067   5                                              LB1[jj]=k1616[jj+128];
3068   5                                      }
3069   4                                      hua_816(55,30,3,8,0);
3070   4                                      delay(60000);
3071   4                                      hua_816(63,30,3,10,0);
3072   4                                      for(jj=0;jj<64;jj++)
3073   4                                      {
3074   5                                              LB[jj]=k816[jj];
3075   5                                              LB1[jj]=k816[jj+64];
3076   5                                              LB2[jj]=k816[jj+128];
3077   5                                      }
3078   4                                       hua_816(9,29,2,yue1*2,0);
3079   4                              }
3080   3                              if(yangss==6)
3081   3                              {
3082   4                                       for(jj=0;jj<64;jj++)
3083   4                                      {
3084   5                                              LB[jj]=k816[jj];
3085   5                                              LB1[jj]=k816[jj+64];
3086   5                                              LB2[jj]=k816[jj+128];
3087   5                                      }
3088   4                                       hua_816(9,29,2,yue1,0);
3089   4                                      for(jj=0;jj<64;jj++)
3090   4                                      {
3091   5                                              LB[jj]=k1616[jj+64];
3092   5                                              LB1[jj]=k1616[jj+128];
3093   5                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 51  

3094   4                                      hua_816(63,30,3,10,0);
3095   4                                      delay(60000);
3096   4                                      hua_816(55,30,3,8,0);
3097   4                                      for(jj=0;jj<64;jj++)
3098   4                                      {
3099   5                                              LB[jj]=k816[jj];
3100   5                                              LB1[jj]=k816[jj+64];
3101   5                                              LB2[jj]=k816[jj+128];
3102   5                                      }
3103   4                                      hua_816(17,29,3,yue2*2,0);
3104   4                                      delay(60000);
3105   4                                      hua_816(48,29,1,ri2*2,0);
3106   4                                      for(jj=0;jj<64;jj++)
3107   4                                      {
3108   5                                              LB[jj]=k1616[jj+64];
3109   5                                              LB1[jj]=k1616[jj+128];
3110   5                                      }
3111   4                                      hua_816(25,30,1,4,0);
3112   4                                      delay(60000);
3113   4                                      hua_816(33,30,1,6,0);
3114   4                                      for(jj=0;jj<64;jj++)
3115   4                                      {
3116   5                                              LB[jj]=k816[jj];
3117   5                                              LB1[jj]=k816[jj+64];
3118   5                                              LB2[jj]=k816[jj+128];
3119   5                                      }
3120   4                                      hua_816(40,29,2,ri1*2,0);       
3121   4                              }
3122   3                      }
3123   2                      if(bufen==3)    
3124   2                      {
3125   3                               if(yangss==1)  
3126   3                              {
3127   4                                      for(jj=0;jj<64;jj++)
3128   4                                      {
3129   5                                              LB[jj]=k1616[jj+160];
3130   5                                      }
3131   4                                      hua_1616(24,30,2,0,0);
3132   4                                      delay(60000);
3133   4                                      hua_1616(40,30,1,4,0);
3134   4                                      delay(60000);
3135   4                                      if(xinqi<7)
3136   4                                      {
3137   5                                              for(jj=0;jj<64;jj++)
3138   5                                              {
3139   6                                                      LB[jj]=xinq[jj];
3140   6                                                      LB1[jj]=xinq[jj+64];
3141   6                                                      LB2[jj]=xinq[jj+128];
3142   6                                              }
3143   5                                              hua_1616(56,30,3,(xinqi-1)*4,0);
3144   5                                      }
3145   4                                      else
3146   4                                      {
3147   5                                              for(jj=0;jj<64;jj++)
3148   5                                              {
3149   6                                                      LB[jj]=k1616[jj+128];
3150   6                                              }
3151   5                                              hua_1616(56,30,3,0,0);
3152   5                                      }
3153   4                              }
3154   3                              if(yangss==2)
3155   3                              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 52  

3156   4                                      if(xinqi<7)
3157   4                                      {
3158   5                                              for(jj=0;jj<64;jj++)
3159   5                                              {
3160   6                                                      LB[jj]=xinq[jj];
3161   6                                                      LB1[jj]=xinq[jj+64];
3162   6                                                      LB2[jj]=xinq[jj+128];
3163   6                                              }
3164   5                                              hua_1616(56,30,3,(xinqi-1)*4,0);
3165   5                                      }
3166   4                                      else
3167   4                                      {
3168   5                                              for(jj=0;jj<64;jj++)
3169   5                                              {
3170   6                                                      LB[jj]=k1616[jj+128];
3171   6                                              }
3172   5                                              hua_1616(56,30,3,0,0);
3173   5                                      }
3174   4                                      delay(60000);
3175   4                                      for(jj=0;jj<64;jj++)
3176   4                                      {
3177   5                                              LB[jj]=k1616[jj+160];
3178   5                                      }                               
3179   4                                      hua_1616(40,30,1,4,0);
3180   4                                      delay(60000);
3181   4                                      hua_1616(24,30,2,0,0);
3182   4                                      delay(60000);
3183   4                              }
3184   3                              if(yangss==3)
3185   3                              {
3186   4                                      for(jj=0;jj<64;jj++)
3187   4                                      {
3188   5                                              LB[jj]=k1616[jj+160];
3189   5                                      }
3190   4                                      for(foo=48;foo!=29;foo--)
3191   4                                      {
3192   5                                              qu_1616(24,foo+1,2,0,0);
3193   5                                              hua_1616(24,foo,2,0,0);
3194   5                                              delay(3000);
3195   5                                      }
3196   4                                      for(foo=48;foo!=29;foo--)
3197   4                                      {
3198   5                                              qu_1616(40,foo+1,1,4,0);
3199   5                                              hua_1616(40,foo,1,4,0);
3200   5                                              delay(3000);
3201   5                                      }
3202   4                                      if(xinqi<7)
3203   4                                      {
3204   5                                              for(jj=0;jj<64;jj++)
3205   5                                              {
3206   6                                                      LB[jj]=xinq[jj];
3207   6                                                      LB1[jj]=xinq[jj+64];
3208   6                                                      LB2[jj]=xinq[jj+128];
3209   6                                              }
3210   5                                              for(foo=48;foo!=29;foo--)
3211   5                                              {
3212   6                                                      qu_1616(56,foo+1,3,(xinqi-1)*4,0);
3213   6                                                      hua_1616(56,foo,3,(xinqi-1)*4,0);
3214   6                                                      delay(3000);
3215   6                                              }
3216   5                                      }
3217   4                                      else
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 53  

3218   4                                      {
3219   5                                              for(jj=0;jj<64;jj++)
3220   5                                              {
3221   6                                                      LB[jj]=k1616[jj+128];
3222   6                                              }
3223   5                                              for(foo=48;foo!=29;foo--)
3224   5                                              {
3225   6                                                      qu_1616(56,foo+1,3,0,0);
3226   6                                                      hua_1616(56,foo,3,0,0);
3227   6                                                      delay(3000);
3228   6                                              }
3229   5                                      }
3230   4                              }
3231   3                              if(yangss==4)
3232   3                              {
3233   4                                      if(xinqi<7)
3234   4                                      {
3235   5                                              for(jj=0;jj<64;jj++)
3236   5                                              {
3237   6                                                      LB[jj]=xinq[jj];
3238   6                                                      LB1[jj]=xinq[jj+64];
3239   6                                                      LB2[jj]=xinq[jj+128];
3240   6                                              }
3241   5                                              for(foo=48;foo!=29;foo--)
3242   5                                              {
3243   6                                                      qu_1616(56,foo+1,3,(xinqi-1)*4,0);
3244   6                                                      hua_1616(56,foo,3,(xinqi-1)*4,0);
3245   6                                                      delay(3000);
3246   6                                              }
3247   5                                      }
3248   4                                      else
3249   4                                      {
3250   5                                              for(jj=0;jj<64;jj++)
3251   5                                              {
3252   6                                                      LB[jj]=k1616[jj+128];
3253   6                                              }
3254   5                                              for(foo=48;foo!=29;foo--)
3255   5                                              {
3256   6                                                      qu_1616(56,foo+1,3,0,0);
3257   6                                                      hua_1616(56,foo,3,0,0);
3258   6                                                      delay(3000);
3259   6                                              }
3260   5                                      }
3261   4                                      for(jj=0;jj<64;jj++)
3262   4                                      {
3263   5                                              LB[jj]=k1616[jj+160];
3264   5                                      }                               
3265   4                                      for(foo=48;foo!=29;foo--)
3266   4                                      {
3267   5                                              qu_1616(40,foo+1,1,4,0);
3268   5                                              hua_1616(40,foo,1,4,0);
3269   5                                              delay(3000);
3270   5                                      }
3271   4                                      for(foo=48;foo!=29;foo--)
3272   4                                      {
3273   5                                              qu_1616(24,foo+1,2,0,0);
3274   5                                              hua_1616(24,foo,2,0,0);
3275   5                                              delay(3000);
3276   5                                      }
3277   4                              }
3278   3                              if(yangss==5)
3279   3                              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 54  

3280   4                                      for(jj=0;jj<64;jj++)
3281   4                                      {
3282   5                                              LB[jj]=k1616[jj+160];
3283   5                                      }
3284   4                                      hua_1616(40,30,1,4,0);
3285   4                                      delay(60000);
3286   4                                      hua_816(24,30,2,2,0);
3287   4                                      if(xinqi<7)
3288   4                                      {
3289   5                                              for(jj=0;jj<64;jj++)
3290   5                                              {
3291   6                                                      LB[jj]=xinq[jj];
3292   6                                                      LB1[jj]=xinq[jj+64];
3293   6                                                      LB2[jj]=xinq[jj+128];
3294   6                                              }
3295   5                                              hua_816(48,30,3,(xinqi-1)*4,0);
3296   5                                      }
3297   4                                      else
3298   4                                      {
3299   5                                              for(jj=0;jj<64;jj++)
3300   5                                              {
3301   6                                                      LB[jj]=k1616[jj+128];
3302   6                                              }
3303   5                                              hua_816(48,30,3,0,0);
3304   5                                      }
3305   4                                      delay(60000);
3306   4                                      if(xinqi<7)
3307   4                                      {
3308   5                                              for(jj=0;jj<64;jj++)
3309   5                                              {
3310   6                                                      LB[jj]=xinq[jj];
3311   6                                                      LB1[jj]=xinq[jj+64];
3312   6                                                      LB2[jj]=xinq[jj+128];
3313   6                                              }
3314   5                                              hua_816(56,30,3,(xinqi-1)*4+2,0);
3315   5                                      }
3316   4                                      else
3317   4                                      {
3318   5                                              for(jj=0;jj<64;jj++)
3319   5                                              {
3320   6                                                      LB[jj]=k1616[jj+128];
3321   6                                              }
3322   5                                              hua_816(56,30,3,2,0);
3323   5                                      }
3324   4                                      for(jj=0;jj<64;jj++)
3325   4                                      {
3326   5                                              LB[jj]=k1616[jj+160];
3327   5                                      }
3328   4                                      hua_816(16,30,2,0,0);
3329   4                              }
3330   3                              if(yangss==6)
3331   3                              {
3332   4                                      if(xinqi<7)
3333   4                                      {
3334   5                                              for(jj=0;jj<64;jj++)
3335   5                                              {
3336   6                                                      LB[jj]=xinq[jj];
3337   6                                                      LB1[jj]=xinq[jj+64];
3338   6                                                      LB2[jj]=xinq[jj+128];
3339   6                                              }
3340   5                                              hua_816(56,30,3,(xinqi-1)*4+2,0);
3341   5                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 55  

3342   4                                      else
3343   4                                      {
3344   5                                              for(jj=0;jj<64;jj++)
3345   5                                              {
3346   6                                                      LB[jj]=k1616[jj+128];
3347   6                                              }
3348   5                                              hua_816(56,30,3,2,0);
3349   5                                      }
3350   4                                      for(jj=0;jj<64;jj++)
3351   4                                      {
3352   5                                              LB[jj]=k1616[jj+160];
3353   5                                      }
3354   4                                      hua_816(16,30,2,0,0);
3355   4                                      delay(60000);
3356   4                                      hua_816(24,30,2,2,0);
3357   4                                      if(xinqi<7)
3358   4                                      {
3359   5                                              for(jj=0;jj<64;jj++)
3360   5                                              {
3361   6                                                      LB[jj]=xinq[jj];
3362   6                                                      LB1[jj]=xinq[jj+64];
3363   6                                                      LB2[jj]=xinq[jj+128];
3364   6                                              }
3365   5                                              hua_816(48,30,3,(xinqi-1)*4,0);
3366   5                                      }
3367   4                                      else
3368   4                                      {
3369   5                                              for(jj=0;jj<64;jj++)
3370   5                                              {
3371   6                                                      LB[jj]=k1616[jj+128];
3372   6                                              }
3373   5                                              hua_816(48,30,3,0,0);
3374   5                                      }
3375   4                                      delay(60000);
3376   4                                      for(jj=0;jj<64;jj++)
3377   4                                      {
3378   5                                              LB[jj]=k1616[jj+160];
3379   5                                      }
3380   4                                      hua_1616(40,30,1,4,0);
3381   4                                      
3382   4                                      
3383   4                              }
3384   3                      }
3385   2              }
3386   1              if(xiaox==2)      
3387   1              {
3388   2                      if(bufen>0&&bufen<4)      
3389   2                      {
3390   3                               if(yangss==1)  
3391   3                              {
3392   4                                      for(foo=1;foo<63;foo++)
3393   4                                      {
3394   5                                              for(jj=13;jj<31;jj++)
3395   5                                              {
3396   6                                                      qing_dian1(foo,jj,3);
3397   6                                              }
3398   5                                              delay(3000);
3399   5                                      }
3400   4                              }
3401   3                              if(yangss==2)
3402   3                              {
3403   4                                      for(foo=62;foo>0;foo--)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 56  

3404   4                                      {
3405   5                                              for(jj=13;jj<31;jj++)
3406   5                                              {
3407   6                                                      qing_dian1(foo,jj,3);
3408   6                                              }
3409   5                                              delay(3000);
3410   5                                      }
3411   4                              }
3412   3                              if(yangss==3)
3413   3                              {
3414   4                                      for(foo=14;foo<31;foo++)
3415   4                                      {
3416   5                                                      fenhang(foo,0);
3417   5                                                      delay(5000);
3418   5                                                      hangyi(foo-1,13);
3419   5                                                      fenhang(foo,2);
3420   5                                                      delay(5000);
3421   5                                                      hangyi(foo,13);
3422   5                                      }
3423   4                                      for(foo=0;foo<19;foo++)
3424   4                                      {
3425   5                                              hangyi(30,13);
3426   5                                      }
3427   4                              }
3428   3                              if(yangss==4)
3429   3                              {
3430   4                                      for(foo=62;foo>30;foo--)
3431   4                                      {
3432   5                                              for(jj=13;jj<31;jj++)
3433   5                                              {
3434   6                                                      qing_dian1(foo-30,jj,3);
3435   6                                                      qing_dian1(93-foo,jj,3);
3436   6                                              }
3437   5                                              delay(6000);
3438   5                                      }
3439   4                              }
3440   3                              if(yangss==5)
3441   3                              {
3442   4                                      for(foo=62;foo>0;foo--)
3443   4                                      {
3444   5                                              for(jj=13;jj<22;jj++)
3445   5                                              {
3446   6                                                      qing_dian1(foo,jj,3);
3447   6                                                      qing_dian1(63-foo,jj+9,3);
3448   6                                              }
3449   5                                              delay(3000);
3450   5                                      }
3451   4                              }
3452   3                              if(yangss==6)
3453   3                              {
3454   4                                      for(foo=13;foo<31;foo++)
3455   4                                      {
3456   5                                              for(jj=1;jj<63;jj++)
3457   5                                              {
3458   6                                                      qing_dian1(jj,foo,3);
3459   6                                              }
3460   5                                              delay(10000);
3461   5                                      }
3462   4                              }
3463   3                              if(yangss==7)
3464   3                              {
3465   4                                      for(foo=13;foo<31;foo++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 57  

3466   4                                      {
3467   5                                              for(jj=1;jj<55;jj++)
3468   5                                              {
3469   6                                                      qing_dian1(jj,foo,3);
3470   6                                                      qing_dian1(jj+8,43-foo,3);
3471   6                                                      qing_dian1(55,foo,3);
3472   6                                                      qing_dian1(56,foo,3);
3473   6                                                      if(jj%8==0) jj+=8;
3474   6                                              }
3475   5                                              delay(10000);
3476   5                                      }
3477   4                              }
3478   3                              if(yangss==8)
3479   3                              {
3480   4                                      for(foo=22;foo<31;foo++)
3481   4                                      {
3482   5                                              for(jj=1;jj<63;jj++)
3483   5                                              {
3484   6                                                      qing_dian1(jj,foo,3);
3485   6                                                      qing_dian1(jj,43-foo,3);
3486   6                                              }
3487   5                                              delay(20000);
3488   5                                      }
3489   4                              }
3490   3                      }
3491   2              }
3492   1      }
3493          
3494          
3495          void shiwen()             //显示温度
3496          {
3497   1              uchar fo;
3498   1              for(jj=0;jj<64;jj++)
3499   1              {
3500   2                      LB[jj]=k816[jj];
3501   2                      LB1[jj]=k816[jj+64];
3502   2                      LB2[jj]=k816[jj+128];
3503   2              }
3504   1              TR1=0;
3505   1              P2M0|=0x10;
3506   1              qu_816(44,15,1,efenbai*2,0);
3507   1              efenbai=wen/100;
3508   1              hua_816(44,15,1,efenbai*2,0);
3509   1              P2M0&=0xef;
3510   1              TR1=1;
3511   1              TR1=0;
3512   1              P2M0|=0x10;
3513   1              qu_816(51,15,2,efenshi*2,0);
3514   1              efenshi=wen%100/10;
3515   1              hua_816(51,15,2,efenshi*2,0);
3516   1              P2M0&=0xef;
3517   1              TR1=1;          
3518   1              TR1=0;
3519   1              P2M0|=0x10;                                                                     
3520   1              qu_816(62,15,3,efenge*2,0);
3521   1              efenge=wen%10;
3522   1              hua_816(62,15,3,efenge*2,0);
3523   1              P2M0&=0xef;
3524   1              TR1=1;
3525   1      
3526   1              fen4=wfen%16;
3527   1              if(fen4!=fen2)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 58  

3528   1              {
3529   2                      for(fo=0;fo<16;fo++)
3530   2                      {
3531   3                              qu_816(34,15,2,fen2*2,fo);
3532   3                              hua_816(34,15,2,fen2*2,fo+1);
3533   3                              delay(10000);
3534   3                      }
3535   2                      fen2=fen4;
3536   2              }
3537   1              fen3=wfen/16;
3538   1              if(fen3!=fen1)
3539   1              {
3540   2                      if(fen3>0)
3541   2                      {
3542   3                              for(fo=0;fo<16;fo++)
3543   3                              {
3544   4                                      qu_816(27,15,1,fen1*2,fo);
3545   4                                      hua_816(27,15,1,fen1*2,fo+1);
3546   4                                      delay(10000);
3547   4                              }
3548   3                      }
3549   2                      if(fen3==0)
3550   2                      {
3551   3                              for(jj=0;jj<16;jj++)
3552   3                              {
3553   4                                      LB1[jj+32]=k816[jj];
3554   4                              }
3555   3                              for(fo=0;fo<16;fo++)
3556   3                              {
3557   4                                      qu_816(27,15,1,fen1*2,fo);
3558   4                                      hua_816(27,15,1,fen1*2,fo+1);
3559   4                                      delay(10000);
3560   4                              }
3561   3                              for(jj=0;jj<64;jj++)
3562   3                              {
3563   4                                      LB[jj]=k816[jj];
3564   4                                      LB1[jj]=k816[jj+64];
3565   4                                      LB2[jj]=k816[jj+128];
3566   4                              }
3567   3                      }
3568   2                      fen1=fen3;
3569   2      
3570   2              }
3571   1              shi4=wshi%16;
3572   1              if(shi4!=shi2)
3573   1              {
3574   2                      if(shi3!=2)
3575   2                      {
3576   3                              for(fo=0;fo<16;fo++)
3577   3                              {
3578   4                                      qu_816(16,15,2,shi2*2,fo);
3579   4                                      hua_816(16,15,2,shi2*2,fo+1);
3580   4                                      delay(10000);
3581   4                              }
3582   3                      }
3583   2                      if(shi3==2)
3584   2                      {
3585   3                              if(shi4!=0)
3586   3                              {
3587   4                                      for(fo=0;fo<16;fo++)
3588   4                                      {
3589   5                                              qu_816(16,15,2,shi2*2,fo);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 59  

3590   5                                              hua_816(16,15,2,shi2*2,fo+1);
3591   5                                              delay(10000);
3592   5                                      }
3593   4                              }
3594   3                              if(shi4==0)
3595   3                              {
3596   4                                      for(jj=0;jj<16;jj++)
3597   4                                      {
3598   5      
3599   5                                              LB1[jj]=k816[jj];;
3600   5                                      }
3601   4                                      for(fo=0;fo<16;fo++)
3602   4                                      {
3603   5                                              qu_816(16,15,2,shi2*2,fo);
3604   5                                              hua_816(16,15,2,shi2*2,fo+1);
3605   5                                              delay(10000);
3606   5                                      }
3607   4                                      for(jj=0;jj<64;jj++)
3608   4                                      {
3609   5                                              LB[jj]=k816[jj];
3610   5                                              LB1[jj]=k816[jj+64];
3611   5                                              LB2[jj]=k816[jj+128];
3612   5                                      }
3613   4                              }
3614   3                      }
3615   2                      shi2=shi4;
3616   2              }
3617   1              shi3=wshi/16;
3618   1              if(shi3!=shi1)
3619   1              {
3620   2                      if(shi3>0)
3621   2                      {
3622   3                              for(fo=0;fo<16;fo++)
3623   3                              {
3624   4                                      qu_816(9,15,3,shi1*2,fo);
3625   4                                      hua_816(9,15,3,shi1*2,fo+1);
3626   4                                      delay(10000);
3627   4                              }
3628   3                      }
3629   2                      if(shi3==0)
3630   2                      {
3631   3                              for(jj=0;jj<16;jj++)
3632   3                              {
3633   4                                      LB[jj+48]=k816[jj];
3634   4                              }
3635   3                              for(fo=0;fo<16;fo++)
3636   3                              {
3637   4                                      qu_816(9,15,3,shi1*2,fo);
3638   4                                      hua_816(9,15,3,shi1*2,fo+1);
3639   4                                      delay(10000);
3640   4                              }
3641   3                              for(jj=0;jj<64;jj++)
3642   3                              {
3643   4                                      LB[jj]=k816[jj];
3644   4                                      LB1[jj]=k816[jj+64];
3645   4                                      LB2[jj]=k816[jj+128];
3646   4                              }       
3647   3                      }
3648   2                      shi1=shi3;
3649   2              }               
3650   1              nian1=wnian/16;         
3651   1              nian2=wnian%16;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 60  

3652   1              yue1=wyue/16;
3653   1              yue2=wyue%16;
3654   1              ri1=wri/16;
3655   1              ri2=wri%16;
3656   1              xinqi=wxinq%16; 
3657   1      }
3658          
3659          
3660          void huashidian()         //画时间闪点
3661          {
3662   1              hua_dian(17,4,2);
3663   1              hua_dian(17,5,2);
3664   1              hua_dian(18,4,2);
3665   1              hua_dian(18,5,2);
3666   1      
3667   1              hua_dian(17,9,2);
3668   1              hua_dian(17,10,2);
3669   1              hua_dian(18,9,2);
3670   1              hua_dian(18,10,2);
3671   1      }
3672          
3673          
3674          
3675          void qushidian()          //取时间闪点
3676          {
3677   1              qing_dian(17,4,2);
3678   1              qing_dian(17,5,2);
3679   1              qing_dian(18,4,2);
3680   1              qing_dian(18,5,2);
3681   1              
3682   1              qing_dian(17,9,2);
3683   1              qing_dian(17,10,2);
3684   1              qing_dian(18,9,2);
3685   1              qing_dian(18,10,2);
3686   1      }
3687          
3688          void qing_huan_chong()           //清缓冲
3689          {
3690   1              for(i=0;i<64;i++)
3691   1              {
3692   2                      LB[i]=0xff;
3693   2                      LB1[i]=0xff;
3694   2                      LB2[i]=0xff;
3695   2              }
3696   1              for(i=0;i<128;i++)
3697   1              {
3698   2                      ttb1.eal[i]=0xffff;
3699   2                      ttb2.age[i]=0xffff;
3700   2              }
3701   1      }
3702          
3703          void yjszxs()             //一级设置显示
3704          {
3705   1              if(yiji==1)
3706   1              {
3707   2                      for(foo=1;foo<24;foo++)
3708   2                      {
3709   3                                      fenhang(foo,0);
3710   3                                      delay(5000);
3711   3                                      hangyi(foo-1,1);
3712   3                                      fenhang(foo,2);
3713   3                                      delay(5000);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 61  

3714   3                                      hangyi(foo,1);
3715   3                      }
3716   2                      for(foo=0;foo<24;foo++)
3717   2                      {
3718   3                              hangyi(23,1);
3719   3                      }
3720   2                      for(jj=0;jj<64;jj++)
3721   2                      {
3722   3                              LB[jj]=ajshezhi1[jj+64];
3723   3                              LB1[jj]=ajshezhi1[jj+192];
3724   3                      }
3725   2                      for(foo=48;foo>22;foo--)
3726   2                      {
3727   3                              qu_1616(17,foo+1,2,0,0);
3728   3                              hua_1616(17,foo,2,0,0);
3729   3                              delay(1500);
3730   3                      }
3731   2                      for(foo=48;foo>22;foo--)
3732   2                      {
3733   3                              qu_1616(32,foo+1,2,4,0);
3734   3                              hua_1616(32,foo,2,4,0);
3735   3                              delay(1500);
3736   3                      }
3737   2                       for(foo=48;foo>22;foo--)
3738   2                      {
3739   3                              qu_1616(48,foo+1,2,8,0);
3740   3                              hua_1616(48,foo,2,8,0);
3741   3                              delay(1500);
3742   3                      }
3743   2                      for(foo=48;foo>22;foo--)
3744   2                      {
3745   3                              qu_1616(63,foo+1,2,12,0);
3746   3                              hua_1616(63,foo,2,12,0);
3747   3                              delay(1500);
3748   3                      }
3749   2                      jishu=yiji;
3750   2                      yiji=3;                 
3751   2              }
3752   1              if(yiji==2)
3753   1              {
3754   2                      for(foo=1;foo<24;foo++)
3755   2                      {
3756   3                                      fenhang(foo,0);
3757   3                                      delay(5000);
3758   3                                      hangyi(foo-1,1);
3759   3                                      fenhang(foo,2);
3760   3                                      delay(5000);
3761   3                                      hangyi(foo,1);
3762   3                      }
3763   2                      for(foo=0;foo<24;foo++)
3764   2                      {
3765   3                              hangyi(23,1);
3766   3                      }
3767   2                      for(jj=0;jj<64;jj++)
3768   2                      {
3769   3                              LB[jj]=ajshezhi1[jj+128];
3770   3                              LB1[jj]=ajshezhi1[jj+192];
3771   3                      }
3772   2                      for(foo=48;foo>22;foo--)
3773   2                      {
3774   3                              qu_1616(17,foo+1,2,0,0);
3775   3                              hua_1616(17,foo,2,0,0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 62  

3776   3                              delay(1500);
3777   3                      }
3778   2                      for(foo=48;foo>22;foo--)
3779   2                      {
3780   3                              qu_1616(33,foo+1,2,4,0);
3781   3                              hua_1616(33,foo,2,4,0);
3782   3                              delay(1500);
3783   3                      }
3784   2                       for(foo=48;foo>22;foo--)
3785   2                      {
3786   3                              qu_1616(49,foo+1,2,8,0);
3787   3                              hua_1616(49,foo,2,8,0);
3788   3                              delay(1500);
3789   3                      }
3790   2                      for(foo=48;foo>22;foo--)
3791   2                      {
3792   3                              qu_1616(63,foo+1,2,12,0);
3793   3                              hua_1616(63,foo,2,12,0);
3794   3                              delay(1500);
3795   3                      }
3796   2                      jishu=yiji;
3797   2                      yiji=3;                 
3798   2              }
3799   1              
3800   1              if(key_jian==0|aaajjj==0x43)
3801   1              {
3802   2                      delay(5000);
3803   2                      if(key_jian==0|aaajjj==0x43)
3804   2                      {
3805   3                              if(jishu==1) yiji=2; else yiji=1;
3806   3                              aaajjj=0;
3807   3      
3808   3                      }
3809   2                      while(key_jian==0);
3810   2                      
3811   2              }
3812   1              if(key_jia==0|aaajjj==0x44)
3813   1              {
3814   2                      delay(5000);
3815   2                      if(key_jia==0|aaajjj==0x44)
3816   2                      {
3817   3                              if(jishu==1) yiji=2; else yiji=1;
3818   3                              aaajjj=0;
3819   3      
3820   3                      }
3821   2                      while(key_jia==0);
3822   2                      
3823   2              }
3824   1              if(key_fan_hiu==0|aaajjj==0x15)
3825   1              {
3826   2                      delay(5000);
3827   2                      if(key_fan_hiu==0|aaajjj==0x15)
3828   2                      {
3829   3                              szxh=0;
3830   3                              aaajjj=0;
3831   3                      }
3832   2                      while(key_fan_hiu==0);
3833   2                      
3834   2              }
3835   1              if(key_qu_ren==0|aaajjj==0x40)
3836   1              {
3837   2                      delay(5000);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 63  

3838   2                      if(key_qu_ren==0|aaajjj==0x40)
3839   2                      {
3840   3                              for(foo=1;foo<24;foo++)
3841   3                              {
3842   4                                              fenhang(foo,0);
3843   4                                              delay(5000);
3844   4                                              hangyi(foo-1,1);
3845   4                                              fenhang(foo,2);
3846   4                                              delay(5000);
3847   4                                              hangyi(foo,1);
3848   4                              }
3849   3                              for(foo=0;foo<24;foo++)
3850   3                              {
3851   4                                      hangyi(23,1);
3852   4                              }
3853   3                              if(jishu==1) yiji=4; else yiji=5;
3854   3                              erji=1;
3855   3                              aaajjj=0;
3856   3                      }
3857   2                      while(key_qu_ren==0);
3858   2                      
3859   2              }
3860   1      }
3861          
3862          void erszxs()             //二级设置显示
3863          {
3864   1              if(erji==1)
3865   1              {
3866   2                      for(foo=1;foo<63;foo++)
3867   2                      {
3868   3                              for(foo1=6;foo1<24;foo1++)
3869   3                              {
3870   4                                      qing_dian1(foo,foo1,3);
3871   4                              }
3872   3                              delay(3000);
3873   3                      }
3874   2                      for(jj=0;jj<64;jj++)
3875   2                      {
3876   3                              LB[jj]=ajshezhi2[jj];
3877   3                              LB1[jj]=ajshezhi2[jj+64];
3878   3                      }
3879   2                      for(foo=48;foo>22;foo--)
3880   2                      {
3881   3                              qu_1616(30,foo+1,2,0,0);
3882   3                              hua_1616(30,foo,2,0,0);
3883   3                              delay(1500);
3884   3                      }
3885   2                      for(foo=0;foo<24;foo++)
3886   2                      {
3887   3                              qu_1616(50,foo-1,2,4,0);
3888   3                              hua_1616(50,foo,2,4,0);
3889   3                              delay(1500);
3890   3                      }
3891   2      
3892   2                      jishu=erji;
3893   2                      erji=5;
3894   2              }
3895   1              if(erji==2)
3896   1              {
3897   2                      for(foo=62;foo>0;foo--)
3898   2                      {
3899   3                              for(foo1=6;foo1<24;foo1++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 64  

3900   3                              {
3901   4                                      qing_dian1(foo,foo1,3);
3902   4                              }
3903   3                              delay(3000);
3904   3                      }
3905   2                      for(jj=0;jj<64;jj++)
3906   2                      {
3907   3                              LB[jj]=ajshezhi2[jj+64];
3908   3                              LB1[jj]=ajshezhi2[jj+128];
3909   3                      }
3910   2                      for(foo=0;foo<31;foo++)
3911   2                      {
3912   3                              qu_1616(foo-1,23,2,0,0);
3913   3                              hua_1616(foo,23,2,0,0);
3914   3                              delay(1500);
3915   3                      }
3916   2                      for(foo=80;foo>49;foo--)
3917   2                      {
3918   3                              qu_1616(foo+1,23,2,4,0);
3919   3                              hua_1616(foo,23,2,4,0);
3920   3                              delay(1500);
3921   3                      }
3922   2      
3923   2                      jishu=erji;
3924   2                      erji=5;
3925   2              }
3926   1              if(erji==3)
3927   1              {
3928   2                      for(foo=25;foo>4;foo--)
3929   2                      {
3930   3                              for(foo1=1;foo1<63;foo1++)
3931   3                              {
3932   4                                      qing_dian1(foo1,foo,3);
3933   4                              }
3934   3                              delay(5000);
3935   3                      }
3936   2                      for(jj=0;jj<64;jj++)
3937   2                      {
3938   3                              LB[jj]=ajshezhi2[jj+128];                                       
3939   3                      }
3940   2                      for(jj=0;jj<32;jj++)
3941   2                      {
3942   3                              LB1[jj]=ajshezhi2[jj+192];
3943   3                      }
3944   2                      for(foo=0;foo<24;foo++)
3945   2                      {
3946   3                              qu_1616(23,foo-1,2,0,0);
3947   3                              hua_1616(23,foo,2,0,0);
3948   3                              delay(1500);
3949   3                      }
3950   2                      for(foo=0;foo<24;foo++)
3951   2                      {
3952   3                              qu_1616(40,foo-1,2,4,0);
3953   3                              hua_1616(40,foo,2,4,0);
3954   3                              delay(1500);
3955   3                      }
3956   2                      for(foo=0;foo<24;foo++)
3957   2                      {
3958   3                              qu_1616(57,foo-1,2,8,0);
3959   3                              hua_1616(57,foo,2,8,0);
3960   3                              delay(1500);
3961   3                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 65  

3962   2                      jishu=erji;
3963   2                      erji=5;
3964   2              }
3965   1              if(erji==4)
3966   1              {
3967   2                      for(foo=25;foo>4;foo--)
3968   2                      {
3969   3                              for(foo1=1;foo1<63;foo1++)
3970   3                              {
3971   4                                      qing_dian1(foo1,foo,3);
3972   4                              }
3973   3                              delay(5000);
3974   3                      }
3975   2                      for(jj=0;jj<64;jj++)
3976   2                      {
3977   3                              LB[jj]=ajshezhi3[jj+128];                                       
3978   3                      }
3979   2                      for(jj=0;jj<32;jj++)
3980   2                      {
3981   3                              LB1[jj]=ajshezhi3[jj+192];
3982   3                      }
3983   2                      for(foo=48;foo>22;foo--)
3984   2                      {
3985   3                              qu_1616(23,foo+1,2,0,0);
3986   3                              hua_1616(23,foo,2,0,0);
3987   3                              delay(1500);
3988   3                      }
3989   2                      for(foo=48;foo>22;foo--)
3990   2                      {
3991   3                              qu_1616(40,foo+1,2,4,0);
3992   3                              hua_1616(40,foo,2,4,0);
3993   3                              delay(1500);
3994   3                      }
3995   2                      for(foo=48;foo>22;foo--)
3996   2                      {
3997   3                              qu_1616(57,foo+1,2,8,0);
3998   3                              hua_1616(57,foo,2,8,0);
3999   3                              delay(1500);
4000   3                      }
4001   2                      jishu=erji;
4002   2                      erji=5;
4003   2              }
4004   1              if(key_jia==0|aaajjj==0x44)
4005   1              {
4006   2                      delay(5000);
4007   2                      if(key_jia==0|aaajjj==0x44)
4008   2                      {       aaajjj=0;
4009   3                              if(jishu<4) jishu++; else jishu=1;
4010   3                              erji=jishu;
4011   3                      }
4012   2                      while(key_jia==0);
4013   2              
4014   2              }
4015   1              if(key_jian==0|aaajjj==0x43)
4016   1              {
4017   2                      delay(5000);
4018   2                      if(key_jian==0|aaajjj==0x43)
4019   2                      {       aaajjj=0;
4020   3                              if(jishu>1) jishu--; else jishu=4;
4021   3                              erji=jishu;
4022   3                      }
4023   2                      while(key_jian==0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 66  

4024   2                      
4025   2              }
4026   1      }
4027          
4028          void gunzhi(uchar zzzz,uint zzz)  //翻字
4029          {
4030   1              for(foo1=0;foo1<16;foo1++)
4031   1              {
4032   2                      qu_1616(zzzz,23,2,0,0);
4033   2                      for(foo=0;foo<15;foo++)
4034   2                      {
4035   3                              LB[foo]=LB[foo+1];
4036   3                              LB[foo+16]=LB[foo+17];
4037   3                      }
4038   2                      LB[15]=LB[32];
4039   2                      LB[31]=LB[48];
4040   2                      for(foo=32;foo<47;foo++)
4041   2                      {
4042   3                              LB[foo]=LB[foo+1];
4043   3                              LB[foo+16]=LB[foo+17];
4044   3                      }
4045   2                      hua_1616(zzzz,23,2,0,0);
4046   2                      delay(zzz);
4047   2               }
4048   1      }
4049          
4050          
4051          void sjcscsh()    //时间参数初始化
4052          {
4053   1              for(jj=0;jj<64;jj++)
4054   1              {
4055   2                      LB[jj]=k816[jj];
4056   2                      LB1[jj]=k816[jj+64];
4057   2                      LB2[jj]=k816[jj+128];
4058   2              }
4059   1              for(foo=1;foo<63;foo++)
4060   1         {
4061   2                      for(foo1=1;foo1<31;foo1++)
4062   2                      {
4063   3                              qing_dian1(foo,foo1,3);
4064   3                      }
4065   2                      delay(3000);
4066   2         }
4067   1              TR1=0;
4068   1              P2M0|=0x10;
4069   1              wnian=Read1302(du_nian);
4070   1              wyue=Read1302(du_yue);
4071   1              wri=Read1302(du_tian);
4072   1              wxinq=Read1302(du_xin_qi);
4073   1              wshi=Read1302(du_xiao_shi);
4074   1              wfen=Read1302(du_fen_zhong);
4075   1              P2M0&=0xef;
4076   1              TR1=1;
4077   1              nian1=wnian/16;         
4078   1              nian2=wnian%16;
4079   1              yue1=wyue/16;
4080   1              yue2=wyue%16;
4081   1              ri1=wri/16;
4082   1              ri2=wri%16;
4083   1              xinqi=wxinq%16;
4084   1              shi1=wshi/16;
4085   1              shi2=wshi%16;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 67  

4086   1              fen1=wfen/16;
4087   1              fen2=wfen%16;
4088   1              hua_816(8,17,2,4,0);
4089   1              delay(20000);
4090   1              hua_816(15,17,2,0,0);
4091   1              delay(20000);
4092   1              hua_816(22,17,2,nian1*2,0);
4093   1              delay(20000);
4094   1              hua_816(29,17,2,nian2*2,0);
4095   1              delay(20000);
4096   1      
4097   1              hua_dian1(29,9,1);
4098   1              hua_dian1(30,9,1);
4099   1              hua_dian1(31,9,1);
4100   1              hua_dian1(29,10,1);
4101   1              hua_dian1(30,10,1);
4102   1              hua_dian1(31,10,1);
4103   1              delay(20000);
4104   1              hua_816(39,17,2,yue1*2,0);
4105   1              delay(20000);
4106   1              hua_816(46,17,2,yue2*2,0);
4107   1              delay(20000);
4108   1              hua_dian1(46,9,1);
4109   1              hua_dian1(47,9,1);
4110   1              hua_dian1(48,9,1);
4111   1              hua_dian1(46,10,1);
4112   1              hua_dian1(47,10,1);
4113   1              hua_dian1(48,10,1);
4114   1              delay(20000);
4115   1              hua_816(56,17,2,ri1*2,0);
4116   1              delay(20000);
4117   1              hua_816(63,17,2,ri2*2,0);
4118   1              delay(20000);
4119   1              hua_816(11,31,2,shi1*2,0);
4120   1              delay(20000);
4121   1              hua_816(19,31,2,shi2*2,0);
4122   1              delay(20000);
4123   1              hua_dian1(20,20,1);
4124   1              hua_dian1(21,20,1);
4125   1              hua_dian1(20,21,1);
4126   1              hua_dian1(21,21,1);
4127   1      
4128   1              hua_dian1(20,25,1);
4129   1              hua_dian1(21,25,1);
4130   1              hua_dian1(20,26,1);
4131   1              hua_dian1(21,26,1);
4132   1              delay(20000);
4133   1              hua_816(30,31,2,fen1*2,0);
4134   1              delay(20000);
4135   1              hua_816(38,31,2,fen2*2,0);
4136   1              delay(20000);
4137   1              if(wxinq==7)
4138   1              {
4139   2                 for(jj=0;jj<32;jj++)
4140   2                      {
4141   3                              LB[jj]=xinq[jj+192];
4142   3                      }
4143   2                      hua_1616(59,31,2,0,0);
4144   2              }
4145   1              else
4146   1              {
4147   2                      for(jj=0;jj<64;jj++)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 68  

4148   2                      {
4149   3                              LB[jj]=xinq[jj];
4150   3                              LB1[jj]=xinq[jj+64];
4151   3                              LB2[jj]=xinq[jj+128];
4152   3                      }
4153   2                      hua_1616(59,31,2,wxinq*4-4,0);
4154   2              }
4155   1              for(jj=0;jj<64;jj++)
4156   1              {
4157   2                      LB[jj]=k816[jj];
4158   2                      LB1[jj]=k816[jj+64];
4159   2                      LB2[jj]=k816[jj+128];
4160   2              }
4161   1              shiji=2;
4162   1      }
4163          void sj1302()     //时间年月日时分设置
4164          {
4165   1              if(shiji==1)
4166   1              {
4167   2                      sjcscsh();
4168   2              }
4169   1              while(shiji==2)
4170   1              {
4171   2                      qu_816(22,17,2,nian1*2,0);
4172   2                      hua_816(22,17,1,nian1*2,0);
4173   2                      while(shiji==2)
4174   2                      {
4175   3                              if(key_jia==0|aaajjj==0x44)
4176   3                              {
4177   4                                      delay(5000);
4178   4                                      if(key_jia==0|aaajjj==0x44)
4179   4                                      {       aaajjj=0;
4180   5                                              if(nian1<9) 
4181   5                                              {       
4182   6                                                      for(foo=1;foo<17;foo++)
4183   6                                                      {
4184   7                                                              qu_816(22,17,1,nian1*2,foo-1);
4185   7                                                              hua_816(22,17,1,nian1*2,foo);
4186   7                                                              delay(10000);
4187   7                                                      }
4188   6                                                      nian1++;
4189   6                                              }
4190   5                                      }
4191   4                                      while(key_jia==0);
4192   4                              
4193   4                              }
4194   3                              if(key_jian==0|aaajjj==0x43)
4195   3                              {
4196   4                                      delay(5000);
4197   4                                      if(key_jian==0|aaajjj==0x43)
4198   4                                      {       aaajjj=0;                                                               
4199   5                                              if(nian1>0)
4200   5                                              {                                       
4201   6                                                      for(foo=16;foo>0;foo--)
4202   6                                                      {
4203   7                                                              qu_816(22,17,1,(nian1-1)*2,foo);
4204   7                                                              hua_816(22,17,1,(nian1-1)*2,foo-1);
4205   7                                                              delay(10000);
4206   7                                                      }
4207   6                                                      nian1--;
4208   6                                              }
4209   5                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 69  

4210   4                                      while(key_jian==0);
4211   4                                      
4212   4                              }
4213   3                              if(key_fan_hiu==0|aaajjj==0x15)
4214   3                              {
4215   4                                      delay(5000);
4216   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4217   4                                      {       aaajjj=0;
4218   5                                              shiji=15;
4219   5                                              shanji=1;
4220   5                                              for(foo=1;foo<63;foo++)
4221   5                                         {
4222   6                                                      for(foo1=1;foo1<31;foo1++)
4223   6                                                      {
4224   7                                                              qing_dian1(foo,foo1,3);
4225   7                                                      }
4226   6                                                      delay(3000);
4227   6                                         }
4228   5                                      }
4229   4                                      while(key_fan_hiu==0);
4230   4                                      
4231   4                              }
4232   3                              if(key_qu_ren==0|aaajjj==0x40)
4233   3                              {
4234   4                                      delay(5000);
4235   4                                      if(key_qu_ren==0|aaajjj==0x40)
4236   4                                      {       aaajjj=0;
4237   5                                              shiji++;
4238   5                                              qu_816(22,17,1,nian1*2,0);
4239   5                                              hua_816(22,17,2,nian1*2,0);
4240   5                                      }
4241   4                                      while(key_qu_ren==0);
4242   4                                                                                              
4243   4                              }
4244   3                      }
4245   2              }
4246   1              while(shiji==3)
4247   1              {
4248   2                 qu_816(29,17,2,nian2*2,0);
4249   2                      hua_816(29,17,1,nian2*2,0);
4250   2                      while(shiji==3)
4251   2                      {
4252   3                              if(key_jia==0|aaajjj==0x44)
4253   3                              {
4254   4                                      delay(5000);
4255   4                                      if(key_jia==0|aaajjj==0x44)
4256   4                                      {       aaajjj=0;
4257   5                                              if(nian2<9) 
4258   5                                              {                                                                                       
4259   6                                                      for(foo=1;foo<17;foo++)
4260   6                                                      {
4261   7                                                              qu_816(29,17,1,nian2*2,foo-1);
4262   7                                                              hua_816(29,17,1,nian2*2,foo);
4263   7                                                              delay(10000);
4264   7                                                      }
4265   6                                                      nian2++;
4266   6                                              }
4267   5                                      }
4268   4                                      while(key_jia==0);
4269   4                                      
4270   4                              }
4271   3                              if(key_jian==0|aaajjj==0x43)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 70  

4272   3                              {
4273   4                                      delay(5000);
4274   4                                      if(key_jian==0|aaajjj==0x43)
4275   4                                      {       aaajjj=0;                                                               
4276   5                                              if(nian2>0)
4277   5                                              {                                       
4278   6                                                      for(foo=16;foo>0;foo--)
4279   6                                                      {
4280   7                                                              qu_816(29,17,1,(nian2-1)*2,foo);
4281   7                                                              hua_816(29,17,1,(nian2-1)*2,foo-1);
4282   7                                                              delay(10000);
4283   7                                                      }
4284   6                                                      nian2--;
4285   6                                              }
4286   5                                      }
4287   4                                      while(key_jian==0);
4288   4                                      
4289   4                              }
4290   3                              if(key_fan_hiu==0|aaajjj==0x15)
4291   3                              {
4292   4                                      delay(5000);
4293   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4294   4                                      {       aaajjj=0;
4295   5                                              shiji=15;
4296   5                                              shanji=1;
4297   5                                              for(foo=1;foo<63;foo++)
4298   5                                         {
4299   6                                                      for(foo1=1;foo1<31;foo1++)
4300   6                                                      {
4301   7                                                              qing_dian1(foo,foo1,3);
4302   7                                                      }
4303   6                                                      delay(3000);
4304   6                                         }
4305   5                                      }
4306   4                                      while(key_fan_hiu==0);
4307   4                                      
4308   4                              }
4309   3                              if(key_qu_ren==0|aaajjj==0x40)
4310   3                              {
4311   4                                      delay(5000);
4312   4                                      if(key_qu_ren==0|aaajjj==0x40)
4313   4                                      {       aaajjj=0;
4314   5                                              shiji++;
4315   5                                              qu_816(29,17,1,nian2*2,0);
4316   5                                              hua_816(29,17,2,nian2*2,0);
4317   5                                      }
4318   4                                      while(key_qu_ren==0);
4319   4                                                                                              
4320   4                              }
4321   3                      }
4322   2              }
4323   1              while(shiji==4)
4324   1              {
4325   2                      qu_816(39,17,2,yue1*2,0);
4326   2                      hua_816(39,17,1,yue1*2,0);
4327   2                      while(shiji==4)
4328   2                      {
4329   3                              if(key_jia==0|aaajjj==0x44)
4330   3                              {
4331   4                                      delay(5000);
4332   4                                      if(key_jia==0|aaajjj==0x44)
4333   4                                      {       aaajjj=0;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 71  

4334   5                                              if(yue1<1) 
4335   5                                              {       
4336   6                                                      for(foo=1;foo<17;foo++)
4337   6                                                      {
4338   7                                                              qu_816(39,17,1,yue1*2,foo-1);
4339   7                                                              hua_816(39,17,1,yue1*2,foo);
4340   7                                                              delay(10000);
4341   7                                                      }
4342   6                                                      yue1++;
4343   6                                              }
4344   5                                      }
4345   4                                      while(key_jia==0);
4346   4                              
4347   4                              }
4348   3                              if(key_jian==0|aaajjj==0x43)
4349   3                              {
4350   4                                      delay(5000);
4351   4                                      if(key_jian==0|aaajjj==0x43)
4352   4                                      {       aaajjj=0;                                                               
4353   5                                              if(yue1>0)
4354   5                                              {                                       
4355   6                                                      for(foo=16;foo>0;foo--)
4356   6                                                      {
4357   7                                                              qu_816(39,17,1,(yue1-1)*2,foo);
4358   7                                                              hua_816(39,17,1,(yue1-1)*2,foo-1);
4359   7                                                              delay(10000);
4360   7                                                      }
4361   6                                                      yue1--;
4362   6                                              }
4363   5                                      }
4364   4                                      while(key_jian==0);
4365   4                              
4366   4                              }
4367   3                              if(key_fan_hiu==0|aaajjj==0x15)
4368   3                              {
4369   4                                      delay(5000);
4370   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4371   4                                      {       aaajjj=0;
4372   5                                              shiji=15;
4373   5                                              shanji=1;
4374   5                                              for(foo=1;foo<63;foo++)
4375   5                                         {
4376   6                                                      for(foo1=1;foo1<31;foo1++)
4377   6                                                      {
4378   7                                                              qing_dian1(foo,foo1,3);
4379   7                                                      }
4380   6                                                      delay(3000);
4381   6                                         }
4382   5                                      }
4383   4                                      while(key_fan_hiu==0);
4384   4                                      
4385   4                              }
4386   3                              if(key_qu_ren==0|aaajjj==0x40)
4387   3                              {
4388   4                                      delay(5000);
4389   4                                      if(key_qu_ren==0|aaajjj==0x40)
4390   4                                      {       aaajjj=0;
4391   5                                              shiji++;
4392   5                                              qu_816(39,17,1,yue1*2,0);
4393   5                                              hua_816(39,17,2,yue1*2,0);
4394   5                                      }
4395   4                                      while(key_qu_ren==0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 72  

4396   4                                                                                                      
4397   4                              }
4398   3                      }
4399   2              }
4400   1              while(shiji==5)
4401   1              {
4402   2                 qu_816(46,17,2,yue2*2,0);
4403   2                      hua_816(46,17,1,yue2*2,0);
4404   2                      while(shiji==5)
4405   2                      {
4406   3                              if(key_jia==0|aaajjj==0x44)
4407   3                              {
4408   4                                      delay(5000);
4409   4                                      if(key_jia==0|aaajjj==0x44)
4410   4                                      {       aaajjj=0;
4411   5                                              if(yue2<9) 
4412   5                                              {       
4413   6                                                      for(foo=1;foo<17;foo++)
4414   6                                                      {
4415   7                                                              qu_816(46,17,1,yue2*2,foo-1);
4416   7                                                              hua_816(46,17,1,yue2*2,foo);
4417   7                                                              delay(10000);
4418   7                                                      }
4419   6                                                      yue2++;
4420   6                                              }
4421   5                                      }
4422   4                                      while(key_jia==0);
4423   4                              
4424   4                              }
4425   3                              if(key_jian==0|aaajjj==0x43)
4426   3                              {
4427   4                                      delay(5000);
4428   4                                      if(key_jian==0|aaajjj==0x43)
4429   4                                      {       aaajjj=0;                                                               
4430   5                                              if(yue2>0)
4431   5                                              {                                       
4432   6                                                      for(foo=16;foo>0;foo--)
4433   6                                                      {
4434   7                                                              qu_816(46,17,1,(yue2-1)*2,foo);
4435   7                                                              hua_816(46,17,1,(yue2-1)*2,foo-1);
4436   7                                                              delay(10000);
4437   7                                                      }
4438   6                                                      yue2--;
4439   6                                              }
4440   5                                      }
4441   4                                      while(key_jian==0);
4442   4                              
4443   4                              }
4444   3                              if(key_fan_hiu==0|aaajjj==0x15)
4445   3                              {
4446   4                                      delay(5000);
4447   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4448   4                                      {       aaajjj=0;
4449   5                                              shiji=15;
4450   5                                              shanji=1;
4451   5                                              for(foo=1;foo<63;foo++)
4452   5                                         {
4453   6                                                      for(foo1=1;foo1<31;foo1++)
4454   6                                                      {
4455   7                                                              qing_dian1(foo,foo1,3);
4456   7                                                      }
4457   6                                                      delay(3000);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 73  

4458   6                                         }
4459   5                                      }
4460   4                                      while(key_fan_hiu==0);
4461   4                              
4462   4                              }
4463   3                              if(key_qu_ren==0|aaajjj==0x40)
4464   3                              {
4465   4                                      delay(5000);
4466   4                                      if(key_qu_ren==0|aaajjj==0x40)
4467   4                                      {       aaajjj=0;
4468   5                                              shiji++;
4469   5                                              qu_816(46,17,1,yue2*2,0);
4470   5                                              hua_816(46,17,2,yue2*2,0);
4471   5                                      }
4472   4                                      while(key_qu_ren==0);
4473   4                                                                                              
4474   4                              }
4475   3                      }
4476   2              }
4477   1              while(shiji==6)
4478   1              {
4479   2                      qu_816(56,17,2,ri1*2,0);
4480   2                      hua_816(56,17,1,ri1*2,0);
4481   2                      while(shiji==6)
4482   2                      {
4483   3                              if(key_jia==0|aaajjj==0x44)
4484   3                              {
4485   4                                      delay(5000);
4486   4                                      if(key_jia==0|aaajjj==0x44)
4487   4                                      {       aaajjj=0;
4488   5                                              if(shi1<3) 
4489   5                                              {       
4490   6                                                      for(foo=1;foo<17;foo++)
4491   6                                                      {
4492   7                                                              qu_816(56,17,1,ri1*2,foo-1);
4493   7                                                              hua_816(56,17,1,ri1*2,foo);
4494   7                                                              delay(10000);
4495   7                                                      }
4496   6                                                      ri1++;
4497   6                                              }
4498   5                                      }
4499   4                                      while(key_jia==0);
4500   4                              
4501   4                              }
4502   3                              if(key_jian==0|aaajjj==0x43)
4503   3                              {
4504   4                                      delay(5000);
4505   4                                      if(key_jian==0|aaajjj==0x43)
4506   4                                      {       aaajjj=0;                                                               
4507   5                                              if(ri1>0)
4508   5                                              {
4509   6                                                      for(foo=16;foo>0;foo--)
4510   6                                                      {
4511   7                                                              qu_816(56,17,1,(ri1-1)*2,foo);
4512   7                                                              hua_816(56,17,1,(ri1-1)*2,foo-1);
4513   7                                                              delay(10000);
4514   7                                                      }
4515   6                                                      ri1--;
4516   6                                              }
4517   5                                      }
4518   4                                      while(key_jian==0);
4519   4                              
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 74  

4520   4                              }
4521   3                              if(key_fan_hiu==0|aaajjj==0x15)
4522   3                              {
4523   4                                      delay(5000);
4524   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4525   4                                      {       aaajjj=0;
4526   5                                              shiji=15;
4527   5                                              shanji=1;
4528   5                                              for(foo=1;foo<63;foo++)
4529   5                                         {
4530   6                                                      for(foo1=1;foo1<31;foo1++)
4531   6                                                      {
4532   7                                                              qing_dian1(foo,foo1,3);
4533   7                                                      }
4534   6                                                      delay(3000);
4535   6                                         }
4536   5                                      }
4537   4                                      while(key_fan_hiu==0);
4538   4                              
4539   4                              }
4540   3                              if(key_qu_ren==0|aaajjj==0x40)
4541   3                              {
4542   4                                      delay(5000);
4543   4                                      if(key_qu_ren==0|aaajjj==0x40)
4544   4                                      {       aaajjj=0;
4545   5                                              shiji++;
4546   5                                              qu_816(56,17,1,ri1*2,0);
4547   5                                              hua_816(56,17,2,ri1*2,0);
4548   5                                      }
4549   4                                      while(key_qu_ren==0);
4550   4                                                                                              
4551   4                              }
4552   3                      }
4553   2              }
4554   1              while(shiji==7)
4555   1              {
4556   2                      qu_816(63,17,2,ri2*2,0);
4557   2                      hua_816(63,17,1,ri2*2,0);
4558   2                      while(shiji==7)
4559   2                      {
4560   3                              if(key_jia==0|aaajjj==0x44)
4561   3                              {
4562   4                                      delay(5000);
4563   4                                      if(key_jia==0|aaajjj==0x44)
4564   4                                      {       aaajjj=0;
4565   5                                              if(shi1<9) 
4566   5                                              {       
4567   6                                                      for(foo=1;foo<17;foo++)
4568   6                                                      {
4569   7                                                              qu_816(63,17,1,ri2*2,foo-1);
4570   7                                                              hua_816(63,17,1,ri2*2,foo);
4571   7                                                              delay(10000);
4572   7                                                      }
4573   6                                                      ri2++;
4574   6                                              }
4575   5                                      }
4576   4                                      while(key_jia==0);
4577   4                              
4578   4                              }
4579   3                              if(key_jian==0|aaajjj==0x43)
4580   3                              {
4581   4                                      delay(5000);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 75  

4582   4                                      if(key_jian==0|aaajjj==0x43)
4583   4                                      {       aaajjj=0;                                                               
4584   5                                              if(ri2>0)
4585   5                                              {
4586   6                                                      for(foo=16;foo>0;foo--)
4587   6                                                      {
4588   7                                                              qu_816(63,17,1,(ri2-1)*2,foo);
4589   7                                                              hua_816(63,17,1,(ri2-1)*2,foo-1);
4590   7                                                              delay(10000);
4591   7                                                      }
4592   6                                                      ri2--;
4593   6                                              }
4594   5                                      }
4595   4                                      while(key_jian==0);
4596   4                              
4597   4                              }
4598   3                              if(key_fan_hiu==0|aaajjj==0x15)
4599   3                              {
4600   4                                      delay(5000);
4601   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4602   4                                      {       aaajjj=0;
4603   5                                              shiji=15;
4604   5                                              shanji=1;
4605   5                                              for(foo=1;foo<63;foo++)
4606   5                                         {
4607   6                                                      for(foo1=1;foo1<31;foo1++)
4608   6                                                      {
4609   7                                                              qing_dian1(foo,foo1,3);
4610   7                                                      }
4611   6                                                      delay(3000);
4612   6                                         }
4613   5                                      }
4614   4                                      while(key_fan_hiu==0);
4615   4                              
4616   4                              }
4617   3                              if(key_qu_ren==0|aaajjj==0x40)
4618   3                              {
4619   4                                      delay(5000);
4620   4                                      if(key_qu_ren==0|aaajjj==0x40)
4621   4                                      {       aaajjj=0;
4622   5                                              shiji++;
4623   5                                              qu_816(63,17,1,ri2*2,0);
4624   5                                              hua_816(63,17,2,ri2*2,0);
4625   5                                      }
4626   4                                      while(key_qu_ren==0);
4627   4                                                                                              
4628   4                              }
4629   3                      }
4630   2              }
4631   1              while(shiji==8)
4632   1              {
4633   2                      qu_816(11,31,2,shi1*2,0);
4634   2                      hua_816(11,31,1,shi1*2,0);
4635   2                      while(shiji==8)
4636   2                      {
4637   3                              if(key_jia==0|aaajjj==0x44)
4638   3                              {
4639   4                                      delay(5000);
4640   4                                      if(key_jia==0|aaajjj==0x44)
4641   4                                      {       aaajjj=0;
4642   5                                              if(shi1<2) 
4643   5                                              {
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 76  

4644   6                                                      for(foo=1;foo<17;foo++)
4645   6                                                      {
4646   7                                                              qu_816(11,31,1,shi1*2,foo-1);
4647   7                                                              hua_816(11,31,1,shi1*2,foo);
4648   7                                                              delay(10000);
4649   7                                                      }
4650   6                                                      shi1++;
4651   6                                              }
4652   5                                      }
4653   4                                      while(key_jia==0);
4654   4                                      
4655   4                              }
4656   3                              if(key_jian==0|aaajjj==0x43)
4657   3                              {
4658   4                                      delay(5000);
4659   4                                      if(key_jian==0|aaajjj==0x43)
4660   4                                      {       aaajjj=0;                                                               
4661   5                                              if(shi1>0)
4662   5                                              {
4663   6                                                      for(foo=16;foo>0;foo--)
4664   6                                                      {
4665   7                                                              qu_816(11,31,1,(shi1-1)*2,foo);
4666   7                                                              hua_816(11,31,1,(shi1-1)*2,foo-1);
4667   7                                                              delay(10000);
4668   7                                                      }
4669   6                                                      shi1--;
4670   6                                              }
4671   5                                      }
4672   4                                      while(key_jian==0);
4673   4                              
4674   4                              }
4675   3                              if(key_fan_hiu==0|aaajjj==0x15)
4676   3                              {
4677   4                                      delay(5000);
4678   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4679   4                                      {       aaajjj=0;
4680   5                                              shiji=15;
4681   5                                              shanji=1;
4682   5                                              for(foo=1;foo<63;foo++)
4683   5                                         {
4684   6                                                      for(foo1=1;foo1<31;foo1++)
4685   6                                                      {
4686   7                                                              qing_dian1(foo,foo1,3);
4687   7                                                      }
4688   6                                                      delay(3000);
4689   6                                         }
4690   5                                      }
4691   4                                      while(key_fan_hiu==0);
4692   4                              
4693   4                              }
4694   3                              if(key_qu_ren==0|aaajjj==0x40)
4695   3                              {
4696   4                                      delay(5000);
4697   4                                      if(key_qu_ren==0|aaajjj==0x40)
4698   4                                      {       aaajjj=0;
4699   5                                              shiji++;
4700   5                                              qu_816(11,31,1,shi1*2,0);
4701   5                                              hua_816(11,31,2,shi1*2,0);
4702   5                                      }
4703   4                                      while(key_qu_ren==0);
4704   4                                                                                              
4705   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 77  

4706   3                      }
4707   2              }
4708   1              while(shiji==9)
4709   1              {
4710   2                 qu_816(19,31,2,shi2*2,0);
4711   2                      hua_816(19,31,1,shi2*2,0);
4712   2                      while(shiji==9)
4713   2                      {
4714   3                              if(key_jia==0|aaajjj==0x44)
4715   3                              {
4716   4                                      delay(5000);
4717   4                                      if(key_jia==0|aaajjj==0x44)
4718   4                                      {       aaajjj=0;
4719   5                                              if(shi2<9) 
4720   5                                              {       
4721   6                                                      for(foo=1;foo<17;foo++)
4722   6                                                      {
4723   7                                                              qu_816(19,31,1,shi2*2,foo-1);
4724   7                                                              hua_816(19,31,1,shi2*2,foo);
4725   7                                                              delay(10000);
4726   7                                                      }
4727   6                                                      shi2++;
4728   6                                              }
4729   5                                      }
4730   4                                      while(key_jia==0);
4731   4                              
4732   4                              }
4733   3                              if(key_jian==0|aaajjj==0x43)
4734   3                              {
4735   4                                      delay(5000);
4736   4                                      if(key_jian==0|aaajjj==0x43)
4737   4                                      {       aaajjj=0;                                                               
4738   5                                              if(shi2>0)
4739   5                                              {                                       
4740   6                                                      for(foo=16;foo>0;foo--)
4741   6                                                      {
4742   7                                                              qu_816(19,31,1,(shi2-1)*2,foo);
4743   7                                                              hua_816(19,31,1,(shi2-1)*2,foo-1);
4744   7                                                              delay(10000);
4745   7                                                      }
4746   6                                                      shi2--;
4747   6                                              }
4748   5                                      }
4749   4                                      while(key_jian==0);
4750   4                              
4751   4                              }
4752   3                              if(key_fan_hiu==0|aaajjj==0x15)
4753   3                              {
4754   4                                      delay(5000);
4755   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4756   4                                      {  aaajjj=0;
4757   5                                              shiji=15;
4758   5                                              shanji=1;
4759   5                                              for(foo=1;foo<63;foo++)
4760   5                                         {
4761   6                                                      for(foo1=1;foo1<31;foo1++)
4762   6                                                      {
4763   7                                                              qing_dian1(foo,foo1,3);
4764   7                                                      }
4765   6                                                      delay(3000);
4766   6                                         }
4767   5                                      }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 78  

4768   4                                      while(key_fan_hiu==0);
4769   4                              
4770   4                              }
4771   3                              if(key_qu_ren==0|aaajjj==0x40)
4772   3                              {
4773   4                                      delay(5000);
4774   4                                      if(key_qu_ren==0|aaajjj==0x40)
4775   4                                      {       aaajjj=0;
4776   5                                              shiji++;
4777   5                                              qu_816(19,31,1,shi2*2,0);
4778   5                                              hua_816(19,31,2,shi2*2,0);
4779   5                                      }
4780   4                                      while(key_qu_ren==0);
4781   4                                                                                              
4782   4                              }
4783   3                      }
4784   2              }
4785   1              while(shiji==10)
4786   1              {
4787   2                      qu_816(30,31,2,fen1*2,0);
4788   2                      hua_816(30,31,1,fen1*2,0);
4789   2                      while(shiji==10)
4790   2                      {
4791   3                              if(key_jia==0|aaajjj==0x44)
4792   3                              {
4793   4                                      delay(5000);
4794   4                                      if(key_jia==0|aaajjj==0x44)
4795   4                                      {       aaajjj=0;
4796   5                                              if(fen1<5) 
4797   5                                              {       
4798   6                                                      for(foo=1;foo<17;foo++)
4799   6                                                      {
4800   7                                                              qu_816(30,31,1,fen1*2,foo-1);
4801   7                                                              hua_816(30,31,1,fen1*2,foo);
4802   7                                                              delay(10000);
4803   7                                                      }
4804   6                                                      fen1++;
4805   6                                              }
4806   5                                      }
4807   4                                      while(key_jia==0);
4808   4                              
4809   4                              }
4810   3                              if(key_jian==0|aaajjj==0x43)
4811   3                              {
4812   4                                      delay(5000);
4813   4                                      if(key_jian==0|aaajjj==0x43)
4814   4                                      {       aaajjj=0;                                                               
4815   5                                              if(shi2>0)
4816   5                                              {                                       
4817   6                                                      for(foo=16;foo>0;foo--)
4818   6                                                      {
4819   7                                                              qu_816(30,31,1,(fen1-1)*2,foo);
4820   7                                                              hua_816(30,31,1,(fen1-1)*2,foo-1);
4821   7                                                              delay(10000);
4822   7                                                      }
4823   6                                                      fen1--;
4824   6                                              }
4825   5                                      }
4826   4                                      while(key_jian==0);
4827   4                              
4828   4                              }
4829   3                              if(key_fan_hiu==0|aaajjj==0x15)
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 79  

4830   3                              {
4831   4                                      delay(5000);
4832   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4833   4                                      {       aaajjj=0;
4834   5                                              shiji=15;
4835   5                                              shanji=1;
4836   5                                              for(foo=1;foo<63;foo++)
4837   5                                         {
4838   6                                                      for(foo1=1;foo1<31;foo1++)
4839   6                                                      {
4840   7                                                              qing_dian1(foo,foo1,3);
4841   7                                                      }
4842   6                                                      delay(3000);
4843   6                                         }
4844   5                                      }
4845   4                                      while(key_fan_hiu==0);
4846   4                              
4847   4                              }
4848   3                              if(key_qu_ren==0|aaajjj==0x40)
4849   3                              {
4850   4                                      delay(5000);
4851   4                                      if(key_qu_ren==0|aaajjj==0x40)
4852   4                                      {       aaajjj=0;
4853   5                                              shiji++;
4854   5                                              qu_816(30,31,1,fen1*2,0);
4855   5                                              hua_816(30,31,2,fen1*2,0);
4856   5                                      }
4857   4                                      while(key_qu_ren==0);
4858   4                                                                                      
4859   4                              }
4860   3                      }
4861   2              }
4862   1              while(shiji==11)
4863   1              {
4864   2                      qu_816(38,31,2,fen2*2,0);
4865   2                      hua_816(38,31,1,fen2*2,0);
4866   2                      while(shiji==11)
4867   2                      {
4868   3                              if(key_jia==0|aaajjj==0x44)
4869   3                              {
4870   4                                      delay(5000);
4871   4                                      if(key_jia==0|aaajjj==0x44)
4872   4                                      {       aaajjj=0;
4873   5                                              if(fen2<9) 
4874   5                                              {
4875   6                                                      for(foo=1;foo<17;foo++)
4876   6                                                      {
4877   7                                                              qu_816(38,31,1,fen2*2,foo-1);
4878   7                                                              hua_816(38,31,1,fen2*2,foo);
4879   7                                                              delay(10000);
4880   7                                                      }
4881   6                                                      fen2++;
4882   6                                              }
4883   5                                      }
4884   4                                      while(key_jia==0);
4885   4                                      
4886   4                              }
4887   3                              if(key_jian==0|aaajjj==0x43)
4888   3                              {
4889   4                                      delay(5000);
4890   4                                      if(key_jian==0|aaajjj==0x43)
4891   4                                      {       aaajjj=0;                                                               
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 80  

4892   5                                              if(fen2>0)
4893   5                                              {
4894   6                                                      for(foo=16;foo>0;foo--)
4895   6                                                      {
4896   7                                                              qu_816(38,31,1,(fen2-1)*2,foo);
4897   7                                                              hua_816(38,31,1,(fen2-1)*2,foo-1);
4898   7                                                              delay(10000);
4899   7                                                      }
4900   6                                                      fen2--;
4901   6                                              }
4902   5                                      }
4903   4                                      while(key_jian==0);
4904   4                              
4905   4                              }
4906   3                              if(key_fan_hiu==0|aaajjj==0x15)
4907   3                              {
4908   4                                      delay(5000);
4909   4                                      if(key_fan_hiu==0|aaajjj==0x15)
4910   4                                      {       aaajjj=0;
4911   5                                              shiji=15;
4912   5                                              shanji=1;
4913   5                                              for(foo=1;foo<63;foo++)
4914   5                                         {
4915   6                                                      for(foo1=1;foo1<31;foo1++)
4916   6                                                      {
4917   7                                                              qing_dian1(foo,foo1,3);
4918   7                                                      }
4919   6                                                      delay(3000);
4920   6                                         }
4921   5                                      }
4922   4                                      while(key_fan_hiu==0);
4923   4                                      
4924   4                              }
4925   3                              if(key_qu_ren==0|aaajjj==0x40)
4926   3                              {
4927   4                                      delay(5000);
4928   4                                      if(key_qu_ren==0|aaajjj==0x40)
4929   4                                      {       aaajjj=0;
4930   5                                              shiji++;
4931   5                                              qu_816(38,31,1,fen2*2,0);
4932   5                                              hua_816(38,31,2,fen2*2,0);
4933   5                                      }
4934   4                                      while(key_qu_ren==0);
4935   4                                                                                              
4936   4                              }
4937   3                      }
4938   2              }
4939   1              while(shiji==12)
4940   1              {
4941   2                      for(jj=0;jj<64;jj++)
4942   2                      {
4943   3                              LB[jj]=xinq[jj];
4944   3                              LB1[jj]=xinq[jj+64];
4945   3                              LB2[jj]=xinq[jj+128];
4946   3                      }
4947   2                      if(wxinq==7)
4948   2                      {
4949   3                              for(jj=0;jj<64;jj++)
4950   3                              {
4951   4                                      LB[jj]=xinq[jj+160];
4952   4                              }
4953   3                              qu_1616(59,31,2,4,0);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 81  

4954   3                              hua_1616(59,31,1,4,0);
4955   3                              for(jj=0;jj<64;jj++)
4956   3                              {
4957   4                                      LB[jj]=xinq[jj];
4958   4                                      LB1[jj]=xinq[jj+64];
4959   4                                      LB2[jj]=xinq[jj+128];
4960   4                              }
4961   3                      }
4962   2                      else
4963   2                      {
4964   3                              qu_1616(59,31,2,wxinq*4-4,0);
4965   3                              hua_1616(59,31,1,wxinq*4-4,0);
4966   3                      }
4967   2                      
4968   2                      while(shiji==12)
4969   2                      {
4970   3                              if(key_jia==0|aaajjj==0x44)
4971   3                              {
4972   4                                      delay(5000);
4973   4                                      if(key_jia==0|aaajjj==0x44)
4974   4                                      {        aaajjj=0;
4975   5                                               if(wxinq<7)
4976   5                                               {
4977   6                                                      if(wxinq==6) 
4978   6                                                      {
4979   7                                                              qu_1616(59,31,1,20,0);
4980   7                                                              for(foo=59;foo<80;foo++)
4981   7                                                              {
4982   8                                                                      qu_1616(foo-1,31,1,20,0);
4983   8                                                                      hua_1616(foo,31,1,20,0);
4984   8                                                                      delay(1500);
4985   8                                                              }
4986   7                                                              for(jj=0;jj<64;jj++)
4987   7                                                              {
4988   8                                                                      LB[jj]=xinq[jj+192];
4989   8                                                              }
4990   7                                                              for(foo=48;foo>30;foo--)
4991   7                                                              {
4992   8                                                                      qu_1616(59,foo+1,1,0,0);
4993   8                                                                      hua_1616(59,foo,1,0,0);
4994   8                                                                      delay(1500);
4995   8                                                              }
4996   7                                                              for(jj=0;jj<64;jj++)
4997   7                                                              {
4998   8                                                                      LB[jj]=xinq[jj];
4999   8                                                                      LB1[jj]=xinq[jj+64];
5000   8                                                                      LB2[jj]=xinq[jj+128];
5001   8                                                              }
5002   7                                                      }
5003   6                                                      else
5004   6                                                      {
5005   7                                                              for(foo=59;foo<80;foo++)
5006   7                                                              {
5007   8                                                                      qu_1616(foo-1,31,1,wxinq*4-4,0);
5008   8                                                                      hua_1616(foo,31,1,wxinq*4-4,0);
5009   8                                                                      delay(1500);
5010   8                                                              }
5011   7                                                              for(foo=48;foo>30;foo--)
5012   7                                                              {
5013   8                                                                      qu_1616(59,foo+1,1,wxinq*4,0);
5014   8                                                                      hua_1616(59,foo,1,wxinq*4,0);
5015   8                                                                      delay(1500);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 82  

5016   8                                                              }                                                                                       
5017   7                                                       }
5018   6                                                       wxinq++;
5019   6                                               }
5020   5                                      }
5021   4                                      while(key_jia==0);
5022   4                              
5023   4                              }
5024   3                              if(key_jian==0|aaajjj==0x43)
5025   3                              {
5026   4                                      delay(5000);
5027   4                                      if(key_jian==0|aaajjj==0x43)
5028   4                                      {       aaajjj=0;                                                               
5029   5                                              if(wxinq>1)
5030   5                                              {
5031   6                                                 if(wxinq==7)
5032   6                                                 {
5033   7                                                          for(jj=0;jj<64;jj++)
5034   7                                                              {
5035   8                                                                      LB[jj]=xinq[jj+192];
5036   8                                                              }
5037   7                                                              qu_1616(59,31,1,0,0);
5038   7                                                              for(foo=59;foo<80;foo++)
5039   7                                                              {
5040   8                                                                      qu_1616(foo-1,31,1,0,0);
5041   8                                                                      hua_1616(foo,31,1,0,0);
5042   8                                                                      delay(1500);
5043   8                                                              }
5044   7                                                              for(jj=0;jj<64;jj++)
5045   7                                                              {
5046   8                                                                      LB[jj]=xinq[jj];
5047   8                                                                      LB1[jj]=xinq[jj+64];
5048   8                                                                      LB2[jj]=xinq[jj+128];
5049   8                                                              }
5050   7                                                              for(foo=48;foo>30;foo--)
5051   7                                                              {
5052   8                                                                      qu_1616(59,foo+1,1,wxinq*4-8,0);
5053   8                                                                      hua_1616(59,foo,1,wxinq*4-8,0);
5054   8                                                                      delay(1500);
5055   8                                                              }
5056   7                                                 }
5057   6                                                 else
5058   6                                                 {
5059   7                                                              for(foo=59;foo<80;foo++)
5060   7                                                              {
5061   8                                                                      qu_1616(foo-1,31,1,wxinq*4-4,0);
5062   8                                                                      hua_1616(foo,31,1,wxinq*4-4,0);
5063   8                                                                      delay(1500);
5064   8                                                              }
5065   7                                                              for(foo=48;foo>30;foo--)
5066   7                                                              {
5067   8                                                                      qu_1616(59,foo+1,1,wxinq*4-8,0);
5068   8                                                                      hua_1616(59,foo,1,wxinq*4-8,0);
5069   8                                                                      delay(1500);
5070   8                                                              }
5071   7                                                 }
5072   6                                                 wxinq--;
5073   6                                              }
5074   5                                      }
5075   4                                      while(key_jian==0);
5076   4                              
5077   4                              }
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 83  

5078   3                              if(key_fan_hiu==0|aaajjj==0x15)
5079   3                              {
5080   4                                      delay(5000);
5081   4                                      if(key_fan_hiu==0|aaajjj==0x15)
5082   4                                      {       aaajjj=0;
5083   5                                              shiji=15;
5084   5                                              shanji=1;
5085   5                                              for(foo=1;foo<63;foo++)
5086   5                                         {
5087   6                                                      for(foo1=1;foo1<31;foo1++)
5088   6                                                      {
5089   7                                                              qing_dian1(foo,foo1,3);
5090   7                                                      }
5091   6                                                      delay(3000);
5092   6                                         }
5093   5                                      }
5094   4                                      while(key_fan_hiu==0);
5095   4                              
5096   4                              }
5097   3                              if(key_qu_ren==0|aaajjj==0x40)
5098   3                              {
5099   4                                      delay(5000);
5100   4                                      if(key_qu_ren==0|aaajjj==0x40)
5101   4                                      {       aaajjj=0;
5102   5                                              if(wxinq==7)
5103   5                                              {
5104   6                                                      for(jj=0;jj<64;jj++)
5105   6                                                      {
5106   7                                                              LB[jj]=xinq[jj+192];
5107   7                                                      }
5108   6                                                      qu_1616(59,31,1,0,0);
5109   6                                                      hua_1616(59,31,2,0,0);
5110   6                                                      for(jj=0;jj<64;jj++)
5111   6                                                      {
5112   7                                                              LB[jj]=xinq[jj];
5113   7                                                              LB1[jj]=xinq[jj+64];
5114   7                                                              LB2[jj]=xinq[jj+128];
5115   7                                                      }
5116   6                                              }
5117   5                                              else
5118   5                                              {
5119   6                                                      qu_1616(59,31,1,wxinq*4-4,0);
5120   6                                                      hua_1616(59,31,2,wxinq*4-4,0);
5121   6                                              }
5122   5                                              shiji=2;
5123   5                                      }
5124   4                                      while(key_qu_ren==0);
5125   4                                                                                      
5126   4                              }
5127   3                      }
5128   2                      for(jj=0;jj<64;jj++)
5129   2                      {
5130   3                              LB[jj]=k816[jj];
5131   3                              LB1[jj]=k816[jj+64];
5132   3                              LB2[jj]=k816[jj+128];
5133   3                      }
5134   2              }
5135   1              if(shiji==15)
5136   1              {
5137   2                      TR1=0;
5138   2                      P2M0|=0x10;
5139   2                      wnian=nian1*16+nian2;
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 84  

5140   2                      wyue=yue1*16+yue2;
5141   2                      wri=ri1*16+ri2;
5142   2                      wshi=shi1*16+shi2;
5143   2                      wfen=fen1*16+fen2;
5144   2                      Write1302 (xie_dian_yuan,0x00);
5145   2                      Write1302 (xie_miao,0x00);
5146   2                      Write1302 (xie_fen_zhong,wfen);
5147   2                      Write1302 (xie_xiao_shi,wshi);
5148   2                      Write1302 (xie_tian,wri);
5149   2                      Write1302 (xie_xin_qi,wxinq);
5150   2                      Write1302 (xie_yue,wyue);
5151   2                      Write1302 (xie_nian,wnian);     
5152   2                      Write1302 (xie_dian_yuan,0x80);
5153   2                      TR1=1;
5154   2                      P2M0&=0xef;
5155   2              }
5156   1      }
5157          
5158          
5159          void tcs_huadian(uchar tx,uchar ty)              //贪吃蛇画点
5160          {
5161   1              hua_dian1(3+(tx-1)*3,1+(ty-1)*3,2);
5162   1              hua_dian1(2+(tx-1)*3,2+(ty-1)*3,2);
5163   1              hua_dian1(4+(tx-1)*3,2+(ty-1)*3,2);
5164   1              hua_dian1(3+(tx-1)*3,3+(ty-1)*3,2);
5165   1              hua_dian1(2+(tx-1)*3,1+(ty-1)*3,1);
5166   1              hua_dian1(4+(tx-1)*3,1+(ty-1)*3,1);
5167   1              hua_dian1(2+(tx-1)*3,3+(ty-1)*3,1);
5168   1              hua_dian1(4+(tx-1)*3,3+(ty-1)*3,1);
5169   1      }
5170          
5171          void tcs_qudian(uchar tx1,uchar ty1)             //贪吃蛇取点
5172          {
5173   1              qing_dian1(3+(tx1-1)*3,1+(ty1-1)*3,2);
5174   1              qing_dian1(2+(tx1-1)*3,2+(ty1-1)*3,2);
5175   1              qing_dian1(4+(tx1-1)*3,2+(ty1-1)*3,2);
5176   1              qing_dian1(3+(tx1-1)*3,3+(ty1-1)*3,2);
5177   1              qing_dian1(2+(tx1-1)*3,1+(ty1-1)*3,1);
5178   1              qing_dian1(4+(tx1-1)*3,1+(ty1-1)*3,1);
5179   1              qing_dian1(2+(tx1-1)*3,3+(ty1-1)*3,1);
5180   1              qing_dian1(4+(tx1-1)*3,3+(ty1-1)*3,1);
5181   1      }
5182          
5183          
5184          void tcs_zhukong()                      //贪吃蛇主控
5185          {
5186   1              xinz=1;
5187   1              tcskais();
5188   1              while(xinz&&ysh==4)
5189   1              {
5190   2                      if(key_jian==0|aaajjj==0x43)
5191   2                      {
5192   3                              delay(5000);
5193   3                              if(key_jian==0|aaajjj==0x43)
5194   3                              {       aaajjj=0;
5195   4                                      if(xiaxia!=2)
5196   4                                      efenqian=0;
5197   4                              }                       
5198   3                      }
5199   2                      if(key_jia==0|aaajjj==0x44)
5200   2                      {
5201   3                              delay(5000);
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 85  

5202   3                              if(key_jia==0|aaajjj==0x44)
5203   3                              {       aaajjj=0;
5204   4                                      if(xiaxia!=0)
5205   4                                      efenqian=2;
5206   4                              }
5207   3                      }
5208   2                      if(key_fan_hiu==0|aaajjj==0x15)
5209   2                      {
5210   3                              delay(5000);
5211   3                              if(key_fan_hiu==0|aaajjj==0x15)
5212   3                              {       aaajjj=0;
5213   4                                      if(xiaxia!=1)
5214   4                                      efenqian=3;
5215   4                              }                       
5216   3                      }
5217   2                      if(key_qu_ren==0|aaajjj==0x46)
5218   2                      {
5219   3                              delay(5000);
5220   3                              if(key_qu_ren==0|aaajjj==0x46)
5221   3                              {       aaajjj=0;
5222   4                                      if(xiaxia!=3)
5223   4                                      efenqian=1;
5224   4                              }       
5225   3                      }
5226   2                      if(efenbai==1)
5227   2                      {
5228   3                              if(tcs_qfyd()==1)
5229   3                              {       
5230   4                                      efenbai=0;
5231   4                                      tcskais();
5232   4                                      
5233   4                              }
5234   3                              if(tcs_qfyd()==2)
5235   3                              {       
5236   4                                      efenbai=0;
5237   4                                      szxh++;
5238   4                                      LB3[(szxh-1)*2]=newxinz;
5239   4                                      LB3[(szxh-1)*2+1]=newfangx;
5240   4                                      efenge=1;
5241   4                                      while(efenge)
5242   4                                      {
5243   5                                              tcs_sjd();
5244   5                                              if(tcs_jc()==1) efenge=1;else efenge=0;
5245   5                                      }
5246   4                                      tcs_huadian(newfkx,newfky);                             
5247   4                                      
5248   4                              }
5249   3                              if(tcs_qfyd()==0)
5250   3                              {       
5251   4                                      efenbai=0;
5252   4                                      tcs_qudian(LB3[0],LB3[1]);
5253   4                                      tcs_huadian(newxinz,newfangx);
5254   4                                      for(foo=0;foo<(szxh-1);foo++)
5255   4                                      {
5256   5                                               LB3[foo*2]=LB3[foo*2+2];
5257   5                                               LB3[foo*2+1]=LB3[foo*2+3];
5258   5                                      }
5259   4                                      LB3[(szxh-1)*2]=newxinz;
5260   4                                      LB3[(szxh-1)*2+1]=newfangx;
5261   4                                      xiaxia=efenqian;
5262   4                                      
5263   4                              }               
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 86  

5264   3                              
5265   3                      }
5266   2                      
5267   2              }
5268   1              if(ysh!=yangshi)
5269   1              {
5270   2                      yangshi=ysh;            
5271   2                      qing_huan_chong();
5272   2              }
5273   1      }
5274          
5275          void tcs_sjd()       //产生随机点
5276          {
5277   1              srand(rand()+fangx+fkx+fky+newfkx+newfky+efenshi);
5278   1          newfkx=rand()%20;
5279   1              newfky=rand()%10;
5280   1              newfkx++;
5281   1              newfky++;
5282   1      }
5283          
5284          
5285          uchar tcs_jc()           //检测点是否落在身上
5286          {
5287   1              b=0;
5288   1              for(foo=0;foo<szxh;foo++)
5289   1              {
5290   2                      if(LB3[foo*2]==newfkx)
5291   2                      {
5292   3                              if(LB3[foo*2+1]==newfky)
5293   3                              {
5294   4                                      b=1;
5295   4                              }
5296   3                      }
5297   2              }
5298   1              return(b);
5299   1      }
5300          
5301          uchar tcs_qfyd()                //检测前方有没有冲突
5302          {
5303   1              b=0;
5304   1              newxinz=LB3[(szxh-1)*2];
5305   1              newfangx=LB3[(szxh-1)*2+1];
5306   1              if(efenqian==0) newxinz++;
5307   1              if(efenqian==1) newfangx--;
5308   1              if(efenqian==2) newxinz--;
5309   1              if(efenqian==3) newfangx++;
5310   1              for(foo=0;foo<szxh;foo++)
5311   1              {
5312   2                      if(LB3[foo*2]==newxinz)
5313   2                      {
5314   3                              if(LB3[foo*2+1]==newfangx)
5315   3                              {
5316   4                                      b=1;
5317   4                              }
5318   3                      }
5319   2              }
5320   1              if(newxinz<1|newxinz>20)  b=1;
5321   1              if(newfangx<1|newfangx>10)  b=1;
5322   1              if(newxinz==newfkx&&newfangx==newfky) b=2;
5323   1              return(b);
5324   1      }
5325          
C51 COMPILER V8.02   MENGHUAN                                                              07/02/2014 19:19:56 PAGE 87  

5326          void tcskais()                   //贪吃蛇开始
5327          {
5328   1              efenge=1;
5329   1              efenbai=0;
5330   1              efenqian=0;
5331   1              xiaxia=0;       
5332   1              szxh=7;
5333   1              qing_hong();
5334   1              qing_nv();
5335   1              
5336   1              for(foo=0;foo<200;foo++)
5337   1              {
5338   2                      LB3[foo]=0;
5339   2              }
5340   1              tcs_qudian(2,5);
5341   1              tcs_huadian(2,5);
5342   1              tcs_huadian(3,5);
5343   1              tcs_huadian(4,5);
5344   1              tcs_huadian(5,5);
5345   1              tcs_huadian(6,5);
5346   1              tcs_huadian(7,5);
5347   1              tcs_huadian(8,5);
5348   1              LB3[0]=2;LB3[1]=5;LB3[2]=3;LB3[3]=5;LB3[4]=4;LB3[5]=5;
5349   1              LB3[6]=5;LB3[7]=5;LB3[8]=6;LB3[9]=5;LB3[10]=7;LB3[11]=5;
5350   1              LB3[12]=8;LB3[13]=5;
5351   1              while(key_qu_ren==1&&ysh==4&&aaajjj!=0x46)
5352   1              {
5353   2                      efenshi++;
5354   2              }
5355   1              delay(10000);
5356   1              while(key_qu_ren==0&&ysh==4&&aaajjj!=0x46);
5357   1              delay(10000);
5358   1              while(efenge)
5359   1              {
5360   2                      tcs_sjd();
5361   2                      if(tcs_jc()==1) efenge=1;else efenge=0;
5362   2              }
5363   1              tcs_huadian(newfkx,newfky);
5364   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  43552    ----
   CONSTANT SIZE    =   3019    ----
   XDATA SIZE       =    904    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     88      53
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
